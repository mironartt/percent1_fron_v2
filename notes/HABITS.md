# –†–∞–∑–¥–µ–ª "–ü—Ä–∏–≤—ã—á–∫–∏" (Habits) ‚Äî –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ](#–æ–±—â–µ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
3. [–§–ª–æ—É –ø—Ä–∏–≤—ã—á–µ–∫](#—Ñ–ª–æ—É-–ø—Ä–∏–≤—ã—á–µ–∫)
4. [–†–µ–∂–∏–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏](#—Ä–µ–∂–∏–º—ã-—Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
5. [–°–∏—Å—Ç–µ–º–∞ XP](#—Å–∏—Å—Ç–µ–º–∞-xp)
6. [–°–∏—Å—Ç–µ–º–∞ –∞–º–Ω–∏—Å—Ç–∏–π](#—Å–∏—Å—Ç–µ–º–∞-–∞–º–Ω–∏—Å—Ç–∏–π)
7. [–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–µ–∫–µ—Ä–∞](#—Å—Ç—Ä–∞–Ω–∏—Ü–∞-—Ç—Ä–µ–∫–µ—Ä–∞)
8. [–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏](#—Å—Ç—Ä–∞–Ω–∏—Ü–∞-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
9. [–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π](#—Å–∏—Å—Ç–µ–º–∞-–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
10. [–ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—è](#–Ω–∞–≤–∏–≥–∞—Ü–∏—è-–∏-–∏—Å—Ç–æ—Ä–∏—è)

---

## –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å "–ü—Ä–∏–≤—ã—á–∫–∏" ‚Äî –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —Å–∏—Å—Ç–µ–º–æ–π –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –æ—Ç–º–µ—á–∞–µ—Ç –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–∞–µ—Ç XP-–Ω–∞–≥—Ä–∞–¥—ã. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 4 —Ä–µ–∂–∏–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, —à—Ç—Ä–∞—Ñ—ã –∑–∞ –ø—Ä–æ–ø—É—Å–∫–∏, –º–µ—Ö–∞–Ω–∏–∫—É –∞–º–Ω–∏—Å—Ç–∏–π –∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–µ–∫ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- XP-–Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (1-100 XP)
- –®—Ç—Ä–∞—Ñ—ã –∑–∞ –ø—Ä–æ–ø—É—Å–∫–∏ (0-200 XP, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞)
- 4 —Ä–µ–∂–∏–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–ú—è–≥–∫–∏–π, –ë–∞–ª–∞–Ω—Å, –•–∞—Ä–¥–∫–æ—Ä, –°–≤–æ–π)
- –°–∏—Å—Ç–µ–º–∞ –∞–º–Ω–∏—Å—Ç–∏–π –¥–ª—è "–ø—Ä–æ—â–µ–Ω–∏—è" –ø—Ä–æ–ø—É—Å–∫–æ–≤
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏
- Soft-delete –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª—å –ø—Ä–∏–≤—ã—á–∫–∏ (Habit)

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (UUID –∏–ª–∏ backend ID) |
| `name` | string | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤) |
| `icon` | string | –ò–º—è –∏–∫–æ–Ω–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 'fire', 'strength', 'brain') |
| `xpReward` | number | XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (1-100, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5) |
| `xpPenalty` | number | –®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–æ–ø—É—Å–∫ (0-200, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0) |
| `frequencyType` | string | –¢–∏–ø —á–∞—Å—Ç–æ—Ç—ã: 'daily', 'weekdays', 'weekends', 'custom' |
| `scheduleDays` | number[] | –î–Ω–∏ –Ω–µ–¥–µ–ª–∏ [0-6], –≥–¥–µ 0=–í—Å, 1=–ü–Ω, ... 6=–°–± |
| `description` | string | –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (–¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤) |
| `createdAt` | string | ISO –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `deletedAt` | string|null | ISO –¥–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è (soft-delete) |

### –õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (HabitLog)

```javascript
habitLog: {
  "2024-01-15": ["habit-id-1", "habit-id-2"],
  "2024-01-16": ["habit-id-1"]
}
```

–•—Ä–∞–Ω–∏—Ç ID –ø—Ä–∏–≤—ã—á–µ–∫, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ (GameSettings)

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `difficultyMode` | string | 'soft', 'balanced', 'hardcore', 'custom' |
| `penaltyMultiplier` | number | –ú–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ç—Ä–∞—Ñ–∞ (0-1), 0.5 = 50% |
| `weeklyAmnestyCount` | number | –ê–º–Ω–∏—Å—Ç–∏–π –≤ –Ω–µ–¥–µ–ª—é (0-7) |
| `planningPenaltyEnabled` | boolean | –®—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |
| `planningPenaltyAmount` | number | –†–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `journalPenaltyEnabled` | boolean | –®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–æ–ø—É—Å–∫ –¥–Ω–µ–≤–Ω–∏–∫–∞ |
| `journalPenaltyAmount` | number | –†–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –¥–Ω–µ–≤–Ω–∏–∫ |
| `amnestiedDates` | string[] | –î–∞—Ç—ã —Å –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–æ–π –∞–º–Ω–∏—Å—Ç–∏–µ–π |

### –°—Ç–∞—Ç—É—Å –¥–Ω—è –ø—Ä–∏–≤—ã—á–∫–∏ (DayStatus)

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –®—Ç—Ä–∞—Ñ |
|--------|----------|-------|
| `completed` | –í—ã–ø–æ–ª–Ω–µ–Ω–æ | –ù–µ—Ç |
| `missed` | –ü—Ä–æ–ø—É—â–µ–Ω–æ | –î–∞ |
| `excused` | –£–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–ø—É—Å–∫ | –ù–µ—Ç |
| `amnestied` | –ê–º–Ω–∏—Å—Ç–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ | –ù–µ—Ç (–æ—Ç–º–µ–Ω—ë–Ω) |
| `pending` | –¢–µ–∫—É—â–∏–π –¥–µ–Ω—å, –æ–∂–∏–¥–∞–µ—Ç | - |
| `future` | –ë—É–¥—É—â–∏–π –¥–µ–Ω—å | - |
| `not-scheduled` | –ù–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ | - |

---

## –§–ª–æ—É –ø—Ä–∏–≤—ã—á–µ–∫

### –§–ª–æ—É 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É"
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–æ—Ä–º—ã
3. [–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç "–ü–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É"
   ‚Üí –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å 5 –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (25 –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫)
   ‚Üí –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É:
   - –ù–∞–∑–≤–∞–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - –ò–∫–æ–Ω–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 'fire')
   - XP –Ω–∞–≥—Ä–∞–¥–∞ (—Å–ª–∞–π–¥–µ—Ä 1-100)
   - XP —à—Ç—Ä–∞—Ñ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–µ–∂–∏–º != soft)
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ / –±—É–¥–Ω–∏ / –≤—ã—Ö–æ–¥–Ω—ã–µ / —Å–≤–æ–π)
   - –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
6. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π ID
7. –ü—Ä–∏–≤—ã—á–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ store
8. [Async] –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥
9. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ: –≤—Ä–µ–º–µ–Ω–Ω—ã–π ID –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ backend ID
10. –ü—Ä–∏ –æ—à–∏–±–∫–µ: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –ø—Ä–∏–≤—ã—á–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
```

### –§–ª–æ—É 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–∏–≤—ã—á–∫–∏
2. –°–ø–æ—Å–æ–±—ã –æ—Ç–º–µ—Ç–∫–∏:
   –∞) –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ ‚Üí –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ–≥–æ–¥–Ω—è
   –±) –ö–ª–∏–∫ –ø–æ –¥–Ω—é –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–Ω—è
3. –ü—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
   - –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è habit.id –≤ habitLog[today]
   - –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP = habit.xpReward
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è "+X XP"
   - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è streak (–µ—Å–ª–∏ –≤—Å–µ –ø—Ä–∏–≤—ã—á–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)
4. –ü—Ä–∏ —Å–Ω—è—Ç–∏–∏ –æ—Ç–º–µ—Ç–∫–∏:
   - –£–¥–∞–ª—è–µ—Ç—Å—è habit.id –∏–∑ habitLog[today]
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è XP = habit.xpReward
5. [Async] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º
```

### –§–ª–æ—É 3: –ü—Ä–æ–ø—É—Å–∫ –ø—Ä–∏–≤—ã—á–∫–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)

```
1. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
   - –ï—Å—Ç—å –ª–∏ –ø—Ä–æ—à–µ–¥—à–∏–µ –¥–Ω–∏ —Å –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–≤—ã—á–∫–∞–º–∏
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–≥–æ –¥–Ω—è:
   - –ï—Å–ª–∏ —Ä–µ–∂–∏–º != 'soft' –ò –¥–µ–Ω—å –Ω–µ –≤ amnestiedDates:
     - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ = habit.xpPenalty * penaltyMultiplier
     - –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è XP (–º–∏–Ω–∏–º—É–º 0)
3. –î–Ω–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ 'missed' –≤ –∏—Å—Ç–æ—Ä–∏–∏
4. [Async] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º
```

### –§–ª–æ—É 4: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–Ω—è

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –ø–æ –¥–Ω—é –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ –ø—Ä–∏–≤—ã—á–∫–∏
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–Ω—è:
   
   –î–ª—è –°–ï–ì–û–î–ù–Ø:
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º"
   - –ü–æ–ª–µ –∑–∞–º–µ—Ç–∫–∏
   
   –î–ª—è –ü–†–û–®–õ–û–ì–û:
   - 3 –∫–Ω–æ–ø–∫–∏: –í—ã–ø–æ–ª–Ω–µ–Ω–æ / –ü—Ä–æ–ø—É—â–µ–Ω–æ / –£–≤–∞–∂. –ø—Ä–æ–ø—É—Å–∫
   - –ü–æ–ª–µ –∑–∞–º–µ—Ç–∫–∏
   - –ü–æ–ª–µ –ø—Ä–∏—á–∏–Ω—ã (–µ—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ)
   - –ë–ª–æ–∫ –∞–º–Ω–∏—Å—Ç–∏–∏ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞)
   
   –î–ª—è –ë–£–î–£–©–ï–ì–û:
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
   - –¢–æ–ª—å–∫–æ –ø–æ–ª–µ –∑–∞–º–µ—Ç–∫–∏

4. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞:
   - –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è XP (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/–≤–æ–∑–≤—Ä–∞—Ç)
   - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è streak
5. –ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É –¥–Ω—è–º–∏:
   - –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### –§–ª–æ—É 5: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–º–Ω–∏—Å—Ç–∏–∏

```
1. –£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:
   - –†–µ–∂–∏–º != 'soft'
   - weeklyAmnestyCount > 0
   - –ï—Å—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∞–º–Ω–∏—Å—Ç–∏–∏
   - –ï—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–Ω–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π

2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–ª–æ–∫ "–ê–º–Ω–∏—Å—Ç–∏—è" –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏
3. –í–∏–¥–∏—Ç 2 —Å–µ–∫—Ü–∏–∏:
   - "–ê–º–Ω–∏—Å—Ç–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞" (–¥–Ω–∏ —Å –∞–º–Ω–∏—Å—Ç–∏–µ–π)
   - "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –¥–ª—è –ø—Ä–æ—â–µ–Ω–∏—è" (–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–Ω–∏)

4. –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –¥–µ–Ω—å:
   - –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ amnestiedDates
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ XP –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
   - –°—á—ë—Ç—á–∏–∫ –∞–º–Ω–∏—Å—Ç–∏–π —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
   - –î–µ–Ω—å –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ —Å–µ–∫—Ü–∏—é "–ø—Ä–∏–º–µ–Ω–µ–Ω–∞"

5. –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –∞–º–Ω–∏—Å—Ç–∏–∏ (–∫–ª–∏–∫ X):
   - –î–∞—Ç–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ amnestiedDates
   - –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ XP —Å–Ω–æ–≤–∞
   - –°—á—ë—Ç—á–∏–∫ –∞–º–Ω–∏—Å—Ç–∏–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
```

### –§–ª–æ—É 6: –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (Soft-Delete)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–£–¥–∞–ª–∏—Ç—å" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
3. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏:
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è deletedAt = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞
   - –ü—Ä–∏–≤—ã—á–∫–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ –±–ª–æ–∫ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ"
4. –ü—Ä–∏–≤—ã—á–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –ø—Ä–æ—à–ª—ã—Ö –Ω–µ–¥–µ–ª—å
5. [Async] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º
```

### –§–ª–æ—É 7: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–ª–æ–∫ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏"
2. –ù–∞–∂–∏–º–∞–µ—Ç "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"
3. deletedAt —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ null
4. –ü—Ä–∏–≤—ã—á–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ
5. [Async] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º
```

### –§–ª–æ—É 8: –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

```
1. –í –±–ª–æ–∫–µ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏" –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞"
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
3. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏:
   - –ü—Ä–∏–≤—ã—á–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ store
   - –í—Å–µ –∑–∞–ø–∏—Å–∏ –≤ habitLog –æ—Å—Ç–∞—é—Ç—Å—è (orphaned)
4. [Async] DELETE –∑–∞–ø—Ä–æ—Å –Ω–∞ –±—ç–∫–µ–Ω–¥
```

---

## –†–µ–∂–∏–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ú—è–≥–∫–∏–π (Soft)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –®—Ç—Ä–∞—Ñ—ã | –û—Ç–∫–ª—é—á–µ–Ω—ã (0%) |
| –ê–º–Ω–∏—Å—Ç–∏–∏ | 0 –≤ –Ω–µ–¥–µ–ª—é |
| –û–ø–∏—Å–∞–Ω–∏–µ | –¢–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ |

### 2. –ë–∞–ª–∞–Ω—Å (Balanced)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –®—Ç—Ä–∞—Ñ—ã | 50% –æ—Ç xpPenalty |
| –ê–º–Ω–∏—Å—Ç–∏–∏ | 1 –≤ –Ω–µ–¥–µ–ª—é |
| –û–ø–∏—Å–∞–Ω–∏–µ | –ë–∞–ª–∞–Ω—Å –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ |

### 3. –•–∞—Ä–¥–∫–æ—Ä (Hardcore)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –®—Ç—Ä–∞—Ñ—ã | 100% –æ—Ç xpPenalty |
| –ê–º–Ω–∏—Å—Ç–∏–∏ | 0 –≤ –Ω–µ–¥–µ–ª—é |
| –û–ø–∏—Å–∞–Ω–∏–µ | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ |

### 4. –°–≤–æ–π (Custom)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –®—Ç—Ä–∞—Ñ—ã | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π (0-100%) |
| –ê–º–Ω–∏—Å—Ç–∏–∏ | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ (0-7) |
| –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∞–Ω–∫—Ü–∏–∏
| –°–∞–Ω–∫—Ü–∏—è | –£—Å–ª–æ–≤–∏–µ | –®—Ç—Ä–∞—Ñ |
|---------|---------|-------|
| –ó–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–µ—Ç –ø–ª–∞–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å | 0-100 XP |
| –ó–∞ –¥–Ω–µ–≤–Ω–∏–∫ | –ü—Ä–æ–ø—É—Å–∫ –∑–∞–ø–∏—Å–∏ –≤ –¥–Ω–µ–≤–Ω–∏–∫–µ | 0-100 XP |

---

## –°–∏—Å—Ç–µ–º–∞ XP

### –§–æ—Ä–º—É–ª—ã

**–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
```
XP_earned = habit.xpReward
```

**–®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–æ–ø—É—Å–∫:**
```
XP_penalty = habit.xpPenalty √ó gameSettings.penaltyMultiplier

–ì–¥–µ penaltyMultiplier:
- soft: 0
- balanced: 0.5
- hardcore: 1.0
- custom: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π (0-1)
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- XP –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∏–∂–µ 0
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞: 100 XP –∑–∞ –ø—Ä–∏–≤—ã—á–∫—É
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ: 200 XP –∑–∞ –ø—Ä–∏–≤—ã—á–∫—É

### XP –∑–∞ –Ω–µ–¥–µ–ª—é
```
weekXP = SUM(–≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ 7 –¥–Ω–µ–π √ó xpReward) 
       - SUM(–≤—Å–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞ 7 –¥–Ω–µ–π √ó xpPenalty √ó penaltyMultiplier)
```

---

## –°–∏—Å—Ç–µ–º–∞ –∞–º–Ω–∏—Å—Ç–∏–π

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

**–£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
1. `difficultyMode !== 'soft'`
2. `weeklyAmnestyCount > 0`
3. `amnestiesRemaining > 0` (–Ω–µ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã)

**–†–∞—Å—á—ë—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö:**
```
amnestiesRemaining = weeklyAmnestyCount - amnestiedDates.filter(d => isThisWeek(d)).length
```

**–°–±—Ä–æ—Å:**
- –°—á—ë—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
- amnestiedDates –æ—á–∏—â–∞–µ—Ç—Å—è –æ—Ç –¥–∞—Ç —Å—Ç–∞—Ä—à–µ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏

### –ë–∞–Ω–Ω–µ—Ä –∞–º–Ω–∏—Å—Ç–∏–∏
–ü–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –µ—Å–ª–∏:
1. `amnestiesRemaining > 0`
2. `missedDaysForAmnesty.length > 0` (–µ—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–Ω–∏ –∑–∞ 7 –¥–Ω–µ–π)

---

## –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–µ–∫–µ—Ä–∞

### –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

| –ë–ª–æ–∫ | –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ | –ö–ª–∏–∫ |
|------|---------|---------|------|
| **–î–Ω–µ–π –ø–æ–¥—Ä—è–¥** | Streak | –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å–µ—Ä–∏—è –¥–Ω–µ–π —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º | –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ —Å–µ—Ä–∏–π |
| **–°–µ–≥–æ–¥–Ω—è** | –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è | `completed / scheduled` –ø—Ä–∏–≤—ã—á–µ–∫ | –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ —Å–ø–∏—Å–∫–æ–º |
| **XP –∑–∞ –Ω–µ–¥–µ–ª—é** | –ù–µ–¥–µ–ª—å–Ω—ã–π XP | `SUM(xpReward)` –∑–∞ 7 –¥–Ω–µ–π | –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ |
| **–ê–º–Ω–∏—Å—Ç–∏—è** | –î–æ—Å—Ç—É–ø–Ω—ã–µ | `remaining / total` | –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –¥–Ω—è |
| **–†–µ–∂–∏–º** | –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º | - | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ |

### –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–≤—ã—á–∫–∏

**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- –ò–∫–æ–Ω–∫–∞ –ø—Ä–∏–≤—ã—á–∫–∏
- –ù–∞–∑–≤–∞–Ω–∏–µ
- –ë–µ–π–¥–∂ XP –Ω–∞–≥—Ä–∞–¥—ã
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (7 –¥–Ω–µ–π —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏)
- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è

**–¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –¥–Ω–µ–π:**
| –°—Ç–∞—Ç—É—Å | –¶–≤–µ—Ç | HEX |
|--------|------|-----|
| –í—ã–ø–æ–ª–Ω–µ–Ω–æ | –ó–µ–ª—ë–Ω—ã–π | #22c55e |
| –ü—Ä–æ–ø—É—â–µ–Ω–æ | –ö—Ä–∞—Å–Ω—ã–π | #ef4444 |
| –£–≤–∞–∂. –ø—Ä–æ–ø—É—Å–∫ | –ñ—ë–ª—Ç—ã–π | #eab308 |
| –ê–º–Ω–∏—Å—Ç–∏—è | –†–æ–∑–æ–≤—ã–π | #ec4899 |
| –°–µ–≥–æ–¥–Ω—è (–æ–∂–∏–¥–∞–µ—Ç) | –§–∏–æ–ª–µ—Ç–æ–≤—ã–π | #7c3aed |
| –ë—É–¥—É—â–µ–µ | –°–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π | rgba(124,58,237,0.2) |
| –ù–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ | –°–µ—Ä—ã–π | opacity 0.4 |

---

## –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

–í–∫–ª–∞–¥–∫–∞ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞" —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –ø—Ä–∏–≤—ã—á–∫–∞–º.

### –ë–ª–æ–∫ 1: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Completion)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫ –∑–∞ —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã.

**–ú–µ—Ç—Ä–∏–∫–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ:**
| –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ |
|---------|---------|
| –ó–∞ 7 –¥–Ω–µ–π | `(completed / scheduled) √ó 100%` –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π |
| –ó–∞ 30 –¥–Ω–µ–π | `(completed / scheduled) √ó 100%` –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π |

**–ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫ (14 –¥–Ω–µ–π):**
- 14 –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –±–∞—Ä–æ–≤
- –í—ã—Å–æ—Ç–∞ –±–∞—Ä–∞ = `(completed / scheduled) √ó 100%`
- –¶–≤–µ—Ç: —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π (filled), —Å–≤–µ—Ç–ª—ã–π (partial), —Å–µ—Ä—ã–π (empty)

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è":**

| –°–µ–∫—Ü–∏—è | –î–∞–Ω–Ω—ã–µ |
|--------|--------|
| **–°–≤–æ–¥–∫–∞** | –ó–∞ 7 –¥–Ω–µ–π %, –ó–∞ 30 –¥–Ω–µ–π %, –î–Ω–µ–π –ø–æ–¥—Ä—è–¥ |
| **–¢—Ä–µ–Ω–¥ –∑–∞ 8 –Ω–µ–¥–µ–ª—å** | –ì—Ä–∞—Ñ–∏–∫ —Å –Ω–µ–¥–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ |
| **–õ—É—á—à–∞—è/–•—É–¥—à–∞—è –Ω–µ–¥–µ–ª—è** | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞–∫—Å–∏–º—É–º–∞ –∏ –º–∏–Ω–∏–º—É–º–∞ |
| **–ü–æ –ø—Ä–∏–≤—ã—á–∫–∞–º** | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–µ |

**–§–æ—Ä–º—É–ª–∞ —Ç—Ä–µ–Ω–¥–∞ –Ω–µ–¥–µ–ª—å:**
```javascript
weeklyCompletionData = –ø–æ—Å–ª–µ–¥–Ω–∏–µ 8 –Ω–µ–¥–µ–ª—å.map(week => {
  completed = 0
  total = 0
  
  for (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏) {
    for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
      if (–ø—Ä–∏–≤—ã—á–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å) {
        total++
        if (–ø—Ä–∏–≤—ã—á–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞) completed++
      }
    }
  }
  
  return { rate: Math.round(completed / total * 100) }
})
```

**–õ—É—á—à–∞—è –Ω–µ–¥–µ–ª—è:**
```javascript
bestWeekRate = Math.max(...weeklyCompletionData.map(w => w.rate))
```

**–•—É–¥—à–∞—è –Ω–µ–¥–µ–ª—è:**
```javascript
worstWeekRate = Math.min(...weeklyCompletionData.filter(w => w.total > 0).map(w => w.rate))
```

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø—Ä–∏–≤—ã—á–∫–∞–º (–∑–∞ 30 –¥–Ω–µ–π):**
```javascript
habitDistribution = allHabits.map(habit => {
  completed = 0
  total = 0
  
  for (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π) {
    if (–ø—Ä–∏–≤—ã—á–∫–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞) {
      total++
      if (–≤—ã–ø–æ–ª–Ω–µ–Ω–∞) completed++
    }
  }
  
  return { name, rate: Math.round(completed / total * 100) }
}).sort((a, b) => b.rate - a.rate)
```

---

### –ë–ª–æ–∫ 2: –ö–∞–ª–µ–Ω–¥–∞—Ä—å (Calendar)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –≤–∏–¥–µ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã.

**–ú–µ—Ç—Ä–∏–∫–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ:**
- –ú–∏–Ω–∏-heatmap –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏
- –Ø—á–µ–π–∫–∏ —Å 4 —É—Ä–æ–≤–Ω—è–º–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏

**–£—Ä–æ–≤–Ω–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏:**
| –£—Ä–æ–≤–µ–Ω—å | –£—Å–ª–æ–≤–∏–µ | –¶–≤–µ—Ç |
|---------|---------|------|
| level-0 | rate = 0% | –°–µ—Ä—ã–π |
| level-1 | 0% < rate < 33% | –°–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| level-2 | 33% ‚â§ rate < 66% | –°—Ä–µ–¥–Ω–∏–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| level-3 | rate ‚â• 66% | –Ø—Ä–∫–∏–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π |

**–§–æ—Ä–º—É–ª–∞ —É—Ä–æ–≤–Ω—è:**
```javascript
rate = completed / total

level = rate === 0 ? 'level-0'
      : rate < 0.33 ? 'level-1'
      : rate < 0.66 ? 'level-2'
      : 'level-3'
```

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ì–æ–¥–æ–≤–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å":**

| –°–µ–∫—Ü–∏—è | –î–∞–Ω–Ω—ã–µ |
|--------|--------|
| **–°–≤–æ–¥–∫–∞** | –í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π, –ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–Ω–µ–π, –õ—É—á—à–∏–π –º–µ—Å—è—Ü |
| **–ì–æ–¥–æ–≤–æ–π heatmap** | GitHub-style –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞ 12 –º–µ—Å—è—Ü–µ–≤ |
| **–ü–æ –º–µ—Å—è—Ü–∞–º** | 12 –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏ |

**–ì–æ–¥–æ–≤–æ–π heatmap:**
```javascript
yearlyHeatmapData = []
startDate = today - 1 year
currentDate = startDate (–Ω–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏)

while (currentDate <= today) {
  week = []
  for (7 –¥–Ω–µ–π) {
    dateStr = date.toISOString().split('T')[0]
    
    for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
      if (–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞) {
        total++
        if (–≤—ã–ø–æ–ª–Ω–µ–Ω–∞) completed++
      }
    }
    
    rate = total > 0 ? completed / total : 0
    level = calculateLevel(rate)
    
    week.push({ date: dateStr, completed, total, level })
  }
  weeks.push(week)
  currentDate += 7 days
}
```

**–ú–µ—Å—è—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
```javascript
monthlyStats = –ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤.map(month => {
  completed = 0
  total = 0
  
  for (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞) {
    for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
      if (–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞) {
        total++
        if (–≤—ã–ø–æ–ª–Ω–µ–Ω–∞) completed++
      }
    }
  }
  
  rate = Math.round(completed / total * 100)
  isBest = rate === maxRate —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –º–µ—Å—è—Ü–µ–≤
  
  return { name, rate, completed, total, isBest }
})
```

**–í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –∑–∞ –≥–æ–¥:**
```javascript
yearTotalCompletions = Object.values(habitLog).flat().length
```

**–ê–∫—Ç–∏–≤–Ω—ã—Ö –¥–Ω–µ–π:**
```javascript
yearActiveDays = Object.keys(habitLog).filter(date => habitLog[date].length > 0).length
```

---

### –ë–ª–æ–∫ 3: –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (Achievements)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–≥—Ä–æ–≤—ã–µ –±–µ–π–¥–∂–∏ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–≤—ã—á–µ–∫.

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ:**
- –ü–µ—Ä–≤—ã–µ 4 –±–µ–π–¥–∂–∞ (2 —Å—Ç—Ä–æ–∫–∏ –ø–æ 2)
- –°—á—ë—Ç—á–∏–∫: `unlocked / total`
- –ö–Ω–æ–ø–∫–∞ "–í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è"

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è":**
- 4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- 19 –±–µ–π–¥–∂–µ–π —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ‚Äî —è—Ä–∫–∏–µ, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ‚Äî –ø—Ä–∏–≥–ª—É—à—ë–Ω–Ω—ã–µ

---

## –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –°–µ—Ä–∏–∏ (Streak) ‚Äî 7 –±–µ–π–¥–∂–µ–π

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|----|--------|----------|---------|---------|
| `streak3` | üå± | –ü–µ—Ä–≤—ã–µ —Ä–æ—Å—Ç–∫–∏ | 3 –¥–Ω—è –ø–æ–¥—Ä—è–¥ | `habitStreak >= 3` |
| `streak7` | üî• | –ù–µ–¥–µ–ª—è –æ–≥–Ω—è | 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ | `habitStreak >= 7` |
| `streak14` | ‚ö° | –î–≤–µ –Ω–µ–¥–µ–ª–∏ —Å–∏–ª—ã | 14 –¥–Ω–µ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã | `habitStreak >= 14` |
| `streak21` | üß† | –ü—Ä–∏–≤—ã—á–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∞ | 21 –¥–µ–Ω—å ‚Äî –Ω–æ–≤–∞—è –ø—Ä–∏–≤—ã—á–∫–∞ | `habitStreak >= 21` |
| `streak30` | üèÜ | –ú–µ—Å—è—Ü —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ | 30 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ | `habitStreak >= 30` |
| `streak50` | üëë | –ñ–µ–ª–µ–∑–Ω–∞—è –≤–æ–ª—è | 50 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ | `habitStreak >= 50` |
| `streak100` | üíé | –õ–µ–≥–µ–Ω–¥–∞ | 100 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ | `habitStreak >= 100` |

**–†–∞—Å—á—ë—Ç streak:**
```javascript
habitStreak = 0
currentDate = today

while (true) {
  dateStr = currentDate.toISOString().split('T')[0]
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–∏ –ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å
  if (habitLog[dateStr]?.length > 0) {
    habitStreak++
    currentDate -= 1 day
  } else {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–∏ –ª–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏
    hasScheduled = allHabits.some(h => isScheduledForDay(h, currentDate.getDay()))
    
    if (hasScheduled) {
      break // Streak –ø—Ä–µ—Ä–≤–∞–Ω
    } else {
      currentDate -= 1 day // –î–µ–Ω—å –±–µ–∑ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
    }
  }
}
```

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Completion) ‚Äî 4 –±–µ–π–¥–∂–∞

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|----|--------|----------|---------|---------|
| `perfectWeek` | ‚ú® | –ò–¥–µ–∞–ª—å–Ω–∞—è –Ω–µ–¥–µ–ª—è | 100% –∑–∞ 7 –¥–Ω–µ–π | `weekCompletionRate === 100` |
| `week80` | üéØ | –ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª | 80%+ –∑–∞ –Ω–µ–¥–µ–ª—é | `weekCompletionRate >= 80` |
| `month80` | üìà | –°—Ç–∞–±–∏–ª—å–Ω—ã–π –º–µ—Å—è—Ü | 80%+ –∑–∞ 30 –¥–Ω–µ–π | `monthCompletionRate >= 80` |
| `perfectMonth` | üåü | –ò–¥–µ–∞–ª—å–Ω—ã–π –º–µ—Å—è—Ü | 100% –∑–∞ 30 –¥–Ω–µ–π | `monthCompletionRate === 100` |

**–†–∞—Å—á—ë—Ç weekCompletionRate:**
```javascript
completed = 0
total = 0

for (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π) {
  for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
    if (–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å) {
      total++
      if (–≤—ã–ø–æ–ª–Ω–µ–Ω–∞) completed++
    }
  }
}

weekCompletionRate = Math.round(completed / total * 100)
```

**–†–∞—Å—á—ë—Ç monthCompletionRate:**
```javascript
// –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –∑–∞ 30 –¥–Ω–µ–π
```

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –û–±—ä—ë–º (Volume) ‚Äî 5 –±–µ–π–¥–∂–µ–π

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|----|--------|----------|---------|---------|
| `first` | üöÄ | –ü–µ—Ä–≤—ã–π —à–∞–≥ | –ü–µ—Ä–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ | `totalCompletions >= 1` |
| `completions10` | üéñÔ∏è | –î–µ—Å—è—Ç–∫–∞ | 10 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 10` |
| `completions50` | üèÖ | –ü–æ–ª—Å–æ—Ç–Ω–∏ | 50 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 50` |
| `completions100` | ü•á | –°–æ—Ç–Ω—è | 100 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 100` |
| `completions500` | üèÜ | –ú–∞—Å—Ç–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫ | 500 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 500` |

**–†–∞—Å—á—ë—Ç totalCompletions:**
```javascript
totalCompletions = Object.values(habitLog).flat().length
// –°—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è
```

---

### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ (Variety) ‚Äî 3 –±–µ–π–¥–∂–∞

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –§–æ—Ä–º—É–ª–∞ |
|----|--------|----------|---------|---------|
| `habits3` | üåà | –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ | 3 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–∫–∏ | `allHabits.length >= 3` |
| `habits5` | üé® | –ë–æ–≥–∞—Ç—ã–π –∞—Ä—Å–µ–Ω–∞–ª | 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ | `allHabits.length >= 5` |
| `habits10` | üåç | –í—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Ä–æ—Å—Ç | 10 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ | `allHabits.length >= 10` |

**–†–∞—Å—á—ë—Ç allHabits.length:**
```javascript
// –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ (deletedAt === null)
allHabits = habits.filter(h => !h.deletedAt)
```

---

### –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–µ–π–¥–∂–µ–π

–ö–∞–∂–¥—ã–π –±–µ–π–¥–∂ –∏–º–µ–µ—Ç –ø–æ–ª—è:
```javascript
{
  progress: —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ target),
  target: —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
}

// –ü—Ä–∏–º–µ—Ä –¥–ª—è streak7:
{
  progress: Math.min(habitStreak, 7),
  target: 7
}

// –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä: width = (progress / target) √ó 100%
```

---

### –ë–ª–æ–∫ 4: –ü–æ –ø—Ä–∏–≤—ã—á–∫–∞–º (Per-Habit Analytics)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–µ –æ—Ç–¥–µ–ª—å–Ω–æ.

**–≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–∏:**
| –≠–ª–µ–º–µ–Ω—Ç | –î–∞–Ω–Ω—ã–µ |
|---------|--------|
| –ò–∫–æ–Ω–∫–∞ | habit.icon |
| –ù–∞–∑–≤–∞–Ω–∏–µ | habit.name |
| Streak –±–µ–π–¥–∂ | –î–Ω–µ–π –ø–æ–¥—Ä—è–¥ –¥–ª—è —ç—Ç–æ–π –ø—Ä–∏–≤—ã—á–∫–∏ |
| –ú–∏–Ω–∏-–∫–∞–ª–µ–Ω–¥–∞—Ä—å | 14 –¥–Ω–µ–π —Å —Å—Ç–∞—Ç—É—Å–∞–º–∏ |
| % –∑–∞ –Ω–µ–¥–µ–ª—é | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞ 7 –¥–Ω–µ–π |
| % –∑–∞ –º–µ—Å—è—Ü | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞ 30 –¥–Ω–µ–π |

**–†–∞—Å—á—ë—Ç streak –ø—Ä–∏–≤—ã—á–∫–∏:**
```javascript
getHabitStreak(habit) {
  streak = 0
  currentDate = today
  
  while (true) {
    dateStr = currentDate.toISOString().split('T')[0]
    
    if (!isScheduledForDay(habit, currentDate.getDay())) {
      currentDate -= 1 day
      continue
    }
    
    if (habitLog[dateStr]?.includes(habit.id)) {
      streak++
      currentDate -= 1 day
    } else {
      break
    }
  }
  
  return streak
}
```

**–†–∞—Å—á—ë—Ç % –∑–∞ –ø–µ—Ä–∏–æ–¥:**
```javascript
getHabitCompletionRate(habit, days) {
  completed = 0
  total = 0
  
  for (–ø–æ—Å–ª–µ–¥–Ω–∏–µ N –¥–Ω–µ–π) {
    if (isScheduledForDay(habit, date.getDay())) {
      total++
      if (habitLog[dateStr]?.includes(habit.id)) {
        completed++
      }
    }
  }
  
  return total > 0 ? Math.round(completed / total * 100) : 0
}
```

---

## –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—è

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º

**–≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –°—Ç—Ä–µ–ª–∫–∞ –≤–ª–µ–≤–æ: `currentWeekOffset -= 1`
- –°—Ç—Ä–µ–ª–∫–∞ –≤–ø—Ä–∞–≤–æ: `currentWeekOffset += 1`
- –ö–Ω–æ–ø–∫–∞ "–°–µ–π—á–∞—Å": `currentWeekOffset = 0`

**–†–∞—Å—á—ë—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –Ω–µ–¥–µ–ª–∏:**
```javascript
weekStart = today - today.getDay() + 1 + (currentWeekOffset √ó 7)
weekEnd = weekStart + 6 days
```

### –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—à–ª—ã—Ö –Ω–µ–¥–µ–ª—å

**–ü—Ä–∏ `currentWeekOffset < 0`:**
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä
- –ö–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫ —Å–∫—Ä—ã—Ç—ã
- –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å
- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–Ω—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫

**–í –ø—Ä–æ—à–ª—ã—Ö –Ω–µ–¥–µ–ª—è—Ö (–µ—Å–ª–∏ –ø—Ä–∏–≤—ã—á–∫–∞ –±—ã–ª–∞ –∞–∫—Ç–∏–≤–Ω–∞):**
- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç
- –ï—Å–ª–∏ —É–¥–∞–ª–µ–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏:
  - –ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –∫—Ä–∞—Å–Ω–∞—è —Ä–∞–º–∫–∞
  - –ë–µ–π–¥–∂ "–£–¥–∞–ª–µ–Ω–∞ [–¥–∞—Ç–∞]"
  - –î–Ω–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∏–≥–ª—É—à–µ–Ω—ã –∏ –ø–µ—Ä–µ—á—ë—Ä–∫–Ω—É—Ç—ã

**–í —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–µ:**
- –£–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º–æ–º –±–ª–æ–∫–µ
- –ö–Ω–æ–ø–∫–∏ "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" –∏ "–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞"

---

## –ò–∫–æ–Ω–∫–∏ –ø—Ä–∏–≤—ã—á–µ–∫

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ (32 —à—Ç.)

| –ò–º—è | Emoji | –ö–∞—Ç–µ–≥–æ—Ä–∏—è |
|-----|-------|-----------|
| fire | üî• | –ú–æ—Ç–∏–≤–∞—Ü–∏—è |
| strength | üí™ | –ó–¥–æ—Ä–æ–≤—å–µ |
| brain | üß† | –†–∞–∑–≤–∏—Ç–∏–µ |
| heart | ‚ù§Ô∏è | –û—Ç–Ω–æ—à–µ–Ω–∏—è |
| book | üìö | –û–±—É—á–µ–Ω–∏–µ |
| run | üèÉ | –°–ø–æ—Ä—Ç |
| water | üíß | –ó–¥–æ—Ä–æ–≤—å–µ |
| sleep | üò¥ | –†–µ–∂–∏–º |
| meditation | üßò | –ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ |
| target | üéØ | –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å |
| ... | ... | ... |

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

```javascript
// –ò–∫–æ–Ω–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏ (name)
habit.icon = 'fire' // –ù–µ 'üî•'

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è emoji
getIconEmoji(iconName) {
  return habitIconsData.find(i => i.name === iconName)?.emoji || 'üî•'
}

// –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å emoji
normalizeIconName(iconOrEmoji) {
  if (habitIconsData.some(i => i.name === iconOrEmoji)) {
    return iconOrEmoji
  }
  return habitIconsData.find(i => i.emoji === iconOrEmoji)?.name || 'fire'
}
```

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø—Ä–∏–≤—ã—á–∫–∏

**–ó–¥–æ—Ä–æ–≤—å–µ (5):**
| –ù–∞–∑–≤–∞–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ | XP | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|-----|------------|
| –ó–∞—Ä—è–¥–∫–∞ 10 –º–∏–Ω | strength | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –í—ã–ø–∏—Ç—å 2–ª –≤–æ–¥—ã | water | 5 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ü—Ä–æ–≥—É–ª–∫–∞ 30 –º–∏–Ω | run | 15 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –°–æ–Ω –¥–æ 23:00 | sleep | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ü—Ä–∏—ë–º –≤–∏—Ç–∞–º–∏–Ω–æ–≤ | heart | 5 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |

**–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (5):**
| –ù–∞–∑–≤–∞–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ | XP | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|-----|------------|
| –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–Ω—è | target | 10 | –ë—É–¥–Ω–∏ |
| –§–æ–∫—É—Å-—Å–µ—Å—Å–∏—è 25 –º–∏–Ω | brain | 15 | –ë—É–¥–Ω–∏ |
| Inbox Zero | target | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –û–±—É—á–µ–Ω–∏–µ 30 –º–∏–Ω | book | 20 | –ë—É–¥–Ω–∏ |
| –†–µ–≤—å—é –¥–Ω—è | target | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |

**–°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ (5):**
| –ù–∞–∑–≤–∞–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ | XP | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|-----|------------|
| –ß—Ç–µ–Ω–∏–µ 20 —Å—Ç—Ä–∞–Ω–∏—Ü | book | 15 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ú–µ–¥–∏—Ç–∞—Ü–∏—è 10 –º–∏–Ω | meditation | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ò–∑—É—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ | brain | 15 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ 30 –º–∏–Ω | palette | 20 | –í—ã—Ö–æ–¥–Ω—ã–µ |
| –í–µ–¥–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–∏–∫–∞ | book | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |

**–ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (5):**
| –ù–∞–∑–≤–∞–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ | XP | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|-----|------------|
| 3 –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ | heart | 5 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ë–µ–∑ —Å–æ—Ü—Å–µ—Ç–µ–π 2—á | shield | 15 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ | meditation | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –í—Ä–µ–º—è —Å –±–ª–∏–∑–∫–∏–º–∏ | heart | 20 | –í—ã—Ö–æ–¥–Ω—ã–µ |
| –ü–æ–∑–∏—Ç–∏–≤–Ω–∞—è –º—ã—Å–ª—å | smile | 5 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |

**–†–µ–∂–∏–º (5):**
| –ù–∞–∑–≤–∞–Ω–∏–µ | –ò–∫–æ–Ω–∫–∞ | XP | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|-----|------------|
| –ü–æ–¥—ä—ë–º –≤ 7:00 | sun | 15 | –ë—É–¥–Ω–∏ |
| –†–µ–∂–∏–º —Å–Ω–∞ | sleep | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ë–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —É—Ç—Ä–æ–º | shield | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –í–µ—á–µ—Ä–Ω–∏–π —Ä–∏—Ç—É–∞–ª | moon | 10 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |
| –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —É—Ç—Ä—É | target | 5 | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ |

---

## API Endpoints (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—ç–∫–µ–Ω–¥–∞)

### –ü—Ä–∏–≤—ã—á–∫–∏
| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/habits/` | –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| POST | `/api/habits/` | –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ |
| PATCH | `/api/habits/{id}/` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ |
| DELETE | `/api/habits/{id}/` | Soft-delete –ø—Ä–∏–≤—ã—á–∫–∏ |
| POST | `/api/habits/{id}/restore/` | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ |
| DELETE | `/api/habits/{id}/permanent/` | –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/habits/log/` | –õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π |
| POST | `/api/habits/log/` | –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |
| DELETE | `/api/habits/log/{date}/{habit_id}/` | –û—Ç–º–µ–Ω–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏
| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/habits/settings/` | –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| PATCH | `/api/habits/settings/` | –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |

### –ê–º–Ω–∏—Å—Ç–∏—è
| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/api/habits/amnesty/` | –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é –∫ –¥–∞—Ç–µ |
| DELETE | `/api/habits/amnesty/{date}/` | –û—Ç–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é |

---

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

### –¢–∞–±–ª–∏—Ü–∞: habits
```sql
CREATE TABLE habits (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id) NOT NULL,
  name VARCHAR(100) NOT NULL,
  icon VARCHAR(50) DEFAULT 'fire',
  xp_reward INTEGER DEFAULT 5 CHECK (xp_reward BETWEEN 1 AND 100),
  xp_penalty INTEGER DEFAULT 0 CHECK (xp_penalty BETWEEN 0 AND 200),
  frequency_type VARCHAR(20) DEFAULT 'daily',
  schedule_days INTEGER[] DEFAULT '{1,2,3,4,5,6,0}',
  description TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  deleted_at TIMESTAMP NULL
);
```

### –¢–∞–±–ª–∏—Ü–∞: habit_completions
```sql
CREATE TABLE habit_completions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  habit_id UUID REFERENCES habits(id) NOT NULL,
  user_id UUID REFERENCES users(id) NOT NULL,
  date DATE NOT NULL,
  status VARCHAR(20) DEFAULT 'completed',
  note TEXT,
  excuse_reason TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  
  UNIQUE(habit_id, date)
);
```

### –¢–∞–±–ª–∏—Ü–∞: habit_settings
```sql
CREATE TABLE habit_settings (
  user_id UUID PRIMARY KEY REFERENCES users(id),
  difficulty_mode VARCHAR(20) DEFAULT 'soft',
  penalty_multiplier DECIMAL(3,2) DEFAULT 0,
  weekly_amnesty_count INTEGER DEFAULT 0,
  planning_penalty_enabled BOOLEAN DEFAULT FALSE,
  planning_penalty_amount INTEGER DEFAULT 0,
  journal_penalty_enabled BOOLEAN DEFAULT FALSE,
  journal_penalty_amount INTEGER DEFAULT 0,
  amnestied_dates DATE[] DEFAULT '{}'
);
```

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞: –î–µ–∫–∞–±—Ä—å 2025*
