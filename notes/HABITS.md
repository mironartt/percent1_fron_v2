# –†–∞–∑–¥–µ–ª "–ü—Ä–∏–≤—ã—á–∫–∏" (Habits) ‚Äî –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ](#–æ–±—â–µ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
3. [–°—Ç–∞—Ç—É—Å—ã –¥–Ω–µ–π](#—Å—Ç–∞—Ç—É—Å—ã-–¥–Ω–µ–π)
4. [–í—Å–µ —Ñ–ª–æ—É –ø—Ä–∏–≤—ã—á–µ–∫](#–≤—Å–µ-—Ñ–ª–æ—É-–ø—Ä–∏–≤—ã—á–µ–∫)
5. [–†–µ–∂–∏–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏](#—Ä–µ–∂–∏–º—ã-—Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
6. [–°–∏—Å—Ç–µ–º–∞ XP](#—Å–∏—Å—Ç–µ–º–∞-xp)
7. [–°–∏—Å—Ç–µ–º–∞ –∞–º–Ω–∏—Å—Ç–∏–π](#—Å–∏—Å—Ç–µ–º–∞-–∞–º–Ω–∏—Å—Ç–∏–π)
8. [–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–µ–∫–µ—Ä–∞](#—Å—Ç—Ä–∞–Ω–∏—Ü–∞-—Ç—Ä–µ–∫–µ—Ä–∞)
9. [–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏](#—Å—Ç—Ä–∞–Ω–∏—Ü–∞-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
10. [–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π](#—Å–∏—Å—Ç–µ–º–∞-–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)
11. [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)

---

## –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å "–ü—Ä–∏–≤—ã—á–∫–∏" ‚Äî –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —Å–∏—Å—Ç–µ–º–æ–π –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –æ—Ç–º–µ—á–∞–µ—Ç –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–∞–µ—Ç XP-–Ω–∞–≥—Ä–∞–¥—ã. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 4 —Ä–µ–∂–∏–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, —à—Ç—Ä–∞—Ñ—ã –∑–∞ –ø—Ä–æ–ø—É—Å–∫–∏, –º–µ—Ö–∞–Ω–∏–∫—É –∞–º–Ω–∏—Å—Ç–∏–π –∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–µ–∫ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –±—É–¥–Ω–∏, –≤—ã—Ö–æ–¥–Ω—ã–µ, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –¥–Ω–∏)
- XP-–Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (1-100 XP –∑–∞ –ø—Ä–∏–≤—ã—á–∫—É)
- –®—Ç—Ä–∞—Ñ—ã –∑–∞ –ø—Ä–æ–ø—É—Å–∫–∏ (0-200 XP, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
- 4 —Ä–µ–∂–∏–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–ú—è–≥–∫–∏–π, –ë–∞–ª–∞–Ω—Å, –•–∞—Ä–¥–∫–æ—Ä, –°–≤–æ–π)
- –°–∏—Å—Ç–µ–º–∞ –∞–º–Ω–∏—Å—Ç–∏–π –¥–ª—è "–ø—Ä–æ—â–µ–Ω–∏—è" –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π
- –£–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã
- –ó–∞–º–µ—Ç–∫–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è–º/–ø—Ä–æ–ø—É—Å–∫–∞–º
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ —Ç–µ–ø–ª–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏
- 19 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ 4 –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- Soft-delete –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª—å –ø—Ä–∏–≤—ã—á–∫–∏ (Habit)

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|------|-----|----------|----------------|
| `id` | string/number | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (backend_id –∏–ª–∏ UUID) | –î–∞ |
| `name` | string | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (–¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤) | –î–∞ |
| `icon` | string | –ö–æ–¥ –∏–∫–æ–Ω–∫–∏ ('fire', 'strength', 'brain', etc.) | –î–∞ (default: 'fire') |
| `description` | string | –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (–¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤) | –ù–µ—Ç |
| `xp_reward` | number | XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (1-100) | –î–∞ (default: 5) |
| `xp_penalty` | number | –®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–æ–ø—É—Å–∫ (0-200) | –î–∞ (default: 0) |
| `frequency_type` | string | –¢–∏–ø —á–∞—Å—Ç–æ—Ç—ã: 'daily', 'weekdays', 'weekends', 'custom' | –î–∞ |
| `schedule_days` | number[] | –î–Ω–∏ –Ω–µ–¥–µ–ª–∏ [0-6], –≥–¥–µ 0=–í—Å, 1=–ü–Ω, ... 6=–°–± | –î–ª—è 'custom' |
| `date_created` | string | ISO –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | –î–∞ |
| `date_deleted` | string/null | ISO –¥–∞—Ç–∞ –º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è | –ù–µ—Ç |
| `week_schedule` | array | –ú–∞—Å—Å–∏–≤ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –¥–Ω—è–º —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏ | –û—Ç –±—ç–∫–µ–Ω–¥–∞ |
| `completions` | array | –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | –û—Ç –±—ç–∫–µ–Ω–¥–∞ |

### week_schedule (–¥–∞–Ω–Ω—ã–µ –¥–Ω—è –æ—Ç –±—ç–∫–µ–Ω–¥–∞)

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `date` | string | –î–∞—Ç–∞ (YYYY-MM-DD) |
| `weekday` | number | –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (1-7, –≥–¥–µ 1=–ü–Ω) |
| `status` | string | –°—Ç–∞—Ç—É—Å: 'completed', 'missed', 'excused', 'pending', 'future' |
| `is_scheduled` | boolean | –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –ª–∏ –ø—Ä–∏–≤—ã—á–∫–∞ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å |
| `note` | string/null | –ó–∞–º–µ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `excuse_reason` | string/null | –ü—Ä–∏—á–∏–Ω–∞ —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞ |
| `xp_earned` | number | –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π XP |
| `xp_penalty` | number | –®—Ç—Ä–∞—Ñ XP |
| `is_amnestied` | boolean | –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –ª–∏ –∞–º–Ω–∏—Å—Ç–∏—è |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ (GameSettings)

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | Default |
|------|-----|----------|---------|
| `difficulty_mode` | string | 'soft', 'balanced', 'hardcore', 'custom' | 'balanced' |
| `planning_penalty_enabled` | boolean | –®—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è | true |
| `planning_penalty_amount` | number | –†–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ (0-100 XP) | 10 |
| `journal_penalty_enabled` | boolean | –®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–æ–ø—É—Å–∫ –¥–Ω–µ–≤–Ω–∏–∫–∞ | true |
| `journal_penalty_amount` | number | –†–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ (0-100 XP) | 10 |
| `amnesty_per_week` | number | –ú–∞–∫—Å–∏–º—É–º –∞–º–Ω–∏—Å—Ç–∏–π –≤ –Ω–µ–¥–µ–ª—é (0-7) | 1 |
| `amnesty_remaining` | number | –û—Å—Ç–∞–ª–æ—Å—å –∞–º–Ω–∏—Å—Ç–∏–π –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ | - |
| `amnestied_dates` | string[] | –î–∞—Ç—ã —Å –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–æ–π –∞–º–Ω–∏—Å—Ç–∏–µ–π | [] |

---

## –°—Ç–∞—Ç—É—Å—ã –¥–Ω–µ–π

–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–∏ –∏–º–µ–µ—Ç –æ–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤:

| –°—Ç–∞—Ç—É—Å | –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –í–∏–∑—É–∞–ª | –®—Ç—Ä–∞—Ñ |
|--------|-----|----------|--------|-------|
| **–í—ã–ø–æ–ª–Ω–µ–Ω–æ** | `completed` | –ü—Ä–∏–≤—ã—á–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å | –ó–µ–ª—ë–Ω—ã–π (#22c55e) | –ù–µ—Ç |
| **–ü—Ä–æ–ø—É—â–µ–Ω–æ** | `missed` | –ü—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (–¥–µ–Ω—å –ø—Ä–æ—à—ë–ª) | –ö—Ä–∞—Å–Ω—ã–π (#ef4444) | –î–∞ |
| **–£–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ** | `excused` | –ü—Ä–æ–ø—É—Å–∫ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã | –ñ—ë–ª—Ç—ã–π (#eab308) | –ù–µ—Ç |
| **–ê–º–Ω–∏—Å—Ç–∏—è** | `amnestied` | –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –∞–º–Ω–∏—Å—Ç–∏—è | –†–æ–∑–æ–≤—ã–π (#ec4899) | –ù–µ—Ç (–æ—Ç–º–µ–Ω—ë–Ω) |
| **–û–∂–∏–¥–∞–Ω–∏–µ** | `pending` | –°–µ–≥–æ–¥–Ω—è, –µ—â—ë –Ω–µ –æ—Ç–º–µ—á–µ–Ω–æ | –§–∏–æ–ª–µ—Ç–æ–≤—ã–π (#7c3aed) | - |
| **–ë—É–¥—É—â–µ–µ** | `future` | –ë—É–¥—É—â–∏–π –¥–µ–Ω—å | –°–≤–µ—Ç–ª—ã–π (#7c3aed/20%) | - |
| **–ù–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ** | `not-scheduled` | –î–µ–Ω—å –Ω–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ | –°–µ—Ä—ã–π (opacity 0.4) | - |

### –ü—Ä–∞–≤–∏–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

```
function getDayStatus(habit, dateStr):
  1. –ï—Å–ª–∏ –¥–µ–Ω—å –Ω–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ (is_scheduled === false) ‚Üí 'not-scheduled'
  2. –ï—Å–ª–∏ –¥–∞—Ç–∞ > —Å–µ–≥–æ–¥–Ω—è ‚Üí 'future'
  3. –ï—Å–ª–∏ –µ—Å—Ç—å is_amnestied === true ‚Üí 'amnestied'
  4. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å === 'completed' ‚Üí 'completed'
  5. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å === 'excused' ‚Üí 'excused'
  6. –ï—Å–ª–∏ –¥–∞—Ç–∞ === —Å–µ–≥–æ–¥–Ω—è ‚Üí 'pending' (–æ–∂–∏–¥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è)
  7. –ò–Ω–∞—á–µ ‚Üí 'missed'
```

---

## –í—Å–µ —Ñ–ª–æ—É –ø—Ä–∏–≤—ã—á–µ–∫

### –§–ª–æ—É 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞:** –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É" –∏–ª–∏ "–ü–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É"

**–®–∞–≥–∏:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "+" ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–æ—Ä–º—ã
2. [–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ] –ö–ª–∏–∫ "–ü–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É":
   ‚Üí –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å 5 –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (25 –≥–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫)
   ‚Üí –ü—Ä–∏ –≤—ã–±–æ—Ä–µ ‚Üí –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º—É
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç:
   - –ù–∞–∑–≤–∞–Ω–∏–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –¥–æ 100 —Å–∏–º–≤–æ–ª–æ–≤)
   - –ò–∫–æ–Ω–∫–∞ (–≤—ã–±–æ—Ä –∏–∑ 24 –∏–∫–æ–Ω–æ–∫, default: 'fire')
   - XP –Ω–∞–≥—Ä–∞–¥–∞ (—Å–ª–∞–π–¥–µ—Ä 1-100, default: 5)
   - XP —à—Ç—Ä–∞—Ñ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–µ–∂–∏–º != soft, 0-200)
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:
     * "–ï–∂–µ–¥–Ω–µ–≤–Ω–æ" ‚Üí frequency_type: 'daily'
     * "–ë—É–¥–Ω–∏" ‚Üí frequency_type: 'weekdays'
     * "–í—ã—Ö–æ–¥–Ω—ã–µ" ‚Üí frequency_type: 'weekends'
     * "–°–≤–æ–π" ‚Üí frequency_type: 'custom' + –≤—ã–±–æ—Ä –¥–Ω–µ–π
   - –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ 500 —Å–∏–º–≤–æ–ª–æ–≤)
4. –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
5. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π ID (temp-xxx)
6. –ü—Ä–∏–≤—ã—á–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π store (–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
7. [Async] POST –∑–∞–ø—Ä–æ—Å –Ω–∞ –±—ç–∫–µ–Ω–¥ /habits/create/
8. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
   - –í—Ä–µ–º–µ–Ω–Ω—ã–π ID –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ backend_id
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è week_schedule –¥–ª—è –ø—Ä–∏–≤—ã—á–∫–∏
9. –ü—Ä–∏ –æ—à–∏–±–∫–µ:
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
   - –ü—Ä–∏–≤—ã—á–∫–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º ID
```

**API:** POST `/app/habits/create/`

---

### –§–ª–æ—É 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (—Å–µ–≥–æ–¥–Ω—è)

**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞:** –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–∏–≤—ã—á–∫–∏ –∏–ª–∏ –¥–µ–Ω—å "—Å–µ–≥–æ–¥–Ω—è" –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏

**–®–∞–≥–∏:**
```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–µ–Ω—å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω? –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –∏–≥–Ω–æ—Ä
2. –ü—Ä–æ–≤–µ—Ä–∫–∞: –¥–µ–Ω—å –Ω–µ –≤ –±—É–¥—É—â–µ–º? –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º ‚Üí –∏–≥–Ω–æ—Ä

3. –ï—Å–ª–∏ –ù–ï –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
   a) –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI (—Å—Ç–∞—Ç—É—Å ‚Üí 'completed')
   b) POST /habits/completions/update/
      { habit_id, date, status: 'completed' }
   c) –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
      - –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP = habit.xp_reward
      - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∏–º–∞—Ü–∏—è "+X XP"
      - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è stats-panel (today_completed, week_xp)
      - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è streak
   d) –ü—Ä–∏ –æ—à–∏–±–∫–µ:
      - Rollback UI
      - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞

4. –ï—Å–ª–∏ –£–ñ–ï –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (—Å–Ω—è—Ç–∏–µ –æ—Ç–º–µ—Ç–∫–∏):
   a) –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI (—Å—Ç–∞—Ç—É—Å ‚Üí 'pending'/'missed')
   b) POST /habits/completions/update/
      { habit_id, date, status: null }
   c) –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
      - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è XP = habit.xp_reward
      - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è stats-panel
   d) –ü—Ä–∏ –æ—à–∏–±–∫–µ:
      - Rollback UI
```

**API:** POST `/app/habits/completions/update/`

---

### –§–ª–æ—É 3: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ–≥–æ –¥–Ω—è

**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞:** –ö–ª–∏–∫ –ø–æ –ø—Ä–æ—à–µ–¥—à–µ–º—É –¥–Ω—é –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ –ø—Ä–∏–≤—ã—á–∫–∏

**–®–∞–≥–∏:**
```
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–Ω—è"
2. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
   - –ò–∫–æ–Ω–∫–∞ + –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏
   - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ (–º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è)
   - –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –¥–Ω—è
   - 3 –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π (–¥–ª—è –ø—Ä–æ—à–ª—ã—Ö –¥–Ω–µ–π):
     * "–í—ã–ø–æ–ª–Ω–µ–Ω–æ" ‚Üí status: 'completed'
     * "–ü—Ä–æ–ø—É—â–µ–Ω–æ" ‚Üí status: 'missed'
     * "–£–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ" ‚Üí status: 'excused' + –ø–æ–ª–µ –ø—Ä–∏—á–∏–Ω—ã
   - –ü–æ–ª–µ –∑–∞–º–µ—Ç–∫–∏
   - [–ï—Å–ª–∏ –∞–º–Ω–∏—Å—Ç–∏—è] –ë–ª–æ–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ + –∫–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã

3. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞:
   a) –ï—Å–ª–∏ 'completed':
      - –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP (–µ—Å–ª–∏ –±—ã–ª–æ 'missed' ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ)
   b) –ï—Å–ª–∏ 'missed':
      - –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è XP —à—Ç—Ä–∞—Ñ–∞
   c) –ï—Å–ª–∏ 'excused':
      - –®—Ç—Ä–∞—Ñ –ù–ï —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
      - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è excuse_reason

4. –ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É –¥–Ω—è–º–∏:
   - –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏ (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∞)

5. –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞:
   - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ stats-panel
```

**API:** POST `/app/habits/completions/update/`

---

### –§–ª–æ—É 4: –£–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–ø—É—Å–∫

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫ —Å –ø—Ä–∏—á–∏–Ω–æ–π –±–µ–∑ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è —à—Ç—Ä–∞—Ñ–∞

**–®–∞–≥–∏:**
```
1. –í –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–Ω—è:
2. –ù–∞–∂–∞—Ç—å "–£–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ"
3. –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ –ø—Ä–∏—á–∏–Ω—ã:
   - "–ë–æ–ª–µ–∑–Ω—å"
   - "–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞"
   - "–§–æ—Ä—Å-–º–∞–∂–æ—Ä"
   - –ò–ª–∏ —Å–≤–æ–π —Ç–µ–∫—Å—Ç
4. –ù–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
5. POST /habits/completions/update/
   { habit_id, date, status: 'excused', excuse_reason: '...' }
6. –î–µ–Ω—å –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∂—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º
7. –®—Ç—Ä–∞—Ñ –ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
8. –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ streak (–¥–µ–Ω—å —Å—á–∏—Ç–∞–µ—Ç—Å—è "–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º —Å —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∏—á–∏–Ω–æ–π")
```

**API:** POST `/app/habits/completions/update/`

---

### –§–ª–æ—É 5: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–º–Ω–∏—Å—Ç–∏–∏

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** "–ü—Ä–æ—Å—Ç–∏—Ç—å" –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –¥–µ–Ω—å –∏ –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–∞–Ω–Ω—ã–π —à—Ç—Ä–∞—Ñ

**–£—Å–ª–æ–≤–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
```
1. difficulty_mode !== 'soft'
2. amnesty_per_week > 0
3. amnesty_remaining > 0
4. –ï—Å—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–Ω–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
```

**–®–∞–≥–∏:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –±–ª–æ–∫ "–ê–º–Ω–∏—Å—Ç–∏—è" –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST /habits/amnesty/available-days/
3. –ü–æ–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ø–∏–Ω–Ω–µ—Ä
4. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å 2 —Å–µ–∫—Ü–∏—è–º–∏:

   –°–µ–∫—Ü–∏—è "–ê–º–Ω–∏—Å—Ç–∏—è —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞":
   - –°–ø–∏—Å–æ–∫ –¥–Ω–µ–π —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–π –∞–º–Ω–∏—Å—Ç–∏–µ–π
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –¥–∞—Ç–∞, –∫–æ–ª-–≤–æ –ø—Ä–∏–≤—ã—á–µ–∫, –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω—ã–π XP
   - –ö–Ω–æ–ø–∫–∞ "X" –¥–ª—è –æ—Ç–º–µ–Ω—ã

   –°–µ–∫—Ü–∏—è "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–Ω—å –¥–ª—è –ø—Ä–æ—â–µ–Ω–∏—è":
   - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π (can_apply: true, !is_amnestied)
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –¥–∞—Ç–∞, –∫–æ–ª-–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤, —Ä–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞
   - –ü—Ä–∏ –∫–ª–∏–∫–µ ‚Üí –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–º–Ω–∏—Å—Ç–∏–∏

5. –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –¥–µ–Ω—å:
   a) POST /habits/amnesty/apply/ { date: '...' }
   b) –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
      - XP –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è (xp_restored)
      - –î–µ–Ω—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–µ–∫—Ü–∏—é "–ø—Ä–∏–º–µ–Ω–µ–Ω–∞"
      - amnesty_remaining —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
      - Toast: "–ê–º–Ω–∏—Å—Ç–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞! –í–æ–∑–≤—Ä–∞—â–µ–Ω–æ X XP"

6. –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –∞–º–Ω–∏—Å—Ç–∏–∏ (–∫–ª–∏–∫ X):
   a) POST /habits/amnesty/revoke/ { date: '...' }
   b) –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
      - –®—Ç—Ä–∞—Ñ —Å–Ω–æ–≤–∞ —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
      - –î–µ–Ω—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–µ–∫—Ü–∏—é "–¥–ª—è –ø—Ä–æ—â–µ–Ω–∏—è"
      - amnesty_remaining —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
      - Toast: "–ê–º–Ω–∏—Å—Ç–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞. –®—Ç—Ä–∞—Ñ -X XP"
```

**API:**
- POST `/app/habits/amnesty/available-days/` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
- POST `/app/habits/amnesty/apply/` ‚Äî –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é
- POST `/app/habits/amnesty/revoke/` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é

---

### –§–ª–æ—É 6: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞:** –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∫–∞—Ä–∞–Ω–¥–∞—à) –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ

**–®–∞–≥–∏:**
```
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–æ–π
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç:
   - –ù–∞–∑–≤–∞–Ω–∏–µ
   - –ò–∫–æ–Ω–∫–∞
   - XP –Ω–∞–≥—Ä–∞–¥–∞/—à—Ç—Ä–∞—Ñ
   - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
   - –û–ø–∏—Å–∞–Ω–∏–µ
3. –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
4. PUT /habits/update/ { id, ...fields }
5. –ü—Ä–∏ —É—Å–ø–µ—Ö–µ:
   - –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
   - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è week_schedule
   - Toast: "–ü—Ä–∏–≤—ã—á–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞"
6. –ü—Ä–∏ –æ—à–∏–±–∫–µ:
   - Toast —Å –æ—à–∏–±–∫–æ–π
```

**API:** PUT `/app/habits/update/`

---

### –§–ª–æ—É 7: Soft-Delete (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∫—Ä—ã—Ç—å –ø—Ä–∏–≤—ã—á–∫—É, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

**–®–∞–≥–∏:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–£–¥–∞–ª–∏—Ç—å" –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
   "–ü—Ä–∏–≤—ã—á–∫–∞ –±—É–¥–µ—Ç —Å–∫—Ä—ã—Ç–∞. –ò—Å—Ç–æ—Ä–∏—é –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∞—Ä—Ö–∏–≤–µ."
3. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏:
   a) DELETE /habits/delete/ { id }
   b) –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è date_deleted = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞
   c) –ü—Ä–∏–≤—ã—á–∫–∞ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ –±–ª–æ–∫ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ"
   d) –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
4. –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî rollback
```

**API:** DELETE `/app/habits/delete/`

---

### –§–ª–æ—É 8: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

**–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞:** –ë–ª–æ–∫ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏" –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**–®–∞–≥–∏:**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –±–ª–æ–∫ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ"
2. –í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫
3. –ù–∞–∂–∏–º–∞–µ—Ç "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"
4. POST /habits/restore/ { id }
5. date_deleted —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ null
6. –ü—Ä–∏–≤—ã—á–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ
7. Toast: "–ü—Ä–∏–≤—ã—á–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
```

**API:** POST `/app/habits/restore/`

---

### –§–ª–æ—É 9: –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ –∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö

**–®–∞–≥–∏:**
```
1. –í –±–ª–æ–∫–µ "–£–¥–∞–ª—ë–Ω–Ω—ã–µ" –Ω–∞–∂–∞—Ç—å "–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞"
2. –°—Ç—Ä–æ–≥–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
   "–ü—Ä–∏–≤—ã—á–∫–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ –ù–ê–í–°–ï–ì–î–ê. –í—Å—è –∏—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞!"
3. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏:
   a) DELETE /habits/permanent-delete/ { id }
   b) –ü—Ä–∏–≤—ã—á–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ store
   c) –í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —É–¥–∞–ª—è—é—Ç—Å—è
4. –î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ
```

**API:** DELETE `/app/habits/permanent-delete/`

---

### –§–ª–æ—É 10: –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø—Ä–æ—à–ª—ã–µ/–±—É–¥—É—â–∏–µ –Ω–µ–¥–µ–ª–∏

**–®–∞–≥–∏:**
```
1. –í –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –ø—Ä–∏–≤—ã—á–∫–∏ –µ—Å—Ç—å —Å—Ç—Ä–µ–ª–∫–∏ < –∏ >
2. –ü—Ä–∏ –∫–ª–∏–∫–µ –≤–ª–µ–≤–æ:
   a) weekOffset -= 1
   b) –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –¥–∞—Ç—ã –Ω–µ–¥–µ–ª–∏
   c) GET /habits/list/ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
      { date_from: –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, date_to: –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, include_deleted: true }
   d) –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è week_schedule –¥–ª—è –≤—Å–µ—Ö –ø—Ä–∏–≤—ã—á–µ–∫
   e) UI –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

3. –ü—Ä–∏ –∫–ª–∏–∫–µ –≤–ø—Ä–∞–≤–æ:
   a) weekOffset += 1 (–º–∞–∫—Å–∏–º—É–º 0 = —Ç–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è)
   b) –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

4. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –º–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏:
   - "–≠—Ç–∞ –Ω–µ–¥–µ–ª—è" (–µ—Å–ª–∏ weekOffset === 0)
   - "–ü—Ä–æ—à–ª–∞—è –Ω–µ–¥–µ–ª—è" (–µ—Å–ª–∏ weekOffset === -1)
   - "2 –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥" (–µ—Å–ª–∏ weekOffset === -2)
```

**API:** GET `/app/habits/list/?date_from=...&date_to=...&include_deleted=true`

---

### –§–ª–æ—É 11: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏

**–®–∞–≥–∏:**
```
1. –í –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–Ω—è –µ—Å—Ç—å –ø–æ–ª–µ "–ó–∞–º–µ—Ç–∫–∞"
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç
3. –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞ (blur) –∏–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏:
   a) –ü—Ä–æ–≤–µ—Ä–∫–∞: –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –ª–∏ –∑–∞–º–µ—Ç–∫–∞?
   b) –ï—Å–ª–∏ –¥–∞ ‚Üí POST /habits/completions/update/
      { habit_id, date, note: '...' }
   c) –î–ª—è –±—É–¥—É—â–∏—Ö –¥–∞—Ç: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ë–ï–ó —Å—Ç–∞—Ç—É—Å–∞
      (–±—ç–∫–µ–Ω–¥ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–∞—Ç)
4. Toast: "–ó–∞–º–µ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞"
```

**–í–∞–∂–Ω–æ:** –î–ª—è –±—É–¥—É—â–∏—Ö –¥–∞—Ç –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å, —Ç–æ–ª—å–∫–æ –∑–∞–º–µ—Ç–∫—É!

---

## –†–µ–∂–∏–º—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

### –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∂–∏–º–æ–≤

| –†–µ–∂–∏–º | –ö–æ–¥ | –®—Ç—Ä–∞—Ñ—ã | –ú–Ω–æ–∂–∏—Ç–µ–ª—å | –ê–º–Ω–∏—Å—Ç–∏–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|--------|-----------|----------|----------|
| **–ú—è–≥–∫–∏–π** | `soft` | –í—ã–∫–ª—é—á–µ–Ω—ã | 0% | 0 | –¢–æ–ª—å–∫–æ –ø–æ–∑–∏—Ç–∏–≤. –®—Ç—Ä–∞—Ñ—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã. |
| **–ë–∞–ª–∞–Ω—Å** | `balanced` | –í–∫–ª—é—á–µ–Ω—ã | 50% | 1 –≤ –Ω–µ–¥–µ–ª—é | –ó–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞. –£–º–µ—Ä–µ–Ω–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã. |
| **–•–∞—Ä–¥–∫–æ—Ä** | `hardcore` | –í–∫–ª—é—á–µ–Ω—ã | 100% | 0 | –ú–∞–∫—Å–∏–º—É–º –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã. –ü–æ–ª–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã. |
| **–°–≤–æ–π** | `custom` | –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è | 0-100% | 0-7 | –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∞–Ω–∫—Ü–∏–∏

| –°–∞–Ω–∫—Ü–∏—è | –£—Å–ª–æ–≤–∏–µ | –î–∏–∞–ø–∞–∑–æ–Ω | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|----------|
| –ó–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –ù–µ—Ç –ø–ª–∞–Ω–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å | 0-100 XP | –ú–æ—Ç–∏–≤–∞—Ü–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ |
| –ó–∞ –¥–Ω–µ–≤–Ω–∏–∫ | –ü—Ä–æ–ø—É—Å–∫ –∑–∞–ø–∏—Å–∏ –≤ –¥–Ω–µ–≤–Ω–∏–∫–µ | 0-100 XP | –ú–æ—Ç–∏–≤–∞—Ü–∏—è –≤–µ—Å—Ç–∏ —Ä–µ—Ñ–ª–µ–∫—Å–∏—é |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–Ω–∫—Ü–∏–π (Backend –ø–æ–ª—è)

```javascript
{
  planning_penalty_enabled: true,  // –í–∫–ª—é—á—ë–Ω –ª–∏ —à—Ç—Ä–∞—Ñ
  planning_penalty_amount: 10,     // –†–∞–∑–º–µ—Ä (0 –µ—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω)
  journal_penalty_enabled: true,
  journal_penalty_amount: 10
}
```

---

## –°–∏—Å—Ç–µ–º–∞ XP

### –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á—ë—Ç–∞

**–ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
```
XP_earned = habit.xp_reward
–î–∏–∞–ø–∞–∑–æ–Ω: 1-100 XP
```

**–®—Ç—Ä–∞—Ñ –∑–∞ –ø—Ä–æ–ø—É—Å–∫:**
```
XP_penalty = habit.xp_penalty √ó penalty_multiplier

–ì–¥–µ penalty_multiplier (–ø–æ —Ä–µ–∂–∏–º—É):
- soft: 0 (—à—Ç—Ä–∞—Ñ–æ–≤ –Ω–µ—Ç)
- balanced: 0.5 (50%)
- hardcore: 1.0 (100%)
- custom: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π (0-1)

–î–∏–∞–ø–∞–∑–æ–Ω —à—Ç—Ä–∞—Ñ–∞: 0-200 XP
```

**–ë–∞–ª–∞–Ω—Å XP:**
```
–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∏–∂–µ 0:
new_balance = Math.max(0, current_balance - penalty)
```

### XP –º–µ—Ç—Ä–∏–∫–∏

**XP –∑–∞ –Ω–µ–¥–µ–ª—é (weekXpFromHabits):**
```javascript
weekXpFromHabits = SUM(–≤—Å–µ—Ö xp_earned –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)
  - SUM(–≤—Å–µ—Ö xp_penalty –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)

// –ë–µ—Ä—ë—Ç—Å—è –∏–∑: habitsStore.statsPanel.week_xp
// –ò–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏–∑ xpStore.xpHistory
```

**XP –∑–∞ –º–µ—Å—è—Ü (monthXpFromHabits):**
```javascript
monthXpFromHabits = xpStore.xpHistory
  .filter(e => e.source === 'habit_completed' && isWithin30Days(e.timestamp))
  .reduce((sum, e) => sum + e.amount, 0)
```

**XP –ø–æ –¥–Ω—è–º (xpByDay):**
```javascript
// –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ 7 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–Ω–µ–π:
xpByDay[i] = {
  date: dateStr,
  xp: SUM(xpHistory –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å),
  label: '–ü–Ω'/'–í—Ç'/...,
  isToday: boolean,
  height: (xp / maxXp) * 100  // –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
}
```

---

## –°–∏—Å—Ç–µ–º–∞ –∞–º–Ω–∏—Å—Ç–∏–π

### –î–∞–Ω–Ω—ã–µ –æ—Ç API

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** POST `/app/habits/amnesty/available-days/`

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "ok",
  "data": {
    "week_start": "2024-12-02",
    "week_end": "2024-12-08",
    "amnesty_available": {
      "total": 1,
      "used": 0,
      "remaining": 1
    },
    "days": [
      {
        "date": "2024-12-05",
        "weekday": 4,
        "is_amnestied": false,
        "can_apply": true,
        "total_penalty": 25,
        "missed_habits_count": 2
      }
    ]
  }
}
```

### –ü–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–Ω—è

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `date` | string | –î–∞—Ç–∞ (YYYY-MM-DD) |
| `weekday` | number | –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (1=–ü–Ω, 7=–í—Å) |
| `is_amnestied` | boolean | –£–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∞–º–Ω–∏—Å—Ç–∏—è? |
| `can_apply` | boolean | –ú–æ–∂–Ω–æ –ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å? |
| `total_penalty` | number | –°—É–º–º–∞ —à—Ç—Ä–∞—Ñ–æ–≤ (XP –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—ë—Ç—Å—è) |
| `missed_habits_count` | number | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ |

### –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –¥–Ω–∏ (–¥–ª—è –≤—ã–±–æ—Ä–∞):**
```javascript
missedDaysForAmnesty = days.filter(d => 
  d.can_apply && 
  !d.is_amnestied && 
  d.missed_habits_count > 0
)
```

**–ê–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–Ω–∏:**
```javascript
amnestiedDaysInWeek = days.filter(d => d.is_amnestied)
```

### –°–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–∞

```
–ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫:
- amnesty_remaining —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –¥–æ amnesty_per_week
- –°—Ç–∞—Ä—ã–µ amnestied_dates –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏
```

---

## –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–µ–∫–µ—Ä–∞

### –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

| –ë–ª–æ–∫ | –ú–µ—Ç—Ä–∏–∫–∞ | –î–∞–Ω–Ω—ã–µ | –ö–ª–∏–∫ |
|------|---------|--------|------|
| **–î–Ω–µ–π –ø–æ–¥—Ä—è–¥** | habitStreak | statsPanel.streak | –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º —Å–µ—Ä–∏–∏ |
| **–°–µ–≥–æ–¥–Ω—è** | X/Y | today_completed / today_total | –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è |
| **XP –∑–∞ –Ω–µ–¥–µ–ª—é** | weekXp | statsPanel.week_xp | –ì—Ä–∞—Ñ–∏–∫ XP –ø–æ –¥–Ω—è–º |
| **–ê–º–Ω–∏—Å—Ç–∏—è** | X/Y | remaining / total | –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –¥–Ω—è |
| **–†–µ–∂–∏–º** | –Ω–∞–∑–≤–∞–Ω–∏–µ | difficulty_mode | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ |

### –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–≤—ã—á–∫–∏

**–≠–ª–µ–º–µ–Ω—Ç—ã:**
- –ò–∫–æ–Ω–∫–∞ (emoji)
- –ù–∞–∑–≤–∞–Ω–∏–µ
- –ë–µ–π–¥–∂ XP –Ω–∞–≥—Ä–∞–¥—ã (+X XP)
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –Ω–µ–¥–µ–ª—é (7 —è—á–µ–µ–∫)
- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (7 –¥–Ω–µ–π):**
```
[–ü–Ω] [–í—Ç] [–°—Ä] [–ß—Ç] [–ü—Ç] [–°–±] [–í—Å]
 ‚Üì    ‚Üì    ‚Üì    ‚Üì    ‚Üì    ‚Üì    ‚Üì
–¶–≤–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å–æ–º –¥–Ω—è (—Å–º. "–°—Ç–∞—Ç—É—Å—ã –¥–Ω–µ–π")
```

---

## –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

–í–∫–ª–∞–¥–∫–∞ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞" —Å–æ–¥–µ—Ä–∂–∏—Ç 3 –±–ª–æ–∫–∞ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –∏ 3 –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–Ω–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π.

### –ë–ª–æ–∫ 1: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Completion)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–µ–∫ –∑–∞ —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã.

#### –ö–∞—Ä—Ç–æ—á–∫–∞ (preview)

| –≠–ª–µ–º–µ–Ω—Ç | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| **–ó–∞ 7 –¥–Ω–µ–π** | weekCompletionRate | % –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π |
| **–ó–∞ 30 –¥–Ω–µ–π** | monthCompletionRate | % –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π |
| **–ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫** | last14Days | 14 –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –±–∞—Ä–æ–≤ |

**–§–æ—Ä–º—É–ª–∞ weekCompletionRate:**
```javascript
weekCompletionRate = computed(() => {
  let completed = 0
  let total = 0
  
  for (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π) {
    for (–∫–∞–∂–¥–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
      if (isScheduledForDay(habit, day)) {
        total++
        if (habitLog[dateStr]?.includes(habit.id)) {
          completed++
        }
      }
    }
  }
  
  return total > 0 ? Math.round(completed / total * 100) : 0
})
```

**–§–æ—Ä–º—É–ª–∞ monthCompletionRate:**
```javascript
// –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –∑–∞ 30 –¥–Ω–µ–π
```

#### –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"

| –°–µ–∫—Ü–∏—è | –î–∞–Ω–Ω—ã–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| **–°–≤–æ–¥–∫–∞** | week%, month%, streak | 3 –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ |
| **–¢—Ä–µ–Ω–¥ –∑–∞ 8 –Ω–µ–¥–µ–ª—å** | weeklyCompletionData | –°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ |
| **–ü–æ –ø—Ä–∏–≤—ã—á–∫–∞–º** | habitCompletionDistribution | –†–µ–π—Ç–∏–Ω–≥ –ø—Ä–∏–≤—ã—á–µ–∫ –ø–æ % |
| **–õ—É—á—à–∞—è/–•—É–¥—à–∞—è** | bestWeekRate, worstWeekRate | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–∫—Å—Ç—Ä–µ–º—É–º–æ–≤ |

**–§–æ—Ä–º—É–ª–∞ weeklyCompletionData:**
```javascript
weeklyCompletionData = computed(() => {
  const weeks = []
  
  for (w = 7; w >= 0; w--) {  // 8 –Ω–µ–¥–µ–ª—å –Ω–∞–∑–∞–¥ ‚Üí —Å–µ–π—á–∞—Å
    weekStart = today - today.dayOfWeek + 1 - (w * 7)
    completed = 0
    total = 0
    
    for (d = 0; d < 7; d++) {
      date = weekStart + d
      if (date > today) continue
      
      for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
        if (isScheduledForDay(habit, date.getDay())) {
          total++
          if (habitLog[dateStr]?.includes(habit.id)) {
            completed++
          }
        }
      }
    }
    
    weeks.push({
      label: w === 0 ? '–≠—Ç–∞' : w === 1 ? '–ü—Ä–æ—à–ª–∞—è' : `-${w} –Ω–µ–¥.`,
      rate: total > 0 ? Math.round(completed / total * 100) : 0,
      completed,
      total
    })
  }
  
  return weeks
})
```

**–§–æ—Ä–º—É–ª–∞ bestWeekRate:**
```javascript
bestWeekRate = Math.max(...weeklyCompletionData.map(w => w.rate), 0)
// –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–µ–¥–∏ 8 –Ω–µ–¥–µ–ª—å
```

**–§–æ—Ä–º—É–ª–∞ worstWeekRate:**
```javascript
worstWeekRate = Math.min(
  ...weeklyCompletionData.filter(w => w.total > 0).map(w => w.rate)
)
// –•—É–¥—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ç–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª–∏ —Å –¥–∞–Ω–Ω—ã–º–∏)
```

**–§–æ—Ä–º—É–ª–∞ habitCompletionDistribution:**
```javascript
habitCompletionDistribution = allHabits.map(habit => {
  completed = 0
  total = 0
  
  for (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π) {
    if (isScheduledForDay(habit, date.getDay())) {
      total++
      if (habitLog[dateStr]?.includes(habit.id)) {
        completed++
      }
    }
  }
  
  return {
    id: habit.id,
    name: habit.name,
    icon: habit.icon,
    rate: total > 0 ? Math.round(completed / total * 100) : 0
  }
}).sort((a, b) => b.rate - a.rate)  // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é
```

---

### –ë–ª–æ–∫ 2: –ö–∞–ª–µ–Ω–¥–∞—Ä—å (Calendar)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –≤–∏–¥–µ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã (heatmap).

#### –ö–∞—Ä—Ç–æ—á–∫–∞ (preview)

| –≠–ª–µ–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **–ú–∏–Ω–∏-heatmap** | 4 –Ω–µ–¥–µ–ª–∏ √ó 7 –¥–Ω–µ–π = 28 —è—á–µ–µ–∫ |
| **–£—Ä–æ–≤–Ω–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏** | 4 —É—Ä–æ–≤–Ω—è —Ü–≤–µ—Ç–∞ |

**–£—Ä–æ–≤–Ω–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏:**
```javascript
function getHeatmapLevel(completed, total) {
  if (total === 0) return 'level-0'  // –ù–µ—Ç –ø—Ä–∏–≤—ã—á–µ–∫
  
  rate = completed / total
  
  if (rate === 0) return 'level-0'      // 0% ‚Äî —Å–µ—Ä—ã–π
  if (rate < 0.33) return 'level-1'     // 1-32% ‚Äî —Å–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π
  if (rate < 0.66) return 'level-2'     // 33-65% ‚Äî —Å—Ä–µ–¥–Ω–∏–π
  return 'level-3'                       // 66-100% ‚Äî —è—Ä–∫–∏–π
}
```

| –£—Ä–æ–≤–µ–Ω—å | –î–∏–∞–ø–∞–∑–æ–Ω | –¶–≤–µ—Ç |
|---------|----------|------|
| level-0 | 0% | –°–µ—Ä—ã–π (#2a2a3d) |
| level-1 | 1-32% | –°–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π (rgba(124,58,237,0.3)) |
| level-2 | 33-65% | –°—Ä–µ–¥–Ω–∏–π (rgba(124,58,237,0.5)) |
| level-3 | 66-100% | –Ø—Ä–∫–∏–π (#7c3aed) |

#### –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ì–æ–¥–æ–≤–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å"

| –°–µ–∫—Ü–∏—è | –î–∞–Ω–Ω—ã–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| **–°–≤–æ–¥–∫–∞** | yearTotal, activeDays, bestMonth | 3 –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ |
| **–ì–æ–¥–æ–≤–æ–π heatmap** | yearlyHeatmapData | ~52 –Ω–µ–¥–µ–ª–∏ √ó 7 –¥–Ω–µ–π |
| **–ü–æ –º–µ—Å—è—Ü–∞–º** | monthlyStats | 12 –∫–∞—Ä—Ç–æ—á–µ–∫ —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º |

**–§–æ—Ä–º—É–ª–∞ yearTotalCompletions:**
```javascript
yearTotalCompletions = Object.values(habitLog).flat().length
// –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–º–µ—Ç–æ–∫ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è
```

**–§–æ—Ä–º—É–ª–∞ yearActiveDays:**
```javascript
yearActiveDays = Object.keys(habitLog)
  .filter(date => habitLog[date].length > 0)
  .length
// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π, –∫–æ–≥–¥–∞ –±—ã–ª–∞ —Ö–æ—Ç—è –±—ã 1 –æ—Ç–º–µ—Ç–∫–∞
```

**–§–æ—Ä–º—É–ª–∞ yearlyHeatmapData:**
```javascript
yearlyHeatmapData = computed(() => {
  weeks = []
  startDate = today - 1 –≥–æ–¥
  startDate = startDate - startDate.dayOfWeek + 1  // –ù–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏
  
  currentDate = startDate
  
  while (currentDate <= today) {
    week = []
    
    for (d = 0; d < 7; d++) {
      date = currentDate + d
      
      if (date > today) {
        week.push({ date: null, level: 'level-0' })
        continue
      }
      
      completed = 0
      total = 0
      
      for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
        if (isScheduledForDay(habit, date.getDay())) {
          total++
          if (habitLog[dateStr]?.includes(habit.id)) {
            completed++
          }
        }
      }
      
      level = getHeatmapLevel(completed, total)
      week.push({ date: dateStr, completed, total, level })
    }
    
    weeks.push(week)
    currentDate += 7 –¥–Ω–µ–π
  }
  
  return weeks  // ~52 –Ω–µ–¥–µ–ª–∏
})
```

**–§–æ—Ä–º—É–ª–∞ monthlyStats:**
```javascript
monthlyStats = computed(() => {
  months = []
  monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', ..., '–î–µ–∫–∞–±—Ä—å']
  
  for (m = 11; m >= 0; m--) {  // 12 –º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥ ‚Üí —Å–µ–π—á–∞—Å
    monthDate = today - m –º–µ—Å—è—Ü–µ–≤
    
    completed = 0
    total = 0
    
    for (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞) {
      if (date > today) continue
      
      for (–∫–∞–∂–¥–∞—è –ø—Ä–∏–≤—ã—á–∫–∞) {
        if (isScheduledForDay(habit, date.getDay())) {
          total++
          if (habitLog[dateStr]?.includes(habit.id)) {
            completed++
          }
        }
      }
    }
    
    rate = total > 0 ? Math.round(completed / total * 100) : 0
    
    months.push({
      name: monthNames[monthDate.month],
      rate,
      completed,
      total,
      isBest: false,  // –ü–æ–º–µ—á–∞–µ—Ç—Å—è –ø–æ–∑–∂–µ
      isCurrent: m === 0
    })
  }
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ª—É—á—à–∏–π –º–µ—Å—è—Ü
  maxRate = Math.max(...months.map(m => m.rate))
  months.forEach(m => { m.isBest = m.rate === maxRate && m.rate > 0 })
  
  return months
})
```

**bestMonthName:**
```javascript
bestMonthName = monthlyStats.find(m => m.isBest)?.name || '-'
```

---

### –ë–ª–æ–∫ 3: –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (Achievements)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–≥—Ä–æ–≤—ã–µ –±–µ–π–¥–∂–∏ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–≤—ã—á–µ–∫.

#### –ö–∞—Ä—Ç–æ—á–∫–∞ (preview)

| –≠–ª–µ–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **–ü–µ—Ä–≤—ã–µ 4 –±–µ–π–¥–∂–∞** | 2√ó2 —Å–µ—Ç–∫–∞ |
| **–°—á—ë—Ç—á–∏–∫** | X / Y —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ |
| **–ö–Ω–æ–ø–∫–∞** | "–í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è" |

#### –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è"

- 4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- 19 –±–µ–π–¥–∂–µ–π —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ‚Äî —è—Ä–∫–∏–µ, —Ü–≤–µ—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ‚Äî –ø—Ä–∏–≥–ª—É—à—ë–Ω–Ω—ã–µ, —Å–µ—Ä–∞—è –∏–∫–æ–Ω–∫–∞

---

## –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

### –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ (19 –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π)

#### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –°–µ—Ä–∏–∏ (Streak) ‚Äî 7 –±–µ–π–¥–∂–µ–π

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|----|--------|----------|----------|---------|----------|
| `streak3` | üå± | –ü–µ—Ä–≤—ã–µ —Ä–æ—Å—Ç–∫–∏ | 3 –¥–Ω—è –ø–æ–¥—Ä—è–¥ | `habitStreak >= 3` | streak / 3 |
| `streak7` | üî• | –ù–µ–¥–µ–ª—è –æ–≥–Ω—è | 7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ | `habitStreak >= 7` | streak / 7 |
| `streak14` | ‚ö° | –î–≤–µ –Ω–µ–¥–µ–ª–∏ —Å–∏–ª—ã | 14 –¥–Ω–µ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã | `habitStreak >= 14` | streak / 14 |
| `streak21` | üß† | –ü—Ä–∏–≤—ã—á–∫–∞ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∞ | 21 –¥–µ–Ω—å ‚Äî –Ω–æ–≤–∞—è –ø—Ä–∏–≤—ã—á–∫–∞ | `habitStreak >= 21` | streak / 21 |
| `streak30` | üèÜ | –ú–µ—Å—è—Ü —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ | 30 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ | `habitStreak >= 30` | streak / 30 |
| `streak50` | üëë | –ñ–µ–ª–µ–∑–Ω–∞—è –≤–æ–ª—è | 50 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ | `habitStreak >= 50` | streak / 50 |
| `streak100` | üíé | –õ–µ–≥–µ–Ω–¥–∞ | 100 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ | `habitStreak >= 100` | streak / 100 |

**–§–æ—Ä–º—É–ª–∞ streak:**
```javascript
habitStreak = statsPanel.streak  // –û—Ç –±—ç–∫–µ–Ω–¥–∞

// –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç:
habitStreak = 0
currentDate = today

while (true) {
  dateStr = formatDate(currentDate)
  
  // –ï—Å—Ç—å –ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å?
  if (habitLog[dateStr]?.length > 0) {
    habitStreak++
    currentDate -= 1 –¥–µ–Ω—å
  } else {
    // –ë—ã–ª–∏ –ª–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏?
    hasScheduled = allHabits.some(h => isScheduledForDay(h, currentDate.getDay()))
    
    if (hasScheduled) break  // Streak –ø—Ä–µ—Ä–≤–∞–Ω
    currentDate -= 1 –¥–µ–Ω—å    // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–µ–Ω—å –±–µ–∑ –ø—Ä–∏–≤—ã—á–µ–∫
  }
}
```

---

#### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Completion) ‚Äî 4 –±–µ–π–¥–∂–∞

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|----|--------|----------|----------|---------|----------|
| `perfectWeek` | ‚ú® | –ò–¥–µ–∞–ª—å–Ω–∞—è –Ω–µ–¥–µ–ª—è | 100% –∑–∞ 7 –¥–Ω–µ–π | `weekCompletionRate === 100` | weekRate / 100 |
| `week80` | üéØ | –ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª | 80%+ –∑–∞ –Ω–µ–¥–µ–ª—é | `weekCompletionRate >= 80` | weekRate / 80 |
| `month80` | üìà | –°—Ç–∞–±–∏–ª—å–Ω—ã–π –º–µ—Å—è—Ü | 80%+ –∑–∞ 30 –¥–Ω–µ–π | `monthCompletionRate >= 80` | monthRate / 80 |
| `perfectMonth` | üåü | –ò–¥–µ–∞–ª—å–Ω—ã–π –º–µ—Å—è—Ü | 100% –∑–∞ 30 –¥–Ω–µ–π | `monthCompletionRate === 100` | monthRate / 100 |

---

#### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –û–±—ä—ë–º (Volume) ‚Äî 5 –±–µ–π–¥–∂–µ–π

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|----|--------|----------|----------|---------|----------|
| `first` | üöÄ | –ü–µ—Ä–≤—ã–π —à–∞–≥ | –ü–µ—Ä–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ | `totalCompletions >= 1` | completions / 1 |
| `completions10` | üéñÔ∏è | –î–µ—Å—è—Ç–∫–∞ | 10 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 10` | completions / 10 |
| `completions50` | üèÖ | –ü–æ–ª—Å–æ—Ç–Ω–∏ | 50 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 50` | completions / 50 |
| `completions100` | ü•á | –°–æ—Ç–Ω—è | 100 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 100` | completions / 100 |
| `completions500` | üèÜ | –ú–∞—Å—Ç–µ—Ä –ø—Ä–∏–≤—ã—á–µ–∫ | 500 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π | `totalCompletions >= 500` | completions / 500 |

**–§–æ—Ä–º—É–ª–∞ totalCompletions:**
```javascript
totalCompletions = Object.values(habitLog).flat().length
// –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–º–µ—Ç–æ–∫ –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏
```

---

#### –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ (Variety) ‚Äî 3 –±–µ–π–¥–∂–∞

| ID | –ò–∫–æ–Ω–∫–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –£—Å–ª–æ–≤–∏–µ | –ü—Ä–æ–≥—Ä–µ—Å—Å |
|----|--------|----------|----------|---------|----------|
| `habits3` | üåà | –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ | 3 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–∫–∏ | `activeHabitsCount >= 3` | count / 3 |
| `habits5` | üé® | –ë–æ–≥–∞—Ç—ã–π –∞—Ä—Å–µ–Ω–∞–ª | 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ | `activeHabitsCount >= 5` | count / 5 |
| `habits10` | üåç | –í—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Ä–æ—Å—Ç | 10 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ | `activeHabitsCount >= 10` | count / 10 |

**–§–æ—Ä–º—É–ª–∞ activeHabitsCount:**
```javascript
activeHabitsCount = allHabits.filter(h => !h.date_deleted).length
```

---

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

–î–ª—è –Ω–µ–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä:

```javascript
progressPercent = Math.min(100, (progress / target) * 100)

// –ü—Ä–∏–º–µ—Ä –¥–ª—è streak7:
progress = Math.min(currentStreak, 7)  // –ù–µ –±–æ–ª—å—à–µ target
target = 7
progressPercent = (progress / target) * 100
```

---

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ü—Ä–∏–≤—ã—á–∫–∏ (CRUD)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/app/habits/list/` | –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ —Å week_schedule |
| POST | `/app/habits/create/` | –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É |
| PUT | `/app/habits/update/` | –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É |
| DELETE | `/app/habits/delete/` | Soft-delete |
| POST | `/app/habits/restore/` | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å |
| DELETE | `/app/habits/permanent-delete/` | –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ |

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/app/habits/completions/update/` | –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å/–∑–∞–º–µ—Ç–∫—É |

### –ê–º–Ω–∏—Å—Ç–∏—è

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/app/habits/amnesty/available-days/` | –î–∞–Ω–Ω—ã–µ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ |
| POST | `/app/habits/amnesty/apply/` | –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é |
| POST | `/app/habits/amnesty/revoke/` | –û—Ç–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/app/habits/settings/get/` | –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| POST | `/app/habits/settings/update/` | –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/app/habits/stats-panel/` | –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ |
| GET | `/app/habits/analytics/get/` | –ü–æ–ª–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |
| GET | `/app/habits/achievements/get/` | –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è |

### –ü—Ä–æ—á–µ–µ

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/app/habits/recommended/` | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ |

---

## Changelog

### –î–µ–∫–∞–±—Ä—å 2024
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è API `/amnesty/available-days/` –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∞–º–Ω–∏—Å—Ç–∏–∏
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –Ω–∞—Å—Ç—Ä–æ–µ–∫: `planning_penalty_enabled/amount`, `journal_penalty_enabled/amount`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –∏–∑ API
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è UI –ø–æ—Å–ª–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–º–µ—Ç–∫–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è–º/–ø—Ä–æ–ø—É—Å–∫–∞–º
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–ª—è –±—É–¥—É—â–∏—Ö –¥–∞—Ç
