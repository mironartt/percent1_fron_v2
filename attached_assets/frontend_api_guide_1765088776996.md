# API Documentation –¥–ª—è Frontend ‚Äî –ú–æ–¥—É–ª—å "–ü—Ä–∏–≤—ã—á–∫–∏ –∏ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"

## üìò –û –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å API –º–æ–¥—É–ª—è –ø—Ä–∏–≤—ã—á–µ–∫:
- ‚úÖ –ü–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π –∏ –∏—Ö –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –∏ –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ Best practices –¥–ª—è –∫–∞–∂–¥–æ–≥–æ endpoint

---

## üåê –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**Base URL:** `https://your-domain.com/api/app/habits/`  
**–ú–µ—Ç–æ–¥:** –í—Å–µ endpoints –∏—Å–ø–æ–ª—å–∑—É—é—Ç `POST`  
**Content-Type:** `application/json`  
**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** Token/Session (–∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization)

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:**
```json
{
    "response": {
        "status": "ok",
        "data": { ... }
    }
}
```

**–§–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏:**
```json
{
    "error": {
        "code": "error_code",
        "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
        "details": { ... }
    }
}
```

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ù–∞—Å—Ç—Ä–æ–π–∫–∏](#1-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏-2-endpoints)
2. [–ü—Ä–∏–≤—ã—á–∫–∏](#2-–ø—Ä–∏–≤—ã—á–∫–∏-2-endpoints)
3. [–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ](#3-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ-1-endpoint)
4. [–ê–º–Ω–∏—Å—Ç–∏—è](#4-–∞–º–Ω–∏—Å—Ç–∏—è-2-endpoints)
5. [–ê–Ω–∞–ª–∏—Ç–∏–∫–∞](#5-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞-1-endpoint)
6. [–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è](#6-–¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è-1-endpoint)
7. [–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞](#7-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞-2-endpoints)
8. [XP](#8-xp-2-endpoints)
9. [–ù–∞–≥—Ä–∞–¥—ã](#9-–Ω–∞–≥—Ä–∞–¥—ã-5-endpoints)
10. [–°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#—Å—Ü–µ–Ω–∞—Ä–∏–∏-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
11. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)

---

## 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (2 endpoints)

### 1.1. –ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**Endpoint:** `POST /settings/get/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞ –∏ –∞–º–Ω–∏—Å—Ç–∏–π)
- –ü–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

**Request:**
```json
{}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "difficulty_mode": "balanced",
            "penalty_multiplier": 0.5,
            "weekly_amnesty_count": 1,
            "planning_penalty_enabled": false,
            "planning_penalty_amount": 0,
            "journal_penalty_enabled": false,
            "journal_penalty_amount": 0,
            "amnestied_dates": ["2024-12-05", "2024-12-06"],
            "amnestied_this_week": 2,
            "amnesty_remaining": 0
        }
    }
}
```

**–ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `difficulty_mode` | string | –†–µ–∂–∏–º: 'soft', 'balanced', 'hardcore', 'custom' |
| `penalty_multiplier` | float | –ú–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ç—Ä–∞—Ñ–∞ 0-1 (0.5 = 50%) |
| `weekly_amnesty_count` | int | –õ–∏–º–∏—Ç –∞–º–Ω–∏—Å—Ç–∏–π –≤ –Ω–µ–¥–µ–ª—é (0-7) |
| `planning_penalty_enabled` | bool | –í–∫–ª—é—á—ë–Ω –ª–∏ —à—Ç—Ä–∞—Ñ –∑–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `planning_penalty_amount` | int | –†–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (XP) |
| `journal_penalty_enabled` | bool | –í–∫–ª—é—á—ë–Ω –ª–∏ —à—Ç—Ä–∞—Ñ –∑–∞ –¥–Ω–µ–≤–Ω–∏–∫ |
| `journal_penalty_amount` | int | –†–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –¥–Ω–µ–≤–Ω–∏–∫ (XP) |
| `amnestied_dates` | array | –î–∞—Ç—ã —Å –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω–æ–π –∞–º–Ω–∏—Å—Ç–∏–µ–π |
| `amnestied_this_week` | int | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∞–º–Ω–∏—Å—Ç–∏–π –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ |
| `amnesty_remaining` | int | –û—Å—Ç–∞–ª–æ—Å—å –∞–º–Ω–∏—Å—Ç–∏–π –Ω–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é |

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞—Ç—ã –∏–∑ `amnestied_dates` (—Å—Ç–∞—Ä—à–µ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏)
- `amnesty_remaining` = `weekly_amnesty_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞—Ç –≤ `amnestied_dates` –∑–∞ —Ç–µ–∫—É—â—É—é –Ω–µ–¥–µ–ª—é
- –ü—Ä–∏ —Ä–µ–∂–∏–º–µ 'soft' —à—Ç—Ä–∞—Ñ—ã –≤—Å–µ–≥–¥–∞ 0, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç `penalty_multiplier`

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–∞–Ω–Ω–µ—Ä –∞–º–Ω–∏—Å—Ç–∏–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `amnesty_remaining > 0`
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ `xp_penalty` –≤ —Ñ–æ—Ä–º–µ –ø—Ä–∏–≤—ã—á–∫–∏ –µ—Å–ª–∏ —Ä–µ–∂–∏–º 'soft'
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å "–ë–µ–∑ —à—Ç—Ä–∞—Ñ–æ–≤" –µ—Å–ª–∏ `penalty_multiplier === 0`

---

### 1.2. –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**Endpoint:** `POST /settings/update/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- –ü—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏/–≤—ã–∫–ª—é—á–µ–Ω–∏–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–∞–Ω–∫—Ü–∏–π

**Request:**
```json
{
    "difficulty_mode": "custom",
    "penalty_multiplier": 0.75,
    "weekly_amnesty_count": 2,
    "planning_penalty_enabled": true,
    "planning_penalty_amount": 10,
    "journal_penalty_enabled": false,
    "journal_penalty_amount": 0
}
```

**–í—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã** ‚Äî –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ.

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": true
        }
    }
}
```

**–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–µ–∂–∏–º–∞:**

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `difficulty_mode`:
- `"soft"` ‚Üí `penalty_multiplier: 0`, `weekly_amnesty_count: 0`
- `"balanced"` ‚Üí `penalty_multiplier: 0.5`, `weekly_amnesty_count: 1`
- `"hardcore"` ‚Üí `penalty_multiplier: 1.0`, `weekly_amnesty_count: 0`
- `"custom"` ‚Üí –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `penalty_multiplier`: 0-1
- `weekly_amnesty_count`: 0-7
- `planning_penalty_amount`: 0-100
- `journal_penalty_amount`: 0-100

**–û—à–∏–±–∫–∏:**
```json
{
    "error": {
        "code": "invalid_penalty_multiplier",
        "message": "–ú–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ç—Ä–∞—Ñ–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 0 –¥–æ 1"
    }
}
```

**UI hints:**
- –ü–æ—Å–ª–µ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ (–∏–∑–º–µ–Ω—è—Ç—Å—è —à—Ç—Ä–∞—Ñ—ã)
- –ü–æ–∫–∞–∑–∞—Ç—å confirmation dialog –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ 'hardcore' (–ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –æ –ø–æ—Ç–µ—Ä–µ –∞–º–Ω–∏—Å—Ç–∏–π)

---

## 2. –ü—Ä–∏–≤—ã—á–∫–∏ (2 endpoints)

### 2.1. –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫–∏

**Endpoint:** `POST /get/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É –Ω–µ–¥–µ–ª—è–º–∏
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**Request:**
```json
{
    "date_from": "2024-12-02",
    "date_to": "2024-12-08",
    "include_deleted": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|--------------|----------|
| `date_from` | string | –Ω–µ—Ç | –Ω–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏ | –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ (YYYY-MM-DD) |
| `date_to` | string | –Ω–µ—Ç | –∫–æ–Ω–µ—Ü –Ω–µ–¥–µ–ª–∏ | –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ (YYYY-MM-DD) |
| `include_deleted` | bool | –Ω–µ—Ç | false | –í–∫–ª—é—á–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ |

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "date_from": "2024-12-02",
            "date_to": "2024-12-08",
            "habits": [
                {
                    "habit_id": 123,
                    "name": "–ó–∞—Ä—è–¥–∫–∞ 10 –º–∏–Ω",
                    "icon": "strength",
                    "xp_reward": 10,
                    "xp_penalty": 20,
                    "frequency_type": "daily",
                    "schedule_days": [0, 1, 2, 3, 4, 5, 6],
                    "description": "–£—Ç—Ä–µ–Ω–Ω—è—è —Ä–∞–∑–º–∏–Ω–∫–∞",
                    "date_created": "2024-11-01T10:00:00Z",
                    "date_deleted": null,
                    "week_schedule": [
                        {
                            "date": "2024-12-02",
                            "weekday": 1,
                            "status": "completed",
                            "is_scheduled": true,
                            "note": "–û—Ç–ª–∏—á–Ω–æ —Å–¥–µ–ª–∞–ª!",
                            "excuse_reason": null,
                            "xp_earned": 10,
                            "xp_penalty": 0,
                            "is_amnestied": false
                        },
                        {
                            "date": "2024-12-03",
                            "weekday": 2,
                            "status": "missed",
                            "is_scheduled": true,
                            "note": null,
                            "excuse_reason": null,
                            "xp_earned": 0,
                            "xp_penalty": 10,
                            "is_amnestied": false
                        },
                        {
                            "date": "2024-12-04",
                            "weekday": 3,
                            "status": "excused",
                            "is_scheduled": true,
                            "note": null,
                            "excuse_reason": "–ë—ã–ª –±–æ–ª–µ–Ω",
                            "xp_earned": 0,
                            "xp_penalty": 0,
                            "is_amnestied": false
                        },
                        {
                            "date": "2024-12-05",
                            "weekday": 4,
                            "status": "amnestied",
                            "is_scheduled": true,
                            "note": null,
                            "excuse_reason": null,
                            "xp_earned": 0,
                            "xp_penalty": 0,
                            "is_amnestied": true
                        },
                        {
                            "date": "2024-12-06",
                            "weekday": 5,
                            "status": "pending",
                            "is_scheduled": true,
                            "note": null,
                            "excuse_reason": null,
                            "xp_earned": 0,
                            "xp_penalty": 0,
                            "is_amnestied": false
                        },
                        {
                            "date": "2024-12-07",
                            "weekday": 6,
                            "status": "future",
                            "is_scheduled": true,
                            "note": null,
                            "excuse_reason": null,
                            "xp_earned": 0,
                            "xp_penalty": 0,
                            "is_amnestied": false
                        },
                        {
                            "date": "2024-12-08",
                            "weekday": 0,
                            "status": "future",
                            "is_scheduled": true,
                            "note": null,
                            "excuse_reason": null,
                            "xp_earned": 0,
                            "xp_penalty": 0,
                            "is_amnestied": false
                        }
                    ]
                }
            ],
            "settings": {
                "difficulty_mode": "balanced",
                "penalty_multiplier": 0.5,
                "weekly_amnesty_count": 1,
                "amnestied_dates": ["2024-12-05"],
                "amnesty_remaining": 0
            }
        }
    }
}
```

**–°—Ç–∞—Ç—É—Å—ã –¥–Ω—è (`status`):**

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ | –¶–≤–µ—Ç |
|--------|----------|-------|------|
| `completed` | –í—ã–ø–æ–ª–Ω–µ–Ω–æ | –ü—Ä–æ—à–ª—ã–π/—Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º | –ó–µ–ª—ë–Ω—ã–π |
| `missed` | –ü—Ä–æ–ø—É—â–µ–Ω–æ | –ü—Ä–æ—à–ª—ã–π –¥–µ–Ω—å –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | –ö—Ä–∞—Å–Ω—ã–π |
| `excused` | –£–≤–∞–∂. –ø—Ä–æ–ø—É—Å–∫ | –ü—Ä–æ—à–ª—ã–π –¥–µ–Ω—å, –æ—Ç–º–µ—á–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º | –ñ—ë–ª—Ç—ã–π |
| `amnestied` | –ê–º–Ω–∏—Å—Ç–∏—è | –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –¥–µ–Ω—å —Å –∞–º–Ω–∏—Å—Ç–∏–µ–π | –†–æ–∑–æ–≤—ã–π |
| `pending` | –û–∂–∏–¥–∞–µ—Ç | –¢–µ–∫—É—â–∏–π –¥–µ–Ω—å, –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ | –§–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| `future` | –ë—É–¥—É—â–µ–µ | –ë—É–¥—É—â–∏–π –¥–µ–Ω—å | –°–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π |
| `not-scheduled` | –ù–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ | –î–µ–Ω—å –Ω–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ | –°–µ—Ä—ã–π |

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**–†–∞—Å—á—ë—Ç —Å—Ç–∞—Ç—É—Å–∞:**
```javascript
if (day > today) {
    status = 'future'
} else if (day === today) {
    if (!is_scheduled) {
        status = 'not-scheduled'
    } else if (has_completion) {
        status = completion.status  // 'completed', 'missed', 'excused'
    } else {
        status = 'pending'
    }
} else {  // day < today (–ø—Ä–æ—à–ª–æ–µ)
    if (!is_scheduled) {
        status = 'not-scheduled'
    } else if (has_completion) {
        if (completion.is_amnestied) {
            status = 'amnestied'
        } else {
            status = completion.status
        }
    } else {
        status = 'missed'
    }
}
```

**–í–∞–∂–Ω–æ:**
- `weekday`: 0=–í—Å, 1=–ü–Ω, 2=–í—Ç, 3=–°—Ä, 4=–ß—Ç, 5=–ü—Ç, 6=–°–±
- `schedule_days` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –Ω—É–º–µ—Ä–∞—Ü–∏—é
- `xp_earned` –∏ `xp_penalty` —É–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã —Å —É—á—ë—Ç–æ–º –º–Ω–æ–∂–∏—Ç–µ–ª—è
- `settings` –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–Ω–µ –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å)

**UI hints:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å optimistic updates –¥–ª—è –ª—É—á—à–µ–≥–æ UX
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å skeleton loader –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

---

### 2.2. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫–∏

**Endpoint:** `POST /update/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø—Ä–∏–≤—ã—á–∫–∏
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ø—Ä–∏–≤—ã—á–∫–∏
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ (soft-delete)
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–π –ø—Ä–∏–≤—ã—á–∫–∏
- –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

**Request –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:**
```json
{
    "action": "create",
    "habits": [
        {
            "name": "–ú–µ–¥–∏—Ç–∞—Ü–∏—è 10 –º–∏–Ω",
            "icon": "meditation",
            "xp_reward": 15,
            "xp_penalty": 30,
            "frequency_type": "daily",
            "schedule_days": null,
            "description": "–ü—Ä–∞–∫—Ç–∏–∫–∞ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏"
        }
    ]
}
```

**Request –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```json
{
    "action": "update",
    "habits": [
        {
            "habit_id": 123,
            "name": "–ú–µ–¥–∏—Ç–∞—Ü–∏—è 15 –º–∏–Ω",
            "xp_reward": 20
        }
    ]
}
```

**Request –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:**
```json
{
    "action": "delete",
    "habit_ids": [123, 456],
    "permanent": false
}
```

**Request –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
```json
{
    "action": "restore",
    "habit_ids": [123]
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ–π—Å—Ç–≤–∏–π:**

**CREATE:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ: `name`, `icon`, `xp_reward`, `frequency_type`
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ: `xp_penalty`, `schedule_days`, `description`
- `schedule_days` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –µ—Å–ª–∏ `frequency_type` != 'custom'

**UPDATE:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ: `habit_id`
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ: –ª—é–±—ã–µ –ø–æ–ª—è –ø—Ä–∏–≤—ã—á–∫–∏
- –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–æ–ª—è)

**DELETE:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ: `habit_ids` (–º–∞—Å—Å–∏–≤)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ: `permanent` (bool, default=false)
- –ü—Ä–∏ `permanent=false` –¥–µ–ª–∞–µ—Ç—Å—è soft-delete
- –ü—Ä–∏ `permanent=true` —É–¥–∞–ª–µ–Ω–∏–µ –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ–µ

**RESTORE:**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ: `habit_ids` (–º–∞—Å—Å–∏–≤)
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è soft-deleted –ø—Ä–∏–≤—ã—á–µ–∫

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "created_ids": [789],
            "updated_count": 1,
            "deleted_count": 2,
            "restored_count": 1
        }
    }
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**

| –ü–æ–ª–µ | –ü—Ä–∞–≤–∏–ª–æ |
|------|---------|
| `name` | 1-100 —Å–∏–º–≤–æ–ª–æ–≤ |
| `icon` | –æ–¥–∏–Ω –∏–∑ 32 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö |
| `xp_reward` | 1-100 |
| `xp_penalty` | 0-200 |
| `frequency_type` | 'daily', 'weekdays', 'weekends', 'custom' |
| `schedule_days` | –º–∞—Å—Å–∏–≤ 0-6, —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
| `description` | 0-500 —Å–∏–º–≤–æ–ª–æ–≤ |

**–û—à–∏–±–∫–∏:**

```json
// –ü—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
{
    "error": {
        "code": "habit_not_found",
        "message": "–ü—Ä–∏–≤—ã—á–∫–∞ —Å ID 123 –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    }
}

// –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
{
    "error": {
        "code": "invalid_xp_reward",
        "message": "XP –Ω–∞–≥—Ä–∞–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 1 –¥–æ 100"
    }
}

// –ü–æ–ø—ã—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ —É–¥–∞–ª—ë–Ω–Ω—É—é
{
    "error": {
        "code": "habit_not_deleted",
        "message": "–ü—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞"
    }
}
```

**UI hints:**
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º ID
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å undo toast –ø–æ—Å–ª–µ soft-delete
- –¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ permanent delete
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

---

## 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (1 endpoint)

### 3.1. –û–±–Ω–æ–≤–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

**Endpoint:** `POST /completions/update/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–º–µ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–≤—ã—á–∫–∏
- –°–Ω—è—Ç–∏–µ –æ—Ç–º–µ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ "–ø—Ä–æ–ø—É—â–µ–Ω–æ" –∏–ª–∏ "—É–≤–∞–∂. –ø—Ä–æ–ø—É—Å–∫"
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
- –£–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∞

**Request (–æ—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º):**
```json
{
    "completions": [
        {
            "habit_id": 123,
            "date": "2024-12-06",
            "status": "completed",
            "note": "–û—Ç–ª–∏—á–Ω–æ –≤—ã–ø–æ–ª–Ω–∏–ª!"
        }
    ]
}
```

**Request (–ø—Ä–æ–ø—É—â–µ–Ω–æ —Å –ø—Ä–∏—á–∏–Ω–æ–π):**
```json
{
    "completions": [
        {
            "habit_id": 123,
            "date": "2024-12-05",
            "status": "missed",
            "excuse_reason": "–ë—ã–ª –≤ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–µ"
        }
    ]
}
```

**Request (—É–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–ø—É—Å–∫):**
```json
{
    "completions": [
        {
            "habit_id": 123,
            "date": "2024-12-04",
            "status": "excused",
            "excuse_reason": "–ë–æ–ª–µ–ª"
        }
    ]
}
```

**Request (—Å–Ω—è—Ç—å –æ—Ç–º–µ—Ç–∫—É):**
```json
{
    "completions": [
        {
            "habit_id": 123,
            "date": "2024-12-06",
            "status": null
        }
    ]
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `habit_id` | int | –¥–∞ | ID –ø—Ä–∏–≤—ã—á–∫–∏ |
| `date` | string | –¥–∞ | –î–∞—Ç–∞ (YYYY-MM-DD) |
| `status` | string | –¥–∞ | 'completed', 'missed', 'excused', null |
| `note` | string | –Ω–µ—Ç | –ó–∞–º–µ—Ç–∫–∞ (–ª—é–±–æ–π —Ç–µ–∫—Å—Ç) |
| `excuse_reason` | string | –Ω–µ—Ç | –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∞ |

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "updated_count": 1,
            "xp_changes": {
                "habit_123": {
                    "earned": 10,
                    "penalty": 0
                }
            },
            "new_achievements": [
                {
                    "achievement_id": "streak7",
                    "name": "–ù–µ–¥–µ–ª—è –æ–≥–Ω—è",
                    "icon": "üî•"
                }
            ]
        }
    }
}
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**–ü—Ä–∏ status='completed':**
1. –°–æ–∑–¥–∞—ë—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è HabitCompletion
2. –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è XP = `habit.xp_reward`
3. –°–æ–∑–¥–∞—ë—Ç—Å—è XPTransaction —Å —Ç–∏–ø–æ–º 'habit_completed'
4. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `user.xp_balance` –∏ `user.lifetime_xp`
5. –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
6. –ï—Å–ª–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –Ω–æ–≤–æ–µ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ `new_achievements`

**–ü—Ä–∏ status='missed':**
1. –°–æ–∑–¥–∞—ë—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è HabitCompletion
2. –ï—Å–ª–∏ —Ä–µ–∂–∏–º != 'soft' –ò –¥–∞—Ç–∞ –Ω–µ –≤ –∞–º–Ω–∏—Å—Ç–∏–∏:
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ = `habit.xp_penalty * penalty_multiplier`
   - –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è XP (–º–∏–Ω–∏–º—É–º –¥–æ 0)
   - –°–æ–∑–¥–∞—ë—Ç—Å—è XPTransaction —Å —Ç–∏–ø–æ–º 'habit_penalty'

**–ü—Ä–∏ status='excused':**
1. –°–æ–∑–¥–∞—ë—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è HabitCompletion
2. XP –ù–ï –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –∏ –ù–ï —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
3. `excuse_reason` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

**–ü—Ä–∏ status=null:**
1. HabitCompletion —É–¥–∞–ª—è–µ—Ç—Å—è
2. –í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ XPTransaction –ø–æ–º–µ—á–∞—é—Ç—Å—è is_reversed=true
3. XP –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –±—É–¥—É—â–∏–π –¥–µ–Ω—å (date > today)
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –¥–µ–Ω—å, –Ω–µ –≤—Ö–æ–¥—è—â–∏–π –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏
- `note` –º–∞–∫—Å–∏–º—É–º 1000 —Å–∏–º–≤–æ–ª–æ–≤
- `excuse_reason` –º–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤

**–û—à–∏–±–∫–∏:**
```json
// –ë—É–¥—É—â–∞—è –¥–∞—Ç–∞
{
    "error": {
        "code": "future_date",
        "message": "–ù–µ–ª—å–∑—è –æ—Ç–º–µ—Ç–∏—Ç—å –±—É–¥—É—â–∏–π –¥–µ–Ω—å"
    }
}

// –î–µ–Ω—å –Ω–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏
{
    "error": {
        "code": "not_scheduled",
        "message": "–ü—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å"
    }
}

// –ù–µ—Ç excuse_reason –¥–ª—è excused
{
    "error": {
        "code": "excuse_reason_required",
        "message": "–î–ª—è —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞ –Ω—É–∂–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞"
    }
}
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å +X XP –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å -X XP –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –ø—Ä–æ–ø—É—Å–∫–µ
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å new_achievements –º–æ–¥–∞–ª—å–Ω—ã–º –æ–∫–Ω–æ–º
- –û–±–Ω–æ–≤–ª—è—Ç—å streak –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å optimistic updates

---

## 4. –ê–º–Ω–∏—Å—Ç–∏—è (2 endpoints)

### 4.1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é

**Endpoint:** `POST /amnesty/apply/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –∞–º–Ω–∏—Å—Ç–∏–∏
- –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∞–º–Ω–∏—Å—Ç–∏–∏ (`amnesty_remaining > 0`)
- –†–µ–∂–∏–º != 'soft'

**Request:**
```json
{
    "date": "2024-12-05"
}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": true,
            "xp_returned": 45,
            "amnesty_remaining": 0
        }
    }
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `date` | string | –î–∞—Ç–∞ –¥–ª—è –∞–º–Ω–∏—Å—Ç–∏–∏ (YYYY-MM-DD) |

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π:
   - `difficulty_mode` != 'soft'
   - `weekly_amnesty_count` > 0
   - –î–∞—Ç–∞ –Ω–µ –≤ –±—É–¥—É—â–µ–º
   - –î–∞—Ç–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 7 –¥–Ω–µ–π
   - `amnesty_remaining` > 0
   - –î–∞—Ç–∞ –µ—â—ë –Ω–µ –≤ `amnestied_dates`

2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:
   - –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `amnestied_dates`
   - –ù–∞—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ HabitCompletion —Å `status='missed'` –∑–∞ —ç—Ç—É –¥–∞—Ç—É
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ:
     - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è XP —à—Ç—Ä–∞—Ñ–∞ —á–µ—Ä–µ–∑ XPTransaction
     - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `is_amnestied=True`
     - `xp_penalty` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 0
   - –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è `amnesty_remaining`

3. –í–æ–∑–≤—Ä–∞—Ç XP:
```python
for completion in missed_completions:
    xp_to_return = completion.xp_penalty
    user.xp_balance += xp_to_return
    create_transaction(amount=xp_to_return, type='amnesty_applied')
    completion.is_amnestied = True
```

**–û—à–∏–±–∫–∏:**
```json
// –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–º–Ω–∏—Å—Ç–∏–π
{
    "error": {
        "code": "no_amnesty_remaining",
        "message": "–í—Å–µ –∞–º–Ω–∏—Å—Ç–∏–∏ –Ω–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã"
    }
}

// –î–∞—Ç–∞ —É–∂–µ –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
{
    "error": {
        "code": "already_amnestied",
        "message": "–≠—Ç–æ—Ç –¥–µ–Ω—å —É–∂–µ –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω"
    }
}

// –î–∞—Ç–∞ —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–∞—è
{
    "error": {
        "code": "date_too_old",
        "message": "–ú–æ–∂–Ω–æ –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–Ω–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é"
    }
}

// –†–µ–∂–∏–º soft
{
    "error": {
        "code": "soft_mode",
        "message": "–í –º—è–≥–∫–æ–º —Ä–µ–∂–∏–º–µ –∞–º–Ω–∏—Å—Ç–∏—è –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞"
    }
}
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–∫–æ–ª—å–∫–æ XP –≤–µ—Ä–Ω—ë—Ç—Å—è
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –µ—Å–ª–∏ `amnesty_remaining === 0`
- –û–±–Ω–æ–≤–ª—è—Ç—å UI —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–º–Ω–∏—Å—Ç–∏–∏

---

### 4.2. –û—Ç–º–µ–Ω–∏—Ç—å –∞–º–Ω–∏—Å—Ç–∏—é

**Endpoint:** `POST /amnesty/revoke/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–∞–Ω–µ–µ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—É—é –∞–º–Ω–∏—Å—Ç–∏—é
- –û—Å–≤–æ–±–æ–¥–∏—Ç—å —Å–ª–æ—Ç –∞–º–Ω–∏—Å—Ç–∏–∏ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –¥–Ω—è

**Request:**
```json
{
    "date": "2024-12-05"
}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": true,
            "xp_deducted": 45,
            "amnesty_remaining": 1
        }
    }
}
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

1. –ü—Ä–æ–≤–µ—Ä–∫–∞:
   - –î–∞—Ç–∞ –µ—Å—Ç—å –≤ `amnestied_dates`

2. –û—Ç–º–µ–Ω–∞:
   - –î–∞—Ç–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ `amnestied_dates`
   - –ù–∞—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ HabitCompletion —Å `is_amnestied=True` –∑–∞ —ç—Ç—É –¥–∞—Ç—É
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ:
     - –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —à—Ç—Ä–∞—Ñ —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ XPTransaction
     - `is_amnestied` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è False
     - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `xp_penalty`
   - –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è `amnesty_remaining`

**–û—à–∏–±–∫–∏:**
```json
// –î–∞—Ç–∞ –Ω–µ –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞
{
    "error": {
        "code": "not_amnestied",
        "message": "–≠—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ –±—ã–ª –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω"
    }
}
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –æ—Ç–º–µ–Ω–æ–π
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å —á—Ç–æ XP –±—É–¥–µ—Ç —Å–ø–∏—Å–∞–Ω
- –û–±–Ω–æ–≤–ª—è—Ç—å —Å—á—ë—Ç—á–∏–∫ –∞–º–Ω–∏—Å—Ç–∏–π

---

## 5. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (1 endpoint)

### 5.1. –ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É

**Endpoint:** `POST /analytics/get/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"
- –ö–ª–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ" / "–ö–∞–ª–µ–Ω–¥–∞—Ä—å" / "–ü–æ –ø—Ä–∏–≤—ã—á–∫–∞–º"
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–Ω–∞—á–∏–º—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

**Request:**
```json
{}
```

**Response:** (–æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π, –ø–æ–∫–∞–∑—ã–≤–∞—é –∫–ª—é—á–µ–≤—ã–µ —á–∞—Å—Ç–∏)

```json
{
    "response": {
        "status": "ok",
        "data": {
            "completion_stats": {
                "week_rate": 85,
                "month_rate": 78,
                "weekly_trend": [
                    {"week": "25 –Ω–æ—è–± - 1 –¥–µ–∫", "rate": 70},
                    {"week": "2-8 –¥–µ–∫", "rate": 85}
                ],
                "best_week": {
                    "period": "2-8 –¥–µ–∫",
                    "rate": 85,
                    "completed": 17,
                    "total": 20
                },
                "worst_week": {
                    "period": "18-24 –Ω–æ—è–±",
                    "rate": 45,
                    "completed": 9,
                    "total": 20
                },
                "per_habit": [
                    {
                        "habit_id": 123,
                        "name": "–ó–∞—Ä—è–¥–∫–∞",
                        "icon": "strength",
                        "rate_30d": 90
                    }
                ]
            },
            
            "calendar_data": {
                "year_total_completions": 450,
                "year_active_days": 180,
                "best_month": {
                    "month": "–ù–æ—è–±—Ä—å",
                    "rate": 88
                },
                "heatmap": [
                    {
                        "date": "2024-01-01",
                        "completed": 3,
                        "total": 5,
                        "level": "level-2"
                    }
                ],
                "monthly_stats": [
                    {
                        "month": "–Ø–Ω–≤–∞—Ä—å",
                        "rate": 75,
                        "completed": 90,
                        "total": 120,
                        "is_best": false
                    }
                ]
            },
            
            "habit_stats": [
                {
                    "habit_id": 123,
                    "name": "–ó–∞—Ä—è–¥–∫–∞",
                    "icon": "strength",
                    "streak": 7,
                    "week_rate": 100,
                    "month_rate": 90,
                    "mini_calendar": [
                        {"date": "2024-12-01", "status": "completed"},
                        {"date": "2024-12-02", "status": "completed"}
                    ]
                }
            ]
        }
    }
}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**

**completion_stats:**
- `week_rate` ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ 7 –¥–Ω–µ–π
- `month_rate` ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ 30 –¥–Ω–µ–π
- `weekly_trend` ‚Äî –º–∞—Å—Å–∏–≤ 8 –Ω–µ–¥–µ–ª—å —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
- `best_week` / `worst_week` ‚Äî –ª—É—á—à–∞—è/—Ö—É–¥—à–∞—è –Ω–µ–¥–µ–ª—è
- `per_habit` ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø—Ä–∏–≤—ã—á–∫–∞–º –∑–∞ 30 –¥–Ω–µ–π

**calendar_data:**
- `year_total_completions` ‚Äî –≤—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –∑–∞ –≥–æ–¥
- `year_active_days` ‚Äî –¥–Ω–µ–π —Å —Ö–æ—Ç—è –±—ã 1 –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
- `best_month` ‚Äî –ª—É—á—à–∏–π –º–µ—Å—è—Ü
- `heatmap` ‚Äî GitHub-style –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞ –≥–æ–¥
- `monthly_stats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –º–µ—Å—è—Ü—É

**heatmap levels:**
- `level-0` ‚Äî 0% (—Å–µ—Ä—ã–π)
- `level-1` ‚Äî 1-33% (—Å–≤–µ—Ç–ª–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π)
- `level-2` ‚Äî 34-66% (—Å—Ä–µ–¥–Ω–∏–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π)
- `level-3` ‚Äî 67-100% (—è—Ä–∫–∏–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π)

**habit_stats:**
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–π –ø—Ä–∏–≤—ã—á–∫–µ
- `streak` ‚Äî –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ –¥–ª—è —ç—Ç–æ–π –ø—Ä–∏–≤—ã—á–∫–∏
- `mini_calendar` ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 14 –¥–Ω–µ–π

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**–†–∞—Å—á—ë—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤:**
```python
rate = (completed_count / total_scheduled) * 100

–≥–¥–µ:
- completed_count = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π
- total_scheduled = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –∫–æ–≥–¥–∞ –ø—Ä–∏–≤—ã—á–∫–∞ –±—ã–ª–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞
```

**–†–∞—Å—á—ë—Ç streak –¥–ª—è –ø—Ä–∏–≤—ã—á–∫–∏:**
```python
streak = 0
current_date = today

while True:
    if –ø—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å:
        current_date -= 1
        continue
    
    if –ø—Ä–∏–≤—ã—á–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å:
        streak += 1
        current_date -= 1
    else:
        break
```

**UI hints:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç (—Ç—è–∂—ë–ª—ã–π –∑–∞–ø—Ä–æ—Å)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –≥–æ–¥–æ–≤–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω

---

## 6. –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (1 endpoint)

### 6.1. –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**Endpoint:** `POST /achievements/get/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏ "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞" (–ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–≤—å—é)
- –ö–ª–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É "–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è"
- –ü–æ—Å–ª–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–æ–≤–æ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

**Request:**
```json
{}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "total_count": 19,
            "unlocked_count": 8,
            "categories": [
                {
                    "category": "streak",
                    "name": "–°–µ—Ä–∏–∏",
                    "achievements": [
                        {
                            "achievement_id": "streak3",
                            "icon": "üå±",
                            "name": "–ü–µ—Ä–≤—ã–µ —Ä–æ—Å—Ç–∫–∏",
                            "description": "3 –¥–Ω—è –ø–æ–¥—Ä—è–¥",
                            "target": 3,
                            "progress": 7,
                            "is_unlocked": true,
                            "unlocked_at": "2024-11-15T10:00:00Z"
                        },
                        {
                            "achievement_id": "streak7",
                            "icon": "üî•",
                            "name": "–ù–µ–¥–µ–ª—è –æ–≥–Ω—è",
                            "description": "7 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥",
                            "target": 7,
                            "progress": 7,
                            "is_unlocked": true,
                            "unlocked_at": "2024-11-20T14:30:00Z"
                        },
                        {
                            "achievement_id": "streak14",
                            "icon": "‚ö°",
                            "name": "–î–≤–µ –Ω–µ–¥–µ–ª–∏ —Å–∏–ª—ã",
                            "description": "14 –¥–Ω–µ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã",
                            "target": 14,
                            "progress": 7,
                            "is_unlocked": false,
                            "unlocked_at": null
                        }
                    ]
                },
                {
                    "category": "completion",
                    "name": "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ",
                    "achievements": [ ... ]
                }
            ]
        }
    }
}
```

**–ü–æ–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `achievement_id` | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID |
| `icon` | string | Emoji –∏–∫–æ–Ω–∫–∞ |
| `name` | string | –ù–∞–∑–≤–∞–Ω–∏–µ |
| `description` | string | –û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏—è |
| `target` | int | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
| `progress` | int | –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å |
| `is_unlocked` | bool | –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ |
| `unlocked_at` | string | –î–∞—Ç–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (null –µ—Å–ª–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ) |

**–†–∞—Å—á—ë—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:**

–î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–≤–æ–∏ –ø—Ä–∞–≤–∏–ª–∞:

**Streak:**
```python
progress = current_habit_streak
# –û–≥—Ä–∞–Ω–∏—á–µ–Ω target (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å > 100%)
progress = min(progress, target)
```

**Completion:**
```python
# –î–ª—è week/month –ø—Ä–æ—Ü–µ–Ω—Ç–∞
progress = completion_rate_for_period
# –î–ª—è perfectWeek/perfectMonth
progress = 100 if rate === 100 else rate
```

**Volume:**
```python
progress = total_completions_count
progress = min(progress, target)
```

**Variety:**
```python
progress = active_habits_count
progress = min(progress, target)
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ï—Å–ª–∏ `progress >= target` –ò –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ ‚Üí —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
- –°–æ–∑–¥–∞—ë—Ç—Å—è UserAchievement —Å —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –±–æ–Ω—É—Å XP (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

**UI hints:**
- –î–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö: —è—Ä–∫–∏–µ —Ü–≤–µ—Ç–∞, 100% –ø—Ä–æ–≥—Ä–µ—Å—Å
- –î–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö: –ø—Ä–∏–≥–ª—É—à—ë–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞, –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∫ "7/14" –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É (order field)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

---

## 7. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (2 endpoints)

### 7.1. –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–∞–Ω–µ–ª–∏

**Endpoint:** `POST /stats-panel/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–≤–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å)
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ª—é–±–æ–π –ø—Ä–∏–≤—ã—á–∫–∏
- –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è/–æ—Ç–º–µ–Ω—ã –∞–º–Ω–∏—Å—Ç–∏–∏

**Request:**
```json
{}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "streak": 7,
            "today_completed": 3,
            "today_total": 5,
            "week_xp": 245,
            "amnesty_remaining": 1,
            "difficulty_mode": "balanced"
        }
    }
}
```

**–ü–æ–ª—è:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `streak` | int | –î–Ω–µ–π –ø–æ–¥—Ä—è–¥ (—Å–µ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π) |
| `today_completed` | int | –í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–∏–≤—ã—á–µ–∫ —Å–µ–≥–æ–¥–Ω—è |
| `today_total` | int | –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏–≤—ã—á–µ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è |
| `week_xp` | int | –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ XP –∑–∞ —Ç–µ–∫—É—â—É—é –Ω–µ–¥–µ–ª—é |
| `amnesty_remaining` | int | –û—Å—Ç–∞–ª–æ—Å—å –∞–º–Ω–∏—Å—Ç–∏–π –Ω–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é |
| `difficulty_mode` | string | –¢–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ |

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**–†–∞—Å—á—ë—Ç streak:**
```python
# –°—á–∏—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–Ω–∏ –∫–æ–≥–¥–∞ –•–û–¢–Ø –ë–´ –û–î–ù–ê –ø—Ä–∏–≤—ã—á–∫–∞ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
# –ü—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ –±—ã–ª –¥–µ–Ω—å —Å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏

streak = 0
current_date = today

while True:
    scheduled_habits = –ø—Ä–∏–≤—ã—á–∫–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
    
    if len(scheduled_habits) == 0:
        current_date -= 1
        continue
    
    completed_habits = –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å
    
    if len(completed_habits) > 0:
        streak += 1
        current_date -= 1
    else:
        break  # Streak –ø—Ä–µ—Ä–≤–∞–Ω
```

**–†–∞—Å—á—ë—Ç week_xp:**
```python
# –ù–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏ = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
week_start = get_monday_of_week(today)
week_end = week_start + 6 days

week_xp = SUM(XPTransaction.amount 
              WHERE transaction_type IN ('habit_completed', 'goal_step_completed', ...) 
              AND amount > 0
              AND date_created >= week_start 
              AND date_created <= week_end)
```

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

–í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

```jsx
<StatsPanel>
  <StatCard 
    icon="üî•" 
    label="–î–Ω–µ–π –ø–æ–¥—Ä—è–¥" 
    value={streak}
    onClick={() => openStreakModal()}
  />
  
  <StatCard 
    icon="‚úÖ" 
    label="–°–µ–≥–æ–¥–Ω—è" 
    value={`${today_completed}/${today_total}`}
    onClick={() => openTodayModal()}
  />
  
  <StatCard 
    icon="‚≠ê" 
    label="XP –∑–∞ –Ω–µ–¥–µ–ª—é" 
    value={week_xp}
    onClick={() => openXPModal()}
  />
  
  {amnesty_remaining > 0 && (
    <StatCard 
      icon="üíù" 
      label="–ê–º–Ω–∏—Å—Ç–∏—è" 
      value={`${amnesty_remaining}/–Ω–µ–¥–µ–ª—è`}
      onClick={() => openAmnestyModal()}
    />
  )}
  
  <StatCard 
    icon={getModeIcon(difficulty_mode)} 
    label="–†–µ–∂–∏–º" 
    value={getModeName(difficulty_mode)}
    onClick={() => openSettingsModal()}
  />
</StatsPanel>
```

**UI hints:**
- –û–±–Ω–æ–≤–ª—è—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å transitions –¥–ª—è –ø–ª–∞–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–∏—Å–µ–ª
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å streak c fire –∞–Ω–∏–º–∞—Ü–∏–µ–π
- Highlight week_xp –µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥

---

### 7.2. –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏

**Endpoint:** `POST /recommended/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü—Ä–∏ –∫–ª–∏–∫–µ "–ü–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É" –≤ —Ñ–æ—Ä–º–µ —Å–æ–∑–¥–∞–Ω–∏—è
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ (onboarding)
- –ü—Ä–∏ –ø—É—Å—Ç–æ–º —Å–ø–∏—Å–∫–µ –ø—Ä–∏–≤—ã—á–µ–∫

**Request:**
```json
{}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "categories": [
                {
                    "id": "health",
                    "name": "–ó–¥–æ—Ä–æ–≤—å–µ –∏ —Å–ø–æ—Ä—Ç",
                    "icon": "strength",
                    "habits": [
                        {
                            "name": "–ó–∞—Ä—è–¥–∫–∞ 10 –º–∏–Ω",
                            "icon": "strength",
                            "xp_reward": 10,
                            "xp_penalty": 20,
                            "frequency_type": "daily",
                            "description": "–£—Ç—Ä–µ–Ω–Ω—è—è —Ä–∞–∑–º–∏–Ω–∫–∞ –¥–ª—è –±–æ–¥—Ä–æ—Å—Ç–∏ –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å"
                        },
                        {
                            "name": "–í—ã–ø–∏—Ç—å 2–ª –≤–æ–¥—ã",
                            "icon": "water",
                            "xp_reward": 5,
                            "xp_penalty": 10,
                            "frequency_type": "daily",
                            "description": "–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–æ–¥–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –æ—Ä–≥–∞–Ω–∏–∑–º–∞"
                        }
                    ]
                },
                {
                    "id": "productivity",
                    "name": "–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
                    "icon": "target",
                    "habits": [ ... ]
                }
            ]
        }
    }
}
```

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (5 —à—Ç, 25 –ø—Ä–∏–≤—ã—á–µ–∫):**

1. **health** ‚Äî –ó–¥–æ—Ä–æ–≤—å–µ –∏ —Å–ø–æ—Ä—Ç (5 –ø—Ä–∏–≤—ã—á–µ–∫)
2. **productivity** ‚Äî –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (5 –ø—Ä–∏–≤—ã—á–µ–∫)
3. **self_development** ‚Äî –°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ (5 –ø—Ä–∏–≤—ã—á–µ–∫)
4. **mental_health** ‚Äî –ú–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (5 –ø—Ä–∏–≤—ã—á–µ–∫)
5. **routine** ‚Äî –†–µ–∂–∏–º (5 –ø—Ä–∏–≤—ã—á–µ–∫)

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**
- –≠—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å)
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–∏–≤—ã—á–∫–∏ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```jsx
<RecommendedHabitsModal>
  <Tabs>
    {categories.map(cat => (
      <TabPanel key={cat.id} icon={cat.icon} title={cat.name}>
        {cat.habits.map(habit => (
          <HabitCard 
            {...habit}
            onClick={() => selectHabit(habit)}
          />
        ))}
      </TabPanel>
    ))}
  </Tabs>
</RecommendedHabitsModal>
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –≤–∫–ª–∞–¥–∫–∞–º–∏
- Highlight –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø—Ä–∏–≤—ã—á–∫–∏
- –ö–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å" –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª
- –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ä–∞–∑—É (checkbox mode)

---

## 8. XP (2 endpoints)

### 8.1. –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é XP

**Endpoint:** `POST /xp/history/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ "–ò—Å—Ç–æ—Ä–∏—è XP"
- –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ XP –∑–∞ –Ω–µ–¥–µ–ª—é/–º–µ—Å—è—Ü
- Debugging (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç–∫—É–¥–∞ XP)

**Request:**
```json
{
    "limit": 20,
    "transaction_type": "habit_completed",
    "date_from": "2024-12-01",
    "date_to": "2024-12-08"
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|--------------|----------|
| `limit` | int | –Ω–µ—Ç | 10 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (1-100) |
| `transaction_type` | string | –Ω–µ—Ç | null | –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É |
| `date_from` | string | –Ω–µ—Ç | null | –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ |
| `date_to` | string | –Ω–µ—Ç | null | –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ |

**–¢–∏–ø—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:**
- `habit_completed`
- `habit_penalty`
- `goal_step_completed`
- `goal_completed`
- `journal_entry`
- `achievement_bonus`
- `reward_redeemed`
- `manual_adjustment`

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "transactions": [
                {
                    "id": 12345,
                    "amount": 10,
                    "transaction_type": "habit_completed",
                    "habit_name": "–ó–∞—Ä—è–¥–∫–∞ 10 –º–∏–Ω",
                    "achievement_name": null,
                    "metadata": {
                        "habit_id": 123,
                        "date": "2024-12-06"
                    },
                    "balance_after": 250,
                    "date_created": "2024-12-06T08:30:00Z"
                },
                {
                    "id": 12344,
                    "amount": -20,
                    "transaction_type": "habit_penalty",
                    "habit_name": "–ú–µ–¥–∏—Ç–∞—Ü–∏—è 10 –º–∏–Ω",
                    "achievement_name": null,
                    "metadata": {
                        "habit_id": 124,
                        "date": "2024-12-05",
                        "reason": "–ü—Ä–æ–ø—É—Å–∫"
                    },
                    "balance_after": 240,
                    "date_created": "2024-12-06T00:01:00Z"
                },
                {
                    "id": 12343,
                    "amount": 50,
                    "transaction_type": "achievement_bonus",
                    "habit_name": null,
                    "achievement_name": "–ù–µ–¥–µ–ª—è –æ–≥–Ω—è",
                    "metadata": {
                        "achievement_id": "streak7"
                    },
                    "balance_after": 260,
                    "date_created": "2024-12-05T20:00:00Z"
                }
            ]
        }
    }
}
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:** –í—Å–µ–≥–¥–∞ –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º (DESC –ø–æ date_created)

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã `date_from` –∏ `date_to` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω `transaction_type` ‚Äî —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç —Ç–∏–ø
- –ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```jsx
<XPHistoryModal>
  <Filters>
    <TypeFilter onChange={setType} />
    <DateRangeFilter onChange={setDateRange} />
  </Filters>
  
  <TransactionList>
    {transactions.map(tx => (
      <TransactionItem key={tx.id}>
        <Icon type={tx.transaction_type} />
        <Amount positive={tx.amount > 0}>
          {tx.amount > 0 ? '+' : ''}{tx.amount} XP
        </Amount>
        <Source>
          {tx.habit_name || tx.achievement_name}
        </Source>
        <Time>{formatDate(tx.date_created)}</Time>
        <Balance>–ë–∞–ª–∞–Ω—Å: {tx.balance_after}</Balance>
      </TransactionItem>
    ))}
  </TransactionList>
  
  {hasMore && <LoadMoreButton />}
</XPHistoryModal>
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å + –∑–µ–ª—ë–Ω—ã–º, - –∫—Ä–∞—Å–Ω—ã–º
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–Ω—è–º
- Infinite scroll –∏–ª–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- –ò–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

---

### 8.2. –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É XP

**Endpoint:** `POST /xp/stats/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ XP
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–æ—Å—Ç–∞ XP
- –ü–æ–∫–∞–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –Ω–∞–≥—Ä–∞–¥—ã

**Request:**
```json
{}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "xp_balance": 245,
            "lifetime_xp": 1250,
            "today_xp": 35,
            "week_xp": 245
        }
    }
}
```

**–ü–æ–ª—è:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `xp_balance` | int | –¢–µ–∫—É—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å XP |
| `lifetime_xp` | int | –í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ XP –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è |
| `today_xp` | int | –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ XP —Å–µ–≥–æ–¥–Ω—è |
| `week_xp` | int | –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ XP –∑–∞ —Ç–µ–∫—É—â—É—é –Ω–µ–¥–µ–ª—é |

**–†–∞—Å—á—ë—Ç –ø–æ–ª–µ–π:**

```python
# xp_balance - –ø–æ–ª–µ User (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
xp_balance = user.xp_balance

# lifetime_xp - –ø–æ–ª–µ User (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
lifetime_xp = user.lifetime_xp

# today_xp - —Å—É–º–º–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è
today_xp = SUM(XPTransaction.amount 
               WHERE user=current_user 
               AND amount > 0 
               AND DATE(date_created) = today)

# week_xp - —Å—É–º–º–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞ –Ω–µ–¥–µ–ª—é
week_xp = SUM(XPTransaction.amount 
              WHERE user=current_user 
              AND amount > 0 
              AND date_created >= week_start 
              AND date_created <= week_end)
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

- `xp_balance` –Ω–∏–∫–æ–≥–¥–∞ < 0 (–∑–∞—â–∏—Ç–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏)
- `lifetime_xp` —Ç–æ–ª—å–∫–æ —Ä–∞—Å—Ç—ë—Ç (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è)
- `today_xp` –∏ `week_xp` —Å—á–∏—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –®—Ç—Ä–∞—Ñ—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ today_xp –∏ week_xp

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```jsx
<XPStatsModal>
  <StatCard>
    <Label>–î–æ—Å—Ç—É–ø–Ω–æ</Label>
    <Value>{xp_balance} XP</Value>
    <Hint>–ú–æ–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –Ω–∞ –Ω–∞–≥—Ä–∞–¥—ã</Hint>
  </StatCard>
  
  <StatCard>
    <Label>–ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</Label>
    <Value>{lifetime_xp} XP</Value>
    <Progress value={lifetime_xp} max={10000} />
  </StatCard>
  
  <StatCard>
    <Label>–°–µ–≥–æ–¥–Ω—è</Label>
    <Value>+{today_xp} XP</Value>
  </StatCard>
  
  <StatCard>
    <Label>–ó–∞ –Ω–µ–¥–µ–ª—é</Label>
    <Value>+{week_xp} XP</Value>
  </StatCard>
  
  <Chart>
    <LineChart data={weeklyXPTrend} />
  </Chart>
</XPStatsModal>
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –Ω–∞–≥—Ä–∞–¥—ã
- –ì—Ä–∞—Ñ–∏–∫ —Ä–æ—Å—Ç–∞ XP –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ–π
- Highlight –ª–∏—á–Ω—ã—Ö —Ä–µ–∫–æ—Ä–¥–æ–≤

---

## 9. –ù–∞–≥—Ä–∞–¥—ã (5 endpoints)

### 9.1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –Ω–∞–≥—Ä–∞–¥

**Endpoint:** `POST /rewards/get/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Ä–∞–∑–¥–µ–ª–∞ "–ù–∞–≥—Ä–∞–¥—ã" / "Wishlist"
- –ü–æ–∫–∞–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –Ω–∞–≥—Ä–∞–¥
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –Ω–∞–≥—Ä–∞–¥

**Request:**
```json
{
    "status_filter": "available",
    "include_deleted": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–æ–ª–µ | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `status_filter` | string | null | 'available' –∏–ª–∏ 'redeemed' |
| `include_deleted` | bool | false | –í–∫–ª—é—á–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–µ |

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "rewards": [
                {
                    "reward_id": 1,
                    "name": "–ö–æ—Ñ–µ –≤ –ª—é–±–∏–º–æ–π –∫–æ—Ñ–µ–π–Ω–µ",
                    "cost": 50,
                    "icon": "‚òï",
                    "description": "–í–∫—É—Å–Ω—ã–π –∫–∞–ø—É—á–∏–Ω–æ —Å –∫—Ä—É–∞—Å—Å–∞–Ω–æ–º",
                    "status": "available",
                    "date_created": "2024-11-01T10:00:00Z",
                    "date_redeemed": null
                },
                {
                    "reward_id": 2,
                    "name": "–í–µ—á–µ—Ä –≤ –∫–∏–Ω–æ",
                    "cost": 100,
                    "icon": "üé¨",
                    "description": "–ë–∏–ª–µ—Ç –Ω–∞ –ø—Ä–µ–º—å–µ—Ä—É",
                    "status": "available",
                    "date_created": "2024-11-05T14:30:00Z",
                    "date_redeemed": null
                },
                {
                    "reward_id": 3,
                    "name": "–ú–∞—Å—Å–∞–∂ 1 —á–∞—Å",
                    "cost": 200,
                    "icon": "üíÜ",
                    "description": "–†–µ–ª–∞–∫—Å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ",
                    "status": "redeemed",
                    "date_created": "2024-10-15T09:00:00Z",
                    "date_redeemed": "2024-12-01T18:00:00Z"
                }
            ]
        }
    }
}
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
- `status_filter="available"` ‚Äî —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è
- `status_filter="redeemed"` ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ
- `status_filter=null` ‚Äî –≤—Å–µ
- `include_deleted=true` ‚Äî –≤–∫–ª—é—á–∞—è soft-deleted

**–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:** –ü–æ cost (ASC), –∑–∞—Ç–µ–º date_created (DESC)

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```jsx
<RewardsPage>
  <Tabs>
    <Tab label="Wishlist">
      {availableRewards.map(reward => (
        <RewardCard 
          key={reward.reward_id}
          {...reward}
          canAfford={xp_balance >= reward.cost}
          onRedeem={() => redeemReward(reward.reward_id)}
        />
      ))}
    </Tab>
    
    <Tab label="–ü–æ–ª—É—á–µ–Ω–æ">
      {redeemedRewards.map(reward => (
        <RewardCard 
          key={reward.reward_id}
          {...reward}
          isRedeemed={true}
          redeemedDate={reward.date_redeemed}
        />
      ))}
    </Tab>
  </Tabs>
  
  <FAB onClick={() => openCreateModal()} />
</RewardsPage>
```

**UI hints:**
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã –µ—Å–ª–∏ `xp_balance < cost`
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å "–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç X XP" –¥–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç –¥–µ—à—ë–≤—ã—Ö –∫ –¥–æ—Ä–æ–≥–∏–º
- Highlight closest to afford

---

### 9.2. –°–æ–∑–¥–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É

**Endpoint:** `POST /rewards/create/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –Ω–∞–≥—Ä–∞–¥—ã –≤ wishlist
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π

**Request:**
```json
{
    "name": "–ù–æ–≤–∞—è –∏–≥—Ä–∞",
    "cost": 150,
    "icon": "üéÆ",
    "description": "Cyberpunk 2077 –≤ Steam"
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|--------------|----------|
| `name` | string | –¥–∞ | - | –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã |
| `cost` | int | –¥–∞ | - | –°—Ç–æ–∏–º–æ—Å—Ç—å –≤ XP |
| `icon` | string | –Ω–µ—Ç | 'üéÅ' | Emoji –∏–∫–æ–Ω–∫–∞ |
| `description` | string | –Ω–µ—Ç | '' | –û–ø–∏—Å–∞–Ω–∏–µ |

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "reward_id": 10
        }
    }
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `name`: 1-200 —Å–∏–º–≤–æ–ª–æ–≤
- `cost`: >= 1
- `icon`: –º–∞–∫—Å–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤
- `description`: –º–∞–∫—Å–∏–º—É–º 1000 —Å–∏–º–≤–æ–ª–æ–≤

**–û—à–∏–±–∫–∏:**
```json
{
    "error": {
        "code": "invalid_cost",
        "message": "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0"
    }
}
```

**UI hints:**
- –§–æ—Ä–º–∞ —Å –ø–æ–ª—è–º–∏ name, cost, icon, description
- Icon picker —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —ç–º–æ–¥–∑–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –Ω—É–∂–Ω–æ –Ω–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è "–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ –∏–¥–µ–∏"

---

### 9.3. –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É

**Endpoint:** `POST /rewards/redeem/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç "–∫—É–ø–∏—Ç—å" –Ω–∞–≥—Ä–∞–¥—É –∑–∞ XP
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ XP –Ω–∞ –±–∞–ª–∞–Ω—Å–µ

**Request:**
```json
{
    "reward_id": 10
}
```

**Response (—É—Å–ø–µ—Ö):**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": true,
            "new_balance": 95
        }
    }
}
```

**Response (–æ—à–∏–±–∫–∞):**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": false,
            "error": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ XP. –ù—É–∂–Ω–æ 50, –¥–æ—Å—Ç—É–ø–Ω–æ 45"
        }
    }
}
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

1. –ü—Ä–æ–≤–µ—Ä–∫–∏:
   - –ù–∞–≥—Ä–∞–¥–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –ù–∞–≥—Ä–∞–¥–∞ –Ω–µ —É–¥–∞–ª–µ–Ω–∞
   - `reward.status === 'available'`
   - `user.xp_balance >= reward.cost`

2. –î–µ–π—Å—Ç–≤–∏—è:
   - –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è XP = `reward.cost`
   - –°–æ–∑–¥–∞—ë—Ç—Å—è XPTransaction —Å —Ç–∏–ø–æ–º 'reward_redeemed'
   - `reward.status` –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ 'redeemed'
   - `reward.date_redeemed` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

3. –ê—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å:
   - –í—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ë–î
   - –ü—Ä–∏ –æ—à–∏–±–∫–µ –æ—Ç–∫–∞—Ç

**–û—à–∏–±–∫–∏:**
```json
// –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ XP
{
    "data": {
        "success": false,
        "error": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ XP. –ù—É–∂–Ω–æ 100, –¥–æ—Å—Ç—É–ø–Ω–æ 45"
    }
}

// –ù–∞–≥—Ä–∞–¥–∞ —É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞
{
    "data": {
        "success": false,
        "error": "–≠—Ç–∞ –Ω–∞–≥—Ä–∞–¥–∞ —É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞"
    }
}

// –ù–∞–≥—Ä–∞–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
{
    "error": {
        "code": "reward_not_found",
        "message": "–ù–∞–≥—Ä–∞–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    }
}
```

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```jsx
<RewardCard>
  <Icon>{reward.icon}</Icon>
  <Name>{reward.name}</Name>
  <Cost>{reward.cost} XP</Cost>
  
  {canAfford ? (
    <Button 
      onClick={() => handleRedeem()}
      confirm={true}
      confirmText="–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É –∑–∞ ${cost} XP?"
    >
      –ü–æ–ª—É—á–∏—Ç—å
    </Button>
  ) : (
    <Button disabled>
      –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç {reward.cost - xp_balance} XP
    </Button>
  )}
</RewardCard>

<ConfirmModal 
  onConfirm={() => redeemReward(reward_id)}
  title="–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É?"
  text={`–ë—É–¥–µ—Ç —Å–ø–∏—Å–∞–Ω–æ ${cost} XP`}
/>

<SuccessModal
  icon="üéâ"
  title="–ù–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞!"
  text={reward.name}
  newBalance={new_balance}
/>
```

**UI hints:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å confirmation dialog –ø–µ—Ä–µ–¥ —Å–ø–∏—Å–∞–Ω–∏–µ–º
- Celebration –∞–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å
- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ —Ä–∞–∑–¥–µ–ª "–ü–æ–ª—É—á–µ–Ω–æ"
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞

---

### 9.4. –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É

**Endpoint:** `POST /rewards/update/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–µ/—Å—Ç–æ–∏–º–æ—Å—Ç–∏/–æ–ø–∏—Å–∞–Ω–∏—è
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏

**Request:**
```json
{
    "reward_id": 10,
    "name": "–ù–æ–≤–∞—è –∏–≥—Ä–∞ 2024",
    "cost": 120
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

–í—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –∫—Ä–æ–º–µ `reward_id`:
- `reward_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `name`
- `cost`
- `icon`
- `description`

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": true
        }
    }
}
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —É–∂–µ –ø–æ–ª—É—á–µ–Ω–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É (`status='redeemed'`)
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É

**–û—à–∏–±–∫–∏:**
```json
{
    "error": {
        "code": "reward_already_redeemed",
        "message": "–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É"
    }
}
```

**UI hints:**
- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è `status='available'`
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å disabled –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

---

### 9.5. –£–¥–∞–ª–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É

**Endpoint:** `POST /rewards/delete/`

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã –∏–∑ wishlist
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –Ω–∞–≥—Ä–∞–¥

**Request (soft-delete):**
```json
{
    "reward_id": 10,
    "permanent": false
}
```

**Request (permanent delete):**
```json
{
    "reward_id": 10,
    "permanent": true
}
```

**Response:**
```json
{
    "response": {
        "status": "ok",
        "data": {
            "success": true
        }
    }
}
```

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**

**Soft-delete (`permanent=false`):**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `date_deleted`
- –ù–∞–≥—Ä–∞–¥–∞ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞
- –ú–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞)

**Permanent delete (`permanent=true`):**
- –§–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ë–î
- –ë–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ
- –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –Ω–∞–≥—Ä–∞–¥—ã
- –ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É (`status='redeemed'`)

**–û—à–∏–±–∫–∏:**
```json
{
    "error": {
        "code": "cannot_delete_redeemed",
        "message": "–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É"
    }
}
```

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

```jsx
<RewardCard>
  <DeleteButton 
    onClick={() => handleDelete(false)}
    confirm={true}
  >
    –£–¥–∞–ª–∏—Ç—å
  </DeleteButton>
</RewardCard>

<ConfirmDialog
  title="–£–¥–∞–ª–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É?"
  text={reward.name}
  actions={[
    {
      label: "–£–¥–∞–ª–∏—Ç—å",
      onClick: () => deleteReward(reward_id, false)
    },
    {
      label: "–£–¥–∞–ª–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞",
      onClick: () => deleteReward(reward_id, true),
      danger: true,
      confirmText: "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!"
    }
  ]}
/>
```

**UI hints:**
- –î–≤–∞ —É—Ä–æ–≤–Ω—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è permanent
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å undo toast –¥–ª—è soft-delete
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –¥–ª—è redeemed

---

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```javascript
// 1. –ü–æ–∫–∞–∑–∞—Ç—å onboarding –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
const response1 = await fetch('/api/app/habits/settings/update/', {
    method: 'POST',
    body: JSON.stringify({
        difficulty_mode: 'balanced'
    })
})

// 2. –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏
const response2 = await fetch('/api/app/habits/recommended/', {
    method: 'POST',
    body: JSON.stringify({})
})

// 3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç 3 –ø—Ä–∏–≤—ã—á–∫–∏ ‚Üí —Å–æ–∑–¥–∞—Ç—å
const response3 = await fetch('/api/app/habits/update/', {
    method: 'POST',
    body: JSON.stringify({
        action: 'create',
        habits: [selectedHabit1, selectedHabit2, selectedHabit3]
    })
})

// 4. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
const response4 = await fetch('/api/app/habits/get/', {
    method: 'POST',
    body: JSON.stringify({})
})
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –£—Ç—Ä–µ–Ω–Ω—è—è —Ä—É—Ç–∏–Ω–∞ (–æ—Ç–º–µ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)

```javascript
// 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–∞–Ω–µ–ª–∏
const statsResponse = await fetch('/api/app/habits/stats-panel/', {
    method: 'POST',
    body: JSON.stringify({})
})
// –ü–æ–∫–∞–∑–∞—Ç—å: streak, —Å–µ–≥–æ–¥–Ω—è 0/5, week XP

// 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
const habitsResponse = await fetch('/api/app/habits/get/', {
    method: 'POST',
    body: JSON.stringify({})
})

// 3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ—á–∞–µ—Ç "–ó–∞—Ä—è–¥–∫–∞" –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é
const completeResponse = await fetch('/api/app/habits/completions/update/', {
    method: 'POST',
    body: JSON.stringify({
        completions: [{
            habit_id: 123,
            date: '2024-12-06',
            status: 'completed',
            note: '–û—Ç–ª–∏—á–Ω–æ!'
        }]
    })
})

// 4. –ü–æ–∫–∞–∑–∞—Ç—å +10 XP –∞–Ω–∏–º–∞—Ü–∏—é
// 5. –ï—Å–ª–∏ new_achievements ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

// 6. –û–±–Ω–æ–≤–∏—Ç—å stats panel (optimistic update –∏–ª–∏ reload)
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í–µ—á–µ—Ä–Ω–∏–π –æ–±–∑–æ—Ä –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–º–Ω–∏—Å—Ç–∏–∏

```javascript
// 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫–∏
const habitsResponse = await fetch('/api/app/habits/get/', {
    method: 'POST',
    body: JSON.stringify({})
})

// 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å —Å missed
// 3. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–ª–æ–∫ "–ê–º–Ω–∏—Å—Ç–∏—è"
const settingsResponse = await fetch('/api/app/habits/settings/get/', {
    method: 'POST',
    body: JSON.stringify({})
})

// –ü—Ä–æ–≤–µ—Ä–∫–∞: amnesty_remaining > 0 ? –ø–æ–∫–∞–∑–∞—Ç—å : —Å–∫—Ä—ã—Ç—å

// 4. –í—ã–±–∏—Ä–∞–µ—Ç –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å –¥–ª—è –∞–º–Ω–∏—Å—Ç–∏–∏
const amnestyResponse = await fetch('/api/app/habits/amnesty/apply/', {
    method: 'POST',
    body: JSON.stringify({
        date: '2024-12-05'
    })
})

// 5. –ü–æ–∫–∞–∑–∞—Ç—å "+45 XP –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ" 
// 6. –û–±–Ω–æ–≤–∏—Ç—å UI: missed ‚Üí amnestied
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

```javascript
// 1. –ö–ª–∏–∫ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"
const analyticsResponse = await fetch('/api/app/habits/analytics/get/', {
    method: 'POST',
    body: JSON.stringify({})
})

// 2. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å 4 –∫–∞—Ä—Ç–æ—á–∫–∏:
// - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–ø—Ä–æ—Ü–µ–Ω—Ç, –º–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫)
// - –ö–∞–ª–µ–Ω–¥–∞—Ä—å (heatmap preview)
// - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–ø–µ—Ä–≤—ã–µ 4 –±–µ–π–¥–∂–∞)
// - –ü–æ –ø—Ä–∏–≤—ã—á–∫–∞–º (—Å–ø–∏—Å–æ–∫ —Å –º–∏–Ω–∏-–∫–∞–ª–µ–Ω–¥–∞—Ä—è–º–∏)

// 3. –ö–ª–∏–∫ –Ω–∞ "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ" ‚Üí –º–æ–¥–∞–ª
showCompletionModal(data.completion_stats)

// 4. –ö–ª–∏–∫ –Ω–∞ "–ö–∞–ª–µ–Ω–¥–∞—Ä—å" ‚Üí –º–æ–¥–∞–ª
showCalendarModal(data.calendar_data)

// 5. –ö–ª–∏–∫ –Ω–∞ "–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è" ‚Üí –º–æ–¥–∞–ª
const achievementsResponse = await fetch('/api/app/habits/achievements/get/', {
    method: 'POST',
    body: JSON.stringify({})
})
showAchievementsModal(achievementsData)
```

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã

```javascript
// 1. –û—Ç–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª "–ù–∞–≥—Ä–∞–¥—ã"
const rewardsResponse = await fetch('/api/app/habits/rewards/get/', {
    method: 'POST',
    body: JSON.stringify({
        status_filter: 'available'
    })
})

// 2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –Ω–∞–≥—Ä–∞–¥—É
const createResponse = await fetch('/api/app/habits/rewards/create/', {
    method: 'POST',
    body: JSON.stringify({
        name: '–ú–∞—Å—Å–∞–∂',
        cost: 200,
        icon: 'üíÜ',
        description: '1 —á–∞—Å —Ä–µ–ª–∞–∫—Å–∞'
    })
})

// 3. –ù–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å XP...

// 4. –ö–æ–≥–¥–∞ xp_balance >= 200 ‚Üí –ø–æ–ª—É—á–∏—Ç—å
const redeemResponse = await fetch('/api/app/habits/rewards/redeem/', {
    method: 'POST',
    body: JSON.stringify({
        reward_id: response.data.reward_id
    })
})

// 5. –ü–æ–∫–∞–∑–∞—Ç—å celebration
if (redeemResponse.data.success) {
    showCelebration(reward)
    updateBalance(redeemResponse.data.new_balance)
}
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### HTTP —Å—Ç–∞—Ç—É—Å—ã

| –ö–æ–¥ | –ó–Ω–∞—á–µ–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|-----|----------|----------|
| 200 | OK | –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç |
| 400 | Bad Request | –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É |
| 401 | Unauthorized | –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ª–æ–≥–∏–Ω |
| 403 | Forbidden | –ù–µ—Ç –ø—Ä–∞–≤, –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É |
| 404 | Not Found | –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω |
| 500 | Server Error | –ü–æ–∫–∞–∑–∞—Ç—å "–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫" |

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–û–±—â–∏–µ:**
- `invalid_data` ‚Äî –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `missing_field` ‚Äî –ø—Ä–æ–ø—É—â–µ–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
- `permission_denied` ‚Äî –Ω–µ—Ç –ø—Ä–∞–≤

**–ü—Ä–∏–≤—ã—á–∫–∏:**
- `habit_not_found` ‚Äî –ø—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `habit_not_deleted` ‚Äî –ø—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞ (–¥–ª—è restore)
- `invalid_xp_reward` ‚Äî XP –Ω–∞–≥—Ä–∞–¥–∞ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 1-100
- `invalid_xp_penalty` ‚Äî XP —à—Ç—Ä–∞—Ñ –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0-200
- `invalid_schedule_days` ‚Äî –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

**–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
- `future_date` ‚Äî –ø–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ—Ç–∏—Ç—å –±—É–¥—É—â–∏–π –¥–µ–Ω—å
- `not_scheduled` ‚Äî –¥–µ–Ω—å –Ω–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ –ø—Ä–∏–≤—ã—á–∫–∏
- `excuse_reason_required` ‚Äî –Ω—É–∂–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ –¥–ª—è excused

**–ê–º–Ω–∏—Å—Ç–∏—è:**
- `no_amnesty_remaining` ‚Äî –∞–º–Ω–∏—Å—Ç–∏–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
- `already_amnestied` ‚Äî –¥–µ–Ω—å —É–∂–µ –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω
- `date_too_old` ‚Äî –¥–∞—Ç–∞ —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–∞—è (>7 –¥–Ω–µ–π)
- `soft_mode` ‚Äî –∞–º–Ω–∏—Å—Ç–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –º—è–≥–∫–æ–º —Ä–µ–∂–∏–º–µ
- `not_amnestied` ‚Äî –¥–µ–Ω—å –Ω–µ –±—ã–ª –∞–º–Ω–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω (–¥–ª—è revoke)

**–ù–∞–≥—Ä–∞–¥—ã:**
- `reward_not_found` ‚Äî –Ω–∞–≥—Ä–∞–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `reward_already_redeemed` ‚Äî –Ω–∞–≥—Ä–∞–¥–∞ —É–∂–µ –ø–æ–ª—É—á–µ–Ω–∞
- `insufficient_xp` ‚Äî –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ XP
- `invalid_cost` ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å <= 0
- `cannot_delete_redeemed` ‚Äî –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—É—é

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ

```javascript
async function apiRequest(endpoint, data) {
    try {
        const response = await fetch(`/api/app/habits/${endpoint}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Token ${token}`
            },
            body: JSON.stringify(data)
        })
        
        if (!response.ok) {
            if (response.status === 401) {
                // Redirect to login
                window.location.href = '/login'
                return
            }
            
            throw new Error(`HTTP ${response.status}`)
        }
        
        const json = await response.json()
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        if (json.error) {
            handleAppError(json.error)
            return null
        }
        
        return json.response.data
        
    } catch (error) {
        handleNetworkError(error)
        return null
    }
}

function handleAppError(error) {
    const messages = {
        'habit_not_found': '–ü—Ä–∏–≤—ã—á–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞',
        'insufficient_xp': '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ XP',
        'no_amnesty_remaining': '–í—Å–µ –∞–º–Ω–∏—Å—Ç–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã',
        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    }
    
    const message = messages[error.code] || error.message
    
    showToast({
        type: 'error',
        message: message
    })
}

function handleNetworkError(error) {
    showToast({
        type: 'error',
        message: '–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.'
    })
}
```

---

## Best Practices

### 1. Optimistic Updates

```javascript
// –ü–ª–æ—Ö–æ
async function markCompleted(habitId, date) {
    const response = await apiRequest('completions/update/', {...})
    if (response) {
        updateUI(response)
    }
}

// –•–æ—Ä–æ—à–æ
async function markCompleted(habitId, date) {
    // 1. –°—Ä–∞–∑—É –æ–±–Ω–æ–≤–∏—Ç—å UI
    updateUIOptimistic(habitId, 'completed')
    
    // 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å
    const response = await apiRequest('completions/update/', {...})
    
    // 3. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –æ—Ç–∫–∞—Ç–∏—Ç—å
    if (!response) {
        revertUI(habitId)
    } else {
        // –û–±–Ω–æ–≤–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
        updateUI(response)
    }
}
```

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ç—è–∂—ë–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã
const cache = {
    analytics: null,
    analyticsTime: null,
    recommended: null
}

async function getAnalytics(forceRefresh = false) {
    const cacheTime = 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç
    
    if (!forceRefresh && 
        cache.analytics && 
        Date.now() - cache.analyticsTime < cacheTime) {
        return cache.analytics
    }
    
    const data = await apiRequest('analytics/get/', {})
    cache.analytics = data
    cache.analyticsTime = Date.now()
    
    return data
}
```

### 3. Batching

```javascript
// –ü–ª–æ—Ö–æ - 3 –∑–∞–ø—Ä–æ—Å–∞
await markCompleted(habit1, date)
await markCompleted(habit2, date)
await markCompleted(habit3, date)

// –•–æ—Ä–æ—à–æ - 1 –∑–∞–ø—Ä–æ—Å
await apiRequest('completions/update/', {
    completions: [
        { habit_id: habit1, date, status: 'completed' },
        { habit_id: habit2, date, status: 'completed' },
        { habit_id: habit3, date, status: 'completed' }
    ]
})
```

### 4. Loading States

```javascript
function HabitsList() {
    const [loading, setLoading] = useState(true)
    const [habits, setHabits] = useState([])
    
    useEffect(() => {
        loadHabits()
    }, [])
    
    async function loadHabits() {
        setLoading(true)
        const data = await apiRequest('get/', {})
        setHabits(data.habits)
        setLoading(false)
    }
    
    if (loading) {
        return <SkeletonLoader />
    }
    
    return <HabitCards habits={habits} />
}
```

### 5. Error Boundaries

```javascript
class HabitsErrorBoundary extends React.Component {
    state = { hasError: false }
    
    static getDerivedStateFromError(error) {
        return { hasError: true }
    }
    
    render() {
        if (this.state.hasError) {
            return (
                <ErrorView 
                    message="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–≤—ã—á–µ–∫"
                    onRetry={() => this.setState({ hasError: false })}
                />
            )
        }
        
        return this.props.children
    }
}
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤

```javascript
describe('Habits API', () => {
    test('–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏', async () => {
        const response = await apiRequest('update/', {
            action: 'create',
            habits: [{
                name: 'Test Habit',
                icon: 'fire',
                xp_reward: 10,
                frequency_type: 'daily'
            }]
        })
        
        expect(response.created_ids).toHaveLength(1)
    })
    
    test('–û—Ç–º–µ—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞—á–∏—Å–ª—è–µ—Ç XP', async () => {
        const beforeXP = await getXPBalance()
        
        await apiRequest('completions/update/', {
            completions: [{
                habit_id: habitId,
                date: '2024-12-06',
                status: 'completed'
            }]
        })
        
        const afterXP = await getXPBalance()
        expect(afterXP).toBe(beforeXP + 10)
    })
    
    test('–ê–º–Ω–∏—Å—Ç–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç XP', async () => {
        const beforeXP = await getXPBalance()
        
        await apiRequest('amnesty/apply/', {
            date: '2024-12-05'
        })
        
        const afterXP = await getXPBalance()
        expect(afterXP).toBeGreaterThan(beforeXP)
    })
})
```

---

## Changelog

**v2.0 (–î–µ–∫–∞–±—Ä—å 2024)**
- ‚úÖ –ü–æ–ª–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å XP —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
- ‚úÖ 18 endpoints (9 –±–∞–∑–æ–≤—ã—Ö + 9 –Ω–æ–≤—ã—Ö)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –Ω–∞–≥—Ä–∞–¥
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏

**v1.0 (–ù–æ—è–±—Ä—å 2024)**
- ‚úÖ –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–∏–≤—ã—á–µ–∫
- ‚úÖ 9 endpoints
- ‚úÖ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–í–æ–ø—Ä–æ—Å—ã –ø–æ API:** backend-team@yourcompany.com  
**–ë–∞–≥–∏:** github.com/yourcompany/project/issues  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –û–±–Ω–æ–≤–ª–µ–Ω–æ 07.12.2024

---

**–£—Å–ø–µ—à–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏! üöÄ**