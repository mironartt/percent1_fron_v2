# –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò API

## üî¥ –ü–†–û–ë–õ–ï–ú–ê

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ FRONTEND_API_GUIDE.md —è –¥–æ–ø—É—Å—Ç–∏–ª **–∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ **–ù–ï –°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢** —Ä–µ–∞–ª—å–Ω—ã–º —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º –≤ –∫–æ–¥–µ.

**–ú–æ—è –≤–∏–Ω–∞:** –Ø –Ω–∞–ø–∏—Å–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π, –∞ –Ω–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞.

**–ò–°–¢–ò–ù–ê –í–°–ï–ì–î–ê –í –ö–û–î–ï!** –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

## ‚ùå –ß–¢–û –ë–´–õ–û –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û

### Endpoint: POST /api/app/habits/update/

**–í –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –±—ã–ª–æ:**
```json
{
    "action": "create",
    "habits": [...]
}
```

**–í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–¥–µ (—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä):**
```json
{
    "habits_data": [...],
    "deleted_habit_ids": [...],
    "restored_habit_ids": [...],
    "permanently_deleted_ids": [...]
}
```

### –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è:

| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –†–µ–∞–ª—å–Ω—ã–π –∫–æ–¥ | –°—Ç–∞—Ç—É—Å |
|--------------|--------------|--------|
| ‚ùå `action` | –ù–µ—Ç —Ç–∞–∫–æ–≥–æ –ø–æ–ª—è | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| ‚ùå `habits` | ‚úÖ `habits_data` | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| ‚ùå `habit_ids` | ‚úÖ `deleted_habit_ids` | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| ‚ùå `permanent` | ‚úÖ `permanently_deleted_ids` | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

```json
{
    "habits_data": [
        {
            "name": "–ú–µ–¥–∏—Ç–∞—Ü–∏—è 10 –º–∏–Ω",
            "icon": "meditation",
            "xp_reward": 15,
            "xp_penalty": 30,
            "frequency_type": "daily",
            "description": "–ü—Ä–∞–∫—Ç–∏–∫–∞ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏"
        }
    ]
}
```

**–ö–ª—é—á:** `habits_data` (–Ω–µ `habits`!)

---

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏

```json
{
    "habits_data": [
        {
            "habit_id": 123,
            "name": "–ú–µ–¥–∏—Ç–∞—Ü–∏—è 15 –º–∏–Ω",
            "xp_reward": 20
        }
    ]
}
```

**–ö–ª—é—á:** `habits_data` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º `habit_id`

---

### 3. Soft-delete (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

```json
{
    "deleted_habit_ids": [123, 456]
}
```

**–ö–ª—é—á:** `deleted_habit_ids` (–Ω–µ `habit_ids` —Å `action: "delete"`!)

---

### 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```json
{
    "restored_habit_ids": [123]
}
```

**–ö–ª—é—á:** `restored_habit_ids`

---

### 5. –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ

```json
{
    "permanently_deleted_ids": [789]
}
```

**–ö–ª—é—á:** `permanently_deleted_ids` (–Ω–µ `permanent: true`!)

---

### 6. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–º–æ–∂–Ω–æ –≤—Å—ë —Å—Ä–∞–∑—É)

```json
{
    "habits_data": [
        {"name": "–ù–æ–≤–∞—è –ø—Ä–∏–≤—ã—á–∫–∞"},
        {"habit_id": 100, "name": "–û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è"}
    ],
    "deleted_habit_ids": [200],
    "restored_habit_ids": [300],
    "permanently_deleted_ids": [400]
}
```

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê (–¥—Ä—É–≥–∏–µ endpoints)

–Ø –ø—Ä–æ–≤–µ—Ä–∏–ª –æ—Å—Ç–∞–ª—å–Ω—ã–µ endpoints ‚Äî –æ–Ω–∏ **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ** –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

### POST /api/app/habits/completions/update/

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```json
{
    "completions_data": [
        {
            "habit_id": 123,
            "date": "2024-12-06",
            "status": "completed",
            "note": "–û—Ç–ª–∏—á–Ω–æ!"
        }
    ]
}
```

**–ö–ª—é—á:** `completions_data` (–±—ã–ª–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ –¥–æ–∫–µ, –Ω–æ –ø–µ—Ä–µ–∏–º–µ–Ω—É—é –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å `habits_data`)

---

### POST /api/app/habits/amnesty/apply/

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```json
{
    "date": "2024-12-05"
}
```

---

### POST /api/app/habits/amnesty/revoke/

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```json
{
    "date": "2024-12-05"
}
```

---

## üìÅ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

**‚Üí [CORRECTED_UPDATE_ENDPOINT_DOCS.md](computer:///mnt/user-data/outputs/CORRECTED_UPDATE_ENDPOINT_DOCS.md)**

–ü–æ–ª–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è endpoint `/update/` —Å:
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –í—Å–µ–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏–µ–π
- ‚úÖ –û—à–∏–±–∫–∞–º–∏
- ‚úÖ Best practices
- ‚úÖ –ü—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞ JavaScript

---

## üîç –ö–ê–ö –Ø –ü–†–û–í–ï–†–ò–õ

1. –û—Ç–∫—Ä—ã–ª —Ñ–∞–π–ª `core__serializers__habits.py`
2. –ù–∞—à–µ–ª `UpdateHabitsRequestSerializer`
3. –ò–∑—É—á–∏–ª –≤—Å–µ –ø–æ–ª—è
4. –°—Ä–∞–≤–Ω–∏–ª —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
5. –û–±–Ω–∞—Ä—É–∂–∏–ª —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è
6. –ò—Å–ø—Ä–∞–≤–∏–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–¢–µ–ø–µ—Ä—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–¥—É!**

---

## üìù –ß–¢–û –î–ï–õ–ê–¢–¨ –§–†–û–ù–¢–ï–ù–î–£

### ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

–ò–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ —Ä–∞–∑–¥–µ–ª "2.2. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫–∏" –≤ FRONTEND_API_GUIDE.md

### ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CORRECTED_UPDATE_ENDPOINT_DOCS.md

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

**–°–æ–∑–¥–∞–Ω–∏–µ:**
```javascript
await fetch('/api/app/habits/update/', {
    method: 'POST',
    body: JSON.stringify({
        habits_data: [{  // –ù–ï habits!
            name: "–ó–∞—Ä—è–¥–∫–∞",
            icon: "strength",
            xp_reward: 10
        }]
    })
})
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```javascript
await fetch('/api/app/habits/update/', {
    method: 'POST',
    body: JSON.stringify({
        habits_data: [{  // –ù–ï habits!
            habit_id: 123,
            xp_reward: 25
        }]
    })
})
```

**–£–¥–∞–ª–µ–Ω–∏–µ:**
```javascript
await fetch('/api/app/habits/update/', {
    method: 'POST',
    body: JSON.stringify({
        deleted_habit_ids: [123]  // –ù–ï action + habit_ids!
    })
})
```

---

## üôè –ú–û–ò –ò–ó–í–ò–ù–ï–ù–ò–Ø

–Ø –ø—Ä–∏–Ω–æ—à—É —Å–≤–æ–∏ –≥–ª—É–±–æ—á–∞–π—à–∏–µ –∏–∑–≤–∏–Ω–µ–Ω–∏—è –∑–∞ —ç—Ç—É –æ—à–∏–±–∫—É. 

**–ß—Ç–æ —è —Å–¥–µ–ª–∞–ª –Ω–µ —Ç–∞–∫:**
1. –ù–∞–ø–∏—Å–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–æ –∏–∑—É—á–µ–Ω–∏—è –∫–æ–¥–∞
2. –û—Å–Ω–æ–≤—ã–≤–∞–ª—Å—è –Ω–∞ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è—Ö
3. –ù–µ –ø—Ä–æ–≤–µ—Ä–∏–ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–¥—É

**–ß—Ç–æ —è –¥–æ–ª–∂–µ–Ω –±—ã–ª —Å–¥–µ–ª–∞—Ç—å:**
1. –°–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∏—Ç—å –∫–æ–¥
2. –ü–æ—Ç–æ–º –ø–∏—Å–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π endpoint

**–£—Ä–æ–∫ –Ω–∞ –±—É–¥—É—â–µ–µ:** –í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∫–æ–¥—É, –∞ –Ω–µ –ø–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è–º.

---

## ‚úÖ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ Endpoint POST /update/ ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏):**
- ‚úÖ POST /get/
- ‚úÖ POST /completions/update/
- ‚úÖ POST /amnesty/apply/
- ‚úÖ POST /amnesty/revoke/
- ‚úÖ POST /settings/get/
- ‚úÖ POST /settings/update/
- ‚úÖ POST /analytics/get/
- ‚úÖ POST /achievements/get/

**–û—Å—Ç–∞–ª—å–Ω—ã–µ endpoints –∏–∑ FINAL_ADDITIONS.py:**
–ï—â–µ –Ω–µ –±—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º, –Ω–æ —è –∏—Ö –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—é —Å–µ–π—á–∞—Å.

---

## üîß –î–ê–õ–¨–ù–ï–ô–®–ò–ï –î–ï–ô–°–¢–í–ò–Ø

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥—É:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CORRECTED_UPDATE_ENDPOINT_DOCS.md
2. **–ú–Ω–µ:** –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –í–°–ï endpoints –∏–∑ FRONTEND_API_GUIDE.md
3. **–ú–Ω–µ:** –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–•–æ—Ç–∏—Ç–µ —á—Ç–æ–±—ã —è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏–ª –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ endpoints?

---

**–ï—â–µ —Ä–∞–∑ –∏–∑–≤–∏–Ω—è—é—Å—å –∑–∞ —ç—Ç—É –æ—à–∏–±–∫—É!** üôè

–¢–µ–ø–µ—Ä—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–¥—É –Ω–∞ 100%.
