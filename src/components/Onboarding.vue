<template>
  <div class="onboarding-overlay">
    <div class="onboarding-container">
<<<<<<< HEAD
      <!-- Loading State -->
      <div v-if="isLoading" class="loading-state">
        <div class="loading-spinner"></div>
        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
      </div>

      <template v-else>
        <!-- Progress Bar -->
        <div class="progress-section">
          <div class="progress-bar-bg">
            <div 
              class="progress-bar-fill"
              :style="{ width: `${(currentStep / totalSteps) * 100}%` }"
            ></div>
          </div>
          <div class="progress-text">–®–∞–≥ {{ currentStep }} –∏–∑ {{ totalSteps }}</div>
        </div>

        <!-- Step 1: Philosophy -->
        <div v-if="currentStep === 1" class="step-content step-philosophy">
          <div class="philosophy-icon">üéÆ</div>
          <h1 class="step-title">–ñ–∏–∑–Ω—å ‚Äî —ç—Ç–æ –∏–≥—Ä–∞.<br>–¢—ã ‚Äî –µ—ë —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</h1>
=======
      <!-- Progress Bar -->
      <div class="progress-section">
        <div class="progress-bar-bg">
          <div 
            class="progress-bar-fill"
            :style="{ width: `${(currentStep / totalSteps) * 100}%` }"
          ></div>
        </div>
        <div class="progress-text">–®–∞–≥ {{ currentStep }} –∏–∑ {{ totalSteps }}</div>
      </div>

      <!-- Step 1: Philosophy -->
      <div v-if="currentStep === 1" class="step-content step-philosophy">
        <div class="philosophy-icon">üéÆ</div>
        <h1 class="step-title">–ñ–∏–∑–Ω—å ‚Äî —ç—Ç–æ –∏–≥—Ä–∞.<br>–¢—ã ‚Äî –µ—ë —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</h1>
>>>>>>> origin/main
        <div class="philosophy-text">
          <p>
            –°–∏—Å—Ç–µ–º–∞ 1% ‚Äî —ç—Ç–æ –Ω–µ –∫—É—Ä—Å –∏ –Ω–µ –Ω–∞–±–æ—Ä —Å–æ–≤–µ—Ç–æ–≤. –≠—Ç–æ —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–≤–∏–∂–æ–∫ —Ä–∞–∑–≤–∏—Ç–∏—è, 
            –≥–¥–µ —Ç—ã —Å–æ–∑–¥–∞—ë—à—å –ø—Ä–∞–≤–∏–ª–∞, –≤—ã–±–∏—Ä–∞–µ—à—å —Ü–µ–ª–∏ –∏ –ø—Ä–æ—Ö–æ–¥–∏—à—å —É—Ä–æ–≤–Ω–∏.
          </p>
          <p>
            –¢—ã –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–≥—Ä–æ–∫ –≤ —á—É–∂–æ–π –∏–≥—Ä–µ ‚Äî —Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–≤–æ–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è. 
            –ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Ç—ã –¥–µ–ª–∞–µ—à—å –≤—ã–±–æ—Ä: —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –∏–ª–∏ —Å—Ç–æ—è—Ç—å –Ω–∞ –º–µ—Å—Ç–µ.
          </p>
          <p class="highlight">
            üí° –£–ª—É—á—à–∞—è—Å—å –Ω–∞ 1% –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –∑–∞ –≥–æ–¥ —Ç—ã —Å—Ç–∞–Ω–µ—à—å —Å–∏–ª—å–Ω–µ–µ –≤ 38 —Ä–∞–∑.
          </p>
        </div>

        <div class="key-ideas">
          <div class="key-idea-item">
            <span class="idea-icon">üéØ</span>
            <div>
              <strong>–°–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å, –∞ –Ω–µ –º–æ—Ç–∏–≤–∞—Ü–∏—è</strong>
              <p>–†–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∫–∞, –∞ –Ω–µ —ç–º–æ—Ü–∏–∏</p>
            </div>
          </div>
          <div class="key-idea-item">
            <span class="idea-icon">üìä</span>
            <div>
              <strong>–ò–∑–º–µ—Ä—è–µ–º—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å</strong>
              <p>–í–∏–¥–∏—à—å —Ä–æ—Å—Ç –≤ —Ü–∏—Ñ—Ä–∞—Ö –∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö</p>
            </div>
          </div>
          <div class="key-idea-item">
            <span class="idea-icon">üîÑ</span>
            <div>
              <strong>–ß–µ—Å—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞</strong>
              <p>–ë–µ–∑ –∏–ª–ª—é–∑–∏–π, —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å</p>
            </div>
          </div>
        </div>

<<<<<<< HEAD
        <button 
          class="btn btn-primary btn-large" 
          @click="nextStep"
          :disabled="isSaving"
        >
          {{ step1ButtonText }}
=======
        <button class="btn btn-primary btn-large" @click="nextStep">
          –ù–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π –∏–≥—Ä—ã
>>>>>>> origin/main
        </button>
      </div>

      <!-- Step 2: Reflection -->
      <div v-if="currentStep === 2" class="step-content step-reflection">
        <h2 class="step-title">–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è, –∑–∞—á–µ–º —Ç—ã –∑–¥–µ—Å—å</h2>
        <p class="step-subtitle">–ß–µ—Å—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Äî –æ—Å–Ω–æ–≤–∞ —Ç–≤–æ–µ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</p>

        <div class="form-group">
          <label class="form-label">
            <span class="question-number">1.</span>
            –ü–æ—á–µ–º—É —Ç—ã –ø—Ä–∏—à—ë–ª –≤ "–°–∏—Å—Ç–µ–º—É 1%"?
          </label>
          <span class="form-hint">–ß—Ç–æ –ø—Ä–∏–≤–µ–ª–æ —Ç–µ–±—è —Å—é–¥–∞? –ö–∞–∫–∞—è –±–æ–ª—å –∏–ª–∏ –∂–µ–ª–∞–Ω–∏–µ?</span>
          <textarea 
            v-model="formData.whyHere"
            class="form-textarea"
            rows="5"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –£—Å—Ç–∞–ª –æ—Ç —Ö–∞–æ—Å–∞, —Ö–æ—á—É —Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –∂–∏–∑–Ω—å—é..."
          ></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="question-number">2.</span>
            –ß—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å –≤ "—Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å–≤–æ–µ–π –∏–≥—Ä—ã"?
          </label>
          <span class="form-hint">–ö–∞–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã –∂–∏–∑–Ω–∏ —Ç—Ä–µ–±—É—é—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏?</span>
          <textarea 
            v-model="formData.whatToChange"
            class="form-textarea"
            rows="5"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –•–æ—á—É –≤—ã—Å—Ç—Ä–æ–∏—Ç—å –∑–¥–æ—Ä–æ–≤—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ—Ö–æ–¥, –Ω–∞–π—Ç–∏ –±–∞–ª–∞–Ω—Å..."
          ></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="question-number">3.</span>
            –ß—Ç–æ –¥–ª—è —Ç–µ–±—è —Å–µ–π—á–∞—Å –∑–æ–Ω–∞ —Ä–æ—Å—Ç–∞, –∞ —á—Ç–æ –∑–æ–Ω–∞ –∫–æ–º—Ñ–æ—Ä—Ç–∞?
          </label>
          <span class="form-hint">–ë—É–¥—å —á–µ—Å—Ç–µ–Ω: –≥–¥–µ —Ç—ã —Ä–∞—Å—Ç—ë—à—å, –∞ –≥–¥–µ –ø—Ä—è—á–µ—à—å—Å—è?</span>
          <textarea 
            v-model="formData.growthVsComfort"
            class="form-textarea"
            rows="5"
            placeholder="–ó–æ–Ω–∞ —Ä–æ—Å—Ç–∞: –ø—É–±–ª–∏—á–Ω—ã–µ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è, –Ω–æ–≤—ã–µ –ø—Ä–æ–µ–∫—Ç—ã...
–ó–æ–Ω–∞ –∫–æ–º—Ñ–æ—Ä—Ç–∞: –ø—Ä–∏–≤—ã—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π..."
          ></textarea>
        </div>

        <div class="step-actions">
<<<<<<< HEAD
          <button class="btn btn-secondary" @click="prevStep" :disabled="isSaving">–ù–∞–∑–∞–¥</button>
          <button 
            class="btn btn-primary" 
            @click="nextStep"
            :disabled="!isStep2Valid || isSaving"
          >
            {{ isSaving ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' }}
=======
          <button class="btn btn-secondary" @click="prevStep">–ù–∞–∑–∞–¥</button>
          <button 
            class="btn btn-primary" 
            @click="nextStep"
            :disabled="!isStep2Valid"
          >
            –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
>>>>>>> origin/main
          </button>
        </div>
      </div>

      <!-- Step 3: My Start -->
      <div v-if="currentStep === 3" class="step-content step-my-start">
        <h2 class="step-title">–¢–≤–æ—è —Ç–æ—á–∫–∞ —Å—Ç–∞—Ä—Ç–∞</h2>
        <p class="step-subtitle">–û–ø—Ä–µ–¥–µ–ª–∏, –æ—Ç–∫—É–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—à—å –∏ –∫—É–¥–∞ –∏–¥—ë—à—å</p>

        <div class="journey-visual">
          <div class="point point-a">
            <span class="point-label">–¢–æ—á–∫–∞ –ê</span>
            <span class="point-icon">üìç</span>
          </div>
          <div class="journey-arrow">‚Üí</div>
          <div class="point point-b">
            <span class="point-label">–¢–æ—á–∫–∞ –ë</span>
            <span class="point-icon">üéØ</span>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">
            üìç –¢–æ—á–∫–∞ –ê: –ì–¥–µ —è —Å–µ–π—á–∞—Å
          </label>
          <span class="form-hint">–û–ø–∏—à–∏ —Å–≤–æ—ë —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ –ø—Ä–∏–∫—Ä–∞—Å</span>
          <textarea 
            v-model="formData.pointA"
            class="form-textarea"
            rows="4"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–∞–±–æ—Ç–∞—é –Ω–∞ –Ω–µ–ª—é–±–∏–º–æ–π —Ä–∞–±–æ—Ç–µ, –¥–æ—Ö–æ–¥ 80–∫, –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å–µ–±—è, –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ 5/10..."
          ></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">
            üéØ –¢–æ—á–∫–∞ –ë: –ö—É–¥–∞ —Ö–æ—á—É –ø—Ä–∏–π—Ç–∏
          </label>
          <span class="form-hint">–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ –∂–µ–ª–∞–µ–º–æ–≥–æ –±—É–¥—É—â–µ–≥–æ</span>
          <textarea 
            v-model="formData.pointB"
            class="form-textarea"
            rows="4"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–∞–±–æ—Ç–∞—é –Ω–∞ —Å–µ–±—è, –¥–æ—Ö–æ–¥ 200–∫+, –∑–¥–æ—Ä–æ–≤—å–µ 9/10, –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–∞–±–æ—Ç–æ–π –∏ –∂–∏–∑–Ω—å—é..."
          ></textarea>
        </div>

        <div class="form-group">
          <label class="form-label">
            üíé –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –º–µ–Ω—è
          </label>
          <span class="form-hint">–í —á—ë–º –≥–ª—É–±–∏–Ω–Ω—ã–π —Å–º—ã—Å–ª —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π?</span>
          <textarea 
            v-model="formData.whyImportant"
            class="form-textarea"
            rows="4"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –•–æ—á—É —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å, —á—Ç–æ –∂–∏–≤—É —Å–≤–æ—é –∂–∏–∑–Ω—å, –∞ –Ω–µ —á—É–∂–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π. –í–∞–∂–Ω–∞ —Å–≤–æ–±–æ–¥–∞ –∏ —Å–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è..."
          ></textarea>
        </div>

        <div class="step-actions">
<<<<<<< HEAD
          <button class="btn btn-secondary" @click="prevStep" :disabled="isSaving">–ù–∞–∑–∞–¥</button>
          <button 
            class="btn btn-primary" 
            @click="nextStep"
            :disabled="!isStep3Valid || isSaving"
          >
            {{ isSaving ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' }}
=======
          <button class="btn btn-secondary" @click="prevStep">–ù–∞–∑–∞–¥</button>
          <button 
            class="btn btn-primary" 
            @click="nextStep"
            :disabled="!isStep3Valid"
          >
            –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
>>>>>>> origin/main
          </button>
        </div>
      </div>

      <!-- Step 4: Rules -->
      <div v-if="currentStep === 4" class="step-content step-rules">
        <div class="completion-icon">‚úÖ</div>
        <h2 class="step-title">–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ!</h2>
        <p class="step-subtitle">–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —á–µ—Å—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ</p>

        <div class="summary-card">
          <h3>–¢—ã –∑–∞–ø–æ–ª–Ω–∏–ª:</h3>
          <div class="summary-items">
            <div class="summary-item">
              <span class="check-icon">‚úì</span>
              <span>–ü–æ–Ω—è–ª —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é —Å–∏—Å—Ç–µ–º—ã</span>
            </div>
            <div class="summary-item">
              <span class="check-icon">‚úì</span>
              <span>–û—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏</span>
            </div>
            <div class="summary-item">
              <span class="check-icon">‚úì</span>
              <span>–û–ø—Ä–µ–¥–µ–ª–∏–ª —Ç–æ—á–∫–∏ –ê –∏ –ë</span>
            </div>
          </div>
        </div>

        <div class="rules-section">
          <h3>–ü—Ä–∏–Ω—Ü–∏–ø—ã –°–∏—Å—Ç–µ–º—ã 1%</h3>
          <div class="rules-list">
            <div class="rule-item">
              <span class="rule-number">1</span>
              <p>–ß–µ—Å—Ç–Ω–æ—Å—Ç—å —Å —Å–æ–±–æ–π ‚Äî –æ—Å–Ω–æ–≤–∞ —Ä–æ—Å—Ç–∞. –ë–µ–∑ –∏–ª–ª—é–∑–∏–π –∏ —Å–∞–º–æ–æ–±–º–∞–Ω–∞.</p>
            </div>
            <div class="rule-item">
              <span class="rule-number">2</span>
              <p>–°–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –º–æ—Ç–∏–≤–∞—Ü–∏–∏. –î–µ–ª–∞–µ—à—å +1% –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –∞ –Ω–µ –∂–¥—ë—à—å –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è.</p>
            </div>
            <div class="rule-item">
              <span class="rule-number">3</span>
              <p>–î–µ–π—Å—Ç–≤–∏–µ, –∞ –Ω–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –ó–Ω–∞–Ω–∏—è –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è ‚Äî –∏–ª–ª—é–∑–∏—è.</p>
            </div>
            <div class="rule-item">
              <span class="rule-number">4</span>
              <p>–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –¢—ã ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–≤–æ–µ–π –∏–≥—Ä—ã.</p>
            </div>
          </div>
        </div>

        <label class="checkbox-container">
          <input 
            type="checkbox" 
            v-model="formData.acceptRules"
            class="checkbox-input"
          />
          <span class="checkbox-label">
            –ü—Ä–∏–Ω–∏–º–∞—é –ø—Ä–∞–≤–∏–ª–∞ –°–∏—Å—Ç–µ–º—ã 1% –∏ –≥–æ—Ç–æ–≤ –∫ —á–µ—Å—Ç–Ω–æ–π, —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ä–∞–±–æ—Ç–µ
          </span>
        </label>

        <div class="step-actions">
<<<<<<< HEAD
          <button class="btn btn-secondary" @click="prevStep" :disabled="isSaving">–ù–∞–∑–∞–¥</button>
          <button 
            class="btn btn-primary btn-large" 
            @click="completeOnboarding"
            :disabled="!formData.acceptRules || isSaving"
          >
            {{ isSaving ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : 'üöÄ –ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å' }}
          </button>
        </div>
      </div>
      </template>
=======
          <button class="btn btn-secondary" @click="prevStep">–ù–∞–∑–∞–¥</button>
          <button 
            class="btn btn-primary btn-large" 
            @click="completeOnboarding"
            :disabled="!formData.acceptRules"
          >
            üöÄ –ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å
          </button>
        </div>
      </div>
>>>>>>> origin/main
    </div>
  </div>
</template>

<script setup>
<<<<<<< HEAD
import { ref, computed, onMounted } from 'vue'
import { useAppStore } from '../stores/app'
import { DEBUG_MODE, SKIP_AUTH_CHECK } from '@/config/settings.js'
=======
import { ref, computed } from 'vue'
import { useAppStore } from '../stores/app'
>>>>>>> origin/main

const store = useAppStore()

const currentStep = ref(1)
const totalSteps = 4
<<<<<<< HEAD
const isLoading = ref(true)
const isSaving = ref(false)
const isResuming = ref(false)
const lastCompletedStep = ref(0)
=======
>>>>>>> origin/main

const formData = ref({
  whyHere: '',
  whatToChange: '',
  growthVsComfort: '',
  pointA: '',
  pointB: '',
  whyImportant: '',
  acceptRules: false
})

const isStep2Valid = computed(() => {
  return formData.value.whyHere.trim().length > 20 &&
         formData.value.whatToChange.trim().length > 20 &&
         formData.value.growthVsComfort.trim().length > 20
})

const isStep3Valid = computed(() => {
  return formData.value.pointA.trim().length > 20 &&
         formData.value.pointB.trim().length > 20 &&
         formData.value.whyImportant.trim().length > 20
})

<<<<<<< HEAD
const step1ButtonText = computed(() => {
  return isResuming.value ? '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π –∏–≥—Ä—ã' : '–ù–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–π –∏–≥—Ä—ã'
})

onMounted(async () => {
  if (DEBUG_MODE) {
    console.log('[Onboarding] Component mounted, loading data...')
  }
  
  if (SKIP_AUTH_CHECK) {
    if (DEBUG_MODE) {
      console.log('[Onboarding] Auth check skipped, using local data only')
    }
    isLoading.value = false
    return
  }
  
  try {
    await store.loadOnboardingFromBackend()
    
    const onboardingData = store.onboarding.data
    const stepCompleted = store.onboarding.stepCompleted || 0
    
    if (DEBUG_MODE) {
      console.log('[Onboarding] Data loaded from backend:', {
        stepCompleted,
        hasData: !!onboardingData.reason_joined
      })
    }
    
    if (stepCompleted > 0) {
      isResuming.value = true
      lastCompletedStep.value = stepCompleted
      
      formData.value.whyHere = onboardingData.reason_joined || ''
      formData.value.whatToChange = onboardingData.desired_changes || ''
      formData.value.growthVsComfort = onboardingData.growth_comfort_zones || ''
      formData.value.pointA = onboardingData.current_state || ''
      formData.value.pointB = onboardingData.goal_state || ''
      formData.value.whyImportant = onboardingData.why_important || ''
      
      if (DEBUG_MODE) {
        console.log('[Onboarding] Resuming from step:', stepCompleted + 1)
      }
    }
  } catch (error) {
    if (DEBUG_MODE) {
      console.error('[Onboarding] Failed to load data:', error)
    }
  } finally {
    isLoading.value = false
  }
})

async function nextStep() {
  if (currentStep.value < totalSteps) {
    isSaving.value = true
    
    let dataToSave = { step_completed: currentStep.value }
    
    if (currentStep.value === 2) {
      dataToSave.reason_joined = formData.value.whyHere
      dataToSave.desired_changes = formData.value.whatToChange
      dataToSave.growth_comfort_zones = formData.value.growthVsComfort
    } else if (currentStep.value === 3) {
      dataToSave.current_state = formData.value.pointA
      dataToSave.goal_state = formData.value.pointB
      dataToSave.why_important = formData.value.whyImportant
    }
    
    if (!SKIP_AUTH_CHECK) {
      const saved = await store.saveOnboardingToBackend(dataToSave)
      
      if (DEBUG_MODE) {
        console.log('[Onboarding] Step saved:', { step: currentStep.value, saved })
      }
    } else if (DEBUG_MODE) {
      console.log('[Onboarding] Step save skipped (SKIP_AUTH_CHECK=true):', dataToSave)
    }
    
    isSaving.value = false
    
    if (isResuming.value && currentStep.value === 1) {
      currentStep.value = lastCompletedStep.value + 1
      isResuming.value = false
    } else {
      currentStep.value++
    }
=======
function nextStep() {
  if (currentStep.value < totalSteps) {
    currentStep.value++
>>>>>>> origin/main
  }
}

function prevStep() {
  if (currentStep.value > 1) {
    currentStep.value--
  }
}

async function completeOnboarding() {
  if (!formData.value.acceptRules) return
<<<<<<< HEAD
  
  isSaving.value = true
  
  const backendData = {
    reason_joined: formData.value.whyHere,
    desired_changes: formData.value.whatToChange,
    growth_comfort_zones: formData.value.growthVsComfort,
    current_state: formData.value.pointA,
    goal_state: formData.value.pointB,
    why_important: formData.value.whyImportant,
    step_completed: 4,
    is_complete: true
  }
  
  if (!SKIP_AUTH_CHECK) {
    const saved = await store.completeOnboardingWithBackend(backendData)
    
    if (DEBUG_MODE) {
      console.log('[Onboarding] Completion saved to backend:', saved)
    }
  } else if (DEBUG_MODE) {
    console.log('[Onboarding] Completion save skipped (SKIP_AUTH_CHECK=true):', backendData)
  }
  
  const localData = {
=======

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
  const onboardingData = {
>>>>>>> origin/main
    whyHere: formData.value.whyHere,
    whatToChange: formData.value.whatToChange,
    growthVsComfort: formData.value.growthVsComfort,
    pointA: formData.value.pointA,
    pointB: formData.value.pointB,
    whyImportant: formData.value.whyImportant,
    acceptRules: formData.value.acceptRules,
    completedAt: new Date().toISOString()
  }
<<<<<<< HEAD
  
  store.completeOnboarding(localData)
  
  isSaving.value = false
  
  if (DEBUG_MODE) {
    console.log('[Onboarding] Completed successfully')
  }
=======

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ store
  store.completeOnboarding(onboardingData)

  // –í –±—É–¥—É—â–µ–º –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ backend:
  // await api.post('/onboarding', onboardingData)
  
  // –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–æ–µ—Ç—Å—è
  // –∏ –ø–æ–∫–∞–∂–µ—Ç—Å—è Dashboard, —Ç.–∫. isOnboardingCompleted —Å—Ç–∞–Ω–µ—Ç true
>>>>>>> origin/main
}
</script>

<style scoped>
.onboarding-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-secondary);
  z-index: 1000;
  overflow-y: auto;
}

.onboarding-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

<<<<<<< HEAD
/* Loading State */
.loading-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 50vh;
  gap: 1rem;
}

.loading-spinner {
  width: 48px;
  height: 48px;
  border: 4px solid var(--border-color);
  border-top-color: var(--primary-color);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.loading-state p {
  color: var(--text-secondary);
  font-size: 1.125rem;
}

=======
>>>>>>> origin/main
/* Progress Bar */
.progress-section {
  margin-bottom: 3rem;
}

.progress-bar-bg {
  height: 8px;
  background: var(--bg-tertiary);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 0.5rem;
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
  transition: width 0.5s ease;
}

.progress-text {
  text-align: center;
  font-size: 0.875rem;
  color: var(--text-secondary);
  font-weight: 500;
}

/* Step Content */
.step-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.step-title {
  font-size: 2rem;
  font-weight: 700;
  text-align: center;
  margin-bottom: 1rem;
  line-height: 1.2;
}

.step-subtitle {
  text-align: center;
  color: var(--text-secondary);
  font-size: 1.125rem;
  margin-bottom: 2rem;
}

/* Step 1: Philosophy */
.step-philosophy {
  align-items: center;
  text-align: center;
}

.philosophy-icon {
  font-size: 5rem;
  margin-bottom: 1.5rem;
  animation: bounce 2s infinite;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.philosophy-text {
  max-width: 600px;
  margin: 0 auto 2rem;
  text-align: left;
}

.philosophy-text p {
  margin-bottom: 1rem;
  line-height: 1.7;
  color: var(--text-primary);
  font-size: 1.0625rem;
}

.philosophy-text .highlight {
  padding: 1.25rem;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
  border-left: 4px solid var(--primary-color);
  border-radius: 0.5rem;
  font-weight: 500;
  color: var(--primary-color);
}

.key-ideas {
  display: grid;
  gap: 1rem;
  margin-bottom: 2rem;
  max-width: 600px;
  width: 100%;
}

.key-idea-item {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  padding: 1.25rem;
  background: var(--bg-primary);
  border-radius: 0.75rem;
  border: 1px solid var(--border-color);
  text-align: left;
  transition: transform 0.2s;
}

.key-idea-item:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.idea-icon {
  font-size: 2rem;
  flex-shrink: 0;
}

.key-idea-item strong {
  display: block;
  margin-bottom: 0.25rem;
  color: var(--text-primary);
}

.key-idea-item p {
  margin: 0;
  font-size: 0.9375rem;
  color: var(--text-secondary);
}

/* Step 2 & 3: Forms */
.form-group {
  margin-bottom: 2rem;
}

.form-label {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-weight: 600;
  font-size: 1.125rem;
  margin-bottom: 0.5rem;
  color: var(--text-primary);
}

.question-number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: var(--primary-color);
  color: white;
  border-radius: 50%;
  font-size: 1rem;
  font-weight: 700;
}

.form-hint {
  display: block;
  margin-bottom: 0.75rem;
  font-size: 0.9375rem;
  color: var(--text-secondary);
  font-style: italic;
}

.form-textarea {
  width: 100%;
  padding: 1rem;
  font-size: 1rem;
  border: 2px solid var(--border-color);
  border-radius: 0.75rem;
  background: var(--bg-primary);
  color: var(--text-primary);
  resize: vertical;
  font-family: inherit;
  line-height: 1.6;
  transition: all 0.2s;
}

.form-textarea:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.form-textarea::placeholder {
  color: var(--text-tertiary);
}

/* Step 3: Journey Visual */
.journey-visual {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
  margin: 2rem 0;
  padding: 2rem;
  background: var(--bg-primary);
  border-radius: 1rem;
  border: 2px dashed var(--border-color);
}

.point {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
}

.point-label {
  font-weight: 600;
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.point-icon {
  font-size: 3rem;
}

.journey-arrow {
  font-size: 2rem;
  color: var(--primary-color);
  font-weight: 700;
}

/* Step 4: Completion */
.completion-icon {
  font-size: 5rem;
  text-align: center;
  margin-bottom: 1rem;
}

.summary-card {
  background: var(--bg-primary);
  border-radius: 1rem;
  padding: 1.5rem;
  margin-bottom: 2rem;
  border: 1px solid var(--border-color);
}

.summary-card h3 {
  font-size: 1.25rem;
  margin-bottom: 1rem;
}

.summary-items {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.summary-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-size: 1rem;
}

.check-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: var(--success-color);
  color: white;
  border-radius: 50%;
  font-weight: 700;
  font-size: 0.875rem;
}

.rules-section {
  margin-bottom: 2rem;
}

.rules-section h3 {
  font-size: 1.25rem;
  margin-bottom: 1rem;
}

.rules-list {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.rule-item {
  display: flex;
  gap: 1rem;
  padding: 1rem;
  background: var(--bg-primary);
  border-radius: 0.75rem;
  border: 1px solid var(--border-color);
}

.rule-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color: white;
  border-radius: 50%;
  font-weight: 700;
  flex-shrink: 0;
}

.rule-item p {
  margin: 0;
  line-height: 1.6;
}

.checkbox-container {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  padding: 1.25rem;
  background: rgba(99, 102, 241, 0.05);
  border: 2px solid var(--primary-color);
  border-radius: 0.75rem;
  cursor: pointer;
  margin-bottom: 2rem;
  transition: all 0.2s;
}

.checkbox-container:hover {
  background: rgba(99, 102, 241, 0.1);
}

.checkbox-input {
  width: 24px;
  height: 24px;
  cursor: pointer;
  flex-shrink: 0;
  margin-top: 0.125rem;
}

.checkbox-label {
  font-size: 1.0625rem;
  font-weight: 500;
  line-height: 1.6;
}

/* Buttons */
.step-actions {
  display: flex;
  gap: 1rem;
  margin-top: auto;
  padding-top: 2rem;
}

.btn {
  flex: 1;
  padding: 1rem 2rem;
  font-size: 1.0625rem;
  font-weight: 600;
  border-radius: 0.75rem;
  border: none;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color: white;
}

.btn-primary:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(99, 102, 241, 0.3);
}

.btn-secondary {
  background: var(--bg-primary);
  color: var(--text-primary);
  border: 2px solid var(--border-color);
}

.btn-secondary:hover {
  background: var(--bg-tertiary);
}

.btn-large {
  font-size: 1.125rem;
  padding: 1.25rem 2.5rem;
}

@media (max-width: 768px) {
  .onboarding-container {
    padding: 1rem;
  }

  .step-title {
    font-size: 1.5rem;
  }

  .journey-visual {
    flex-direction: column;
    gap: 1rem;
  }

  .journey-arrow {
    transform: rotate(90deg);
  }

  .step-actions {
    flex-direction: column;
  }

  .key-ideas {
    gap: 0.75rem;
  }
}
</style>
