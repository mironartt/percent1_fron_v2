{% extends "catalog/base.html" %}
{% load static %}

{% block title %}{{ step.name }} ‚Äî —à–∞–≥ –∫ —Ü–µ–ª–∏ ‚Ä¢ OnePercent{% endblock %}
{% block description %}{{ step.name }}: {{ step.short_description }}. –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é —à–∞–≥–∞.{% endblock %}
{% block og_title %}{{ step.name }} ‚Äî —à–∞–≥ –∫ —Ü–µ–ª–∏ ‚Ä¢ OnePercent{% endblock %}
{% block og_description %}{{ step.short_description }}{% endblock %}
{% block og_url %}https://percent1.ru/catalog/goals/steps/{{ step.slug }}/{% endblock %}

{% block breadcrumbs %}
<a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/">–ö–∞—Ç–∞–ª–æ–≥</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/goals/">–¶–µ–ª–∏</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/goals/steps/">–®–∞–≥–∏</a>
<span class="separator">‚Ä∫</span>
<span class="current">{{ step.name_short }}</span>
{% endblock %}

{% block content %}
<article class="step-detail-page">
    <section class="hero-section step-hero">
        <div class="hero-icon">üìä</div>
        <p class="step-label">–®–ê–ì:</p>
        <h1 class="hero-title">{{ step.name }}</h1>
        <p class="hero-subtitle">{{ step.subtitle }}</p>
        <div class="step-stats">
            <div class="stat-item">
                <span class="stat-value">‚è± {{ step.duration_display }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-value difficulty-{{ step.difficulty }}">{{ step.difficulty_display }}</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">{{ step.type_display }}</span>
            </div>
        </div>
    </section>

    <section class="step-why-section">
        <h2 class="section-title">–ó–∞—á–µ–º —ç—Ç–æ—Ç —à–∞–≥</h2>
        <div class="step-why-content">
            {{ step.why_description|linebreaks }}
        </div>
        {% if step.what_you_get %}
        <div class="what-you-get">
            <h3>–≠—Ç–æ—Ç —à–∞–≥ –¥–∞—Å—Ç –≤–∞–º:</h3>
            <ul>
                {% for item in step.what_you_get %}
                <li>‚Ä¢ {{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </section>

    <section class="step-how-section">
        <h2 class="section-title">–ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —à–∞–≥</h2>
        <div class="step-methods">
            {% for method in step.methods %}
            <div class="method-block">
                <h3>{{ method.title }}</h3>
                <ol class="method-steps">
                    {% for sub_step in method.steps %}
                    <li>
                        <strong>{{ sub_step.title }}</strong>
                        <p>{{ sub_step.description }}</p>
                    </li>
                    {% endfor %}
                </ol>
            </div>
            {% endfor %}
        </div>
    </section>

    {% if step.template %}
    <section class="step-template-section">
        <h2 class="section-title">–®–∞–±–ª–æ–Ω –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞</h2>
        <div class="template-block">
            <pre>{{ step.template }}</pre>
        </div>
    </section>
    {% endif %}

    {% if step.common_mistakes %}
    <section class="step-mistakes-section">
        <h2 class="section-title">–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏</h2>
        <ul class="mistakes-list">
            {% for mistake in step.common_mistakes %}
            <li>‚ùå {{ mistake }}</li>
            {% endfor %}
        </ul>
    </section>
    {% endif %}

    {% if step.tips %}
    <section class="step-tips-section">
        <h2 class="section-title">–°–æ–≤–µ—Ç—ã</h2>
        <ul class="tips-list">
            {% for tip in step.tips %}
            <li>üí° {{ tip }}</li>
            {% endfor %}
        </ul>
    </section>
    {% endif %}

    <section class="step-parent-goal-section">
        <h2 class="section-title">üéØ –¶–µ–ª—å —Å —ç—Ç–∏–º —à–∞–≥–æ–º</h2>
        <div class="parent-goal-card">
            <div class="goal-header">
                <span class="goal-icon">üéØ</span>
                <div class="goal-content">
                    <h3><a href="/catalog/goals/{{ step.goal.category.slug }}/{{ step.goal.subcategory.slug }}/{{ step.goal.slug }}/">{{ step.goal.name }}</a></h3>
                    <div class="goal-meta">
                        <span>{{ step.goal.category.icon }} {{ step.goal.category.name }}</span>
                        <span>{{ step.goal.steps_count }} —à–∞–≥–æ–≤</span>
                        <span class="difficulty-{{ step.goal.difficulty }}">{{ step.goal.difficulty_display }}</span>
                    </div>
                </div>
            </div>
            <p class="goal-description">{{ step.goal.short_description }}</p>
            <a href="/catalog/goals/{{ step.goal.category.slug }}/{{ step.goal.subcategory.slug }}/{{ step.goal.slug }}/" class="btn-link">–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ü–µ–ª–∏ ‚Üí</a>
        </div>
    </section>

    {% if other_goals_with_step %}
    <section class="other-goals-section">
        <h2 class="section-title">–î—Ä—É–≥–∏–µ —Ü–µ–ª–∏ —Å —ç—Ç–∏–º —à–∞–≥–æ–º</h2>
        <p class="section-desc">–≠—Ç–æ—Ç —à–∞–≥ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º –¥–ª—è {{ other_goals_with_step|length }} —Ü–µ–ª–µ–π:</p>
        <div class="goals-list compact">
            {% for goal in other_goals_with_step %}
            <a href="/catalog/goals/{{ goal.category.slug }}/{{ goal.subcategory.slug }}/{{ goal.slug }}/" class="goal-card-compact">
                <span class="goal-icon">üéØ</span>
                <div class="goal-info">
                    <h3>{{ goal.name }}</h3>
                    <p class="goal-meta-compact">{{ goal.category.icon }} {{ goal.category.name }}</p>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <section class="cta-section">
        <div class="cta-box">
            <h2>–î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å —Å —ç—Ç–∏–º —à–∞–≥–æ–º</h2>
            <p>–ù–∞—á–Ω–∏—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å —ç—Ç–æ—Ç —à–∞–≥ –≤ —Ä–∞–º–∫–∞—Ö –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ü–µ–ª–∏</p>
            <a href="/auth/register/?add_goal={{ step.goal.id }}" class="btn btn-primary btn-lg">–î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</a>
        </div>
    </section>
</article>
{% endblock %}
