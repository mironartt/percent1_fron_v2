{% extends "catalog/base.html" %}
{% load static %}

{% block title %}{{ habit.name }} ‚Äî –ø—Ä–∏–≤—ã—á–∫–∞ –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è ‚Ä¢ OnePercent{% endblock %}
{% block description %}{{ habit.name }}: {{ habit.short_description }}. {{ habit.duration_display }}, {{ habit.difficulty_display }}, {{ habit.frequency_display }}.{% endblock %}
{% block og_title %}{{ habit.name }} ‚Äî –ø—Ä–∏–≤—ã—á–∫–∞ ‚Ä¢ OnePercent{% endblock %}
{% block og_description %}{{ habit.short_description }}. {{ habit.duration_display }}.{% endblock %}
{% block og_url %}https://percent1.ru/catalog/habits/{{ category.slug }}/{{ subcategory.slug }}/{{ habit.slug }}/{% endblock %}

{% block breadcrumbs %}
<a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/">–ö–∞—Ç–∞–ª–æ–≥</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/habits/">–ü—Ä–∏–≤—ã—á–∫–∏</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/habits/{{ category.slug }}/">{{ category.name }}</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/habits/{{ category.slug }}/{{ subcategory.slug }}/">{{ subcategory.name }}</a>
<span class="separator">‚Ä∫</span>
<span class="current">{{ habit.name_short }}</span>
{% endblock %}

{% block content %}
<article class="habit-detail-page">
    <section class="hero-section yellow habit-hero">
        <div class="hero-icon">‚ö°</div>
        <h1 class="hero-title">{{ habit.name }}</h1>
        <p class="habit-category-path">
            <a href="/catalog/habits/{{ category.slug }}/">{{ category.icon }} {{ category.name }}</a>
            <span class="path-separator">‚Ä∫</span>
            <a href="/catalog/habits/{{ category.slug }}/{{ subcategory.slug }}/">{{ subcategory.icon }} {{ subcategory.name }}</a>
        </p>
        <div class="habit-stats">
            <div class="stat-item">
                <span class="stat-value">‚è± {{ habit.duration_display }}</span>
                <span class="stat-label">–≤—Ä–µ–º—è</span>
            </div>
            <div class="stat-item">
                <span class="stat-value difficulty-{{ habit.difficulty }}">{{ habit.difficulty_display }}</span>
                <span class="stat-label">—Å–ª–æ–∂–Ω–æ—Å—Ç—å</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">{{ habit.frequency_display }}</span>
                <span class="stat-label">—á–∞—Å—Ç–æ—Ç–∞</span>
            </div>
        </div>
        <div class="habit-cta">
            <a href="/auth/register/?add_habit={{ habit.id }}" class="btn btn-primary orange btn-lg">+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É –≤ —Å–≤–æ–π –ø–ª–∞–Ω</a>
        </div>
    </section>

    <section class="habit-description-section">
        <h2 class="section-title">–û–ø–∏—Å–∞–Ω–∏–µ</h2>
        <div class="habit-full-description">
            {{ habit.description|linebreaks }}
        </div>
    </section>

    {% if habit.benefits %}
    <section class="habit-benefits-section">
        <h2 class="section-title">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h2>
        <ul class="benefits-list">
            {% for benefit in habit.benefits %}
            <li>‚úì {{ benefit }}</li>
            {% endfor %}
        </ul>
    </section>
    {% endif %}

    {% if habit.tips %}
    <section class="habit-tips-section">
        <h2 class="section-title">–°–æ–≤–µ—Ç—ã –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é</h2>
        <div class="tips-list">
            {% for tip in habit.tips %}
            <div class="tip-card">
                <span class="tip-number">{{ forloop.counter }}</span>
                <p>{{ tip }}</p>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if habit.expected_result %}
    <section class="habit-result-section">
        <h2 class="section-title">–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h2>
        <div class="result-card">
            <span class="result-icon">üéâ</span>
            <p>{{ habit.expected_result }}</p>
        </div>
    </section>
    {% endif %}

    <section class="habit-tags-section">
        <h2 class="section-title">–¢–µ–≥–∏</h2>
        <div class="tags-cloud">
            {% for tag in habit.tags.all %}
            <a href="/catalog/habits/tags/{{ tag.slug }}/" class="tag-link orange">#{{ tag.name }}</a>
            {% endfor %}
        </div>
    </section>

    {% if related_goals %}
    <section class="related-goals-section">
        <h2 class="section-title">–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ü–µ–ª–∏</h2>
        <p class="section-desc">–≠—Ç–∞ –ø—Ä–∏–≤—ã—á–∫–∞ –ø–æ–º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å —Å–ª–µ–¥—É—é—â–∏—Ö —Ü–µ–ª–µ–π:</p>
        <div class="goals-list compact">
            {% for goal in related_goals %}
            <a href="/catalog/goals/{{ goal.category.slug }}/{{ goal.subcategory.slug }}/{{ goal.slug }}/" class="goal-card-compact">
                <span class="goal-icon">üéØ</span>
                <div class="goal-info">
                    <h3>{{ goal.name }}</h3>
                    <p class="goal-meta-compact">{{ goal.steps_count }} —à–∞–≥–æ–≤ ‚Ä¢ {{ goal.difficulty_display }}</p>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    {% if related_bundle %}
    <section class="bundle-promo-section">
        <div class="bundle-promo-card orange">
            <div class="bundle-promo-icon">üì¶</div>
            <div class="bundle-promo-content">
                <h3>–ì–æ—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä: {{ related_bundle.name }}</h3>
                <p>–≠—Ç–∞ –ø—Ä–∏–≤—ã—á–∫–∞ + —Ü–µ–ª—å –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</p>
            </div>
            <a href="/catalog/bundles/{{ related_bundle.slug }}/" class="btn btn-primary green">–°–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–±–æ—Ä ‚Üí</a>
        </div>
    </section>
    {% endif %}

    {% if similar_habits %}
    <section class="similar-habits-section">
        <h2 class="section-title">–ü–æ—Ö–æ–∂–∏–µ –ø—Ä–∏–≤—ã—á–∫–∏</h2>
        <div class="habits-grid compact">
            {% for similar in similar_habits %}
            <a href="/catalog/habits/{{ similar.category.slug }}/{{ similar.subcategory.slug }}/{{ similar.slug }}/" class="habit-card-mini">
                <div class="habit-header">
                    <span class="habit-icon">‚ö°</span>
                    <h3>{{ similar.name }}</h3>
                </div>
                <div class="habit-meta">
                    <span>{{ similar.duration_display }}</span>
                    <span class="difficulty-{{ similar.difficulty }}">{{ similar.difficulty_display }}</span>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <section class="cta-section">
        <div class="cta-box orange">
            <h2>–ù–∞—á–Ω–∏—Ç–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–≤—ã—á–∫—É —Å–µ–≥–æ–¥–Ω—è</h2>
            <p>–î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É –ø—Ä–∏–≤—ã—á–∫—É –≤ —Å–≤–æ–π –ø–ª–∞–Ω –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</p>
            <a href="/auth/register/?add_habit={{ habit.id }}" class="btn btn-primary orange btn-lg">–ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ</a>
        </div>
    </section>

    <section class="other-categories-section">
        <h2 class="section-title">–î—Ä—É–≥–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
        <div class="categories-links">
            {% for cat in other_categories %}
            <a href="/catalog/habits/{{ cat.slug }}/" class="category-link-btn orange">{{ cat.icon }} {{ cat.name }}</a>
            {% endfor %}
        </div>
    </section>
</article>
{% endblock %}
