{% extends "catalog/base.html" %}
{% load static %}

{% block title %}{{ bundle.name }} ‚Äî –≥–æ—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä —Ü–µ–ª—å + –ø—Ä–∏–≤—ã—á–∫–∏ ‚Ä¢ OnePercent{% endblock %}
{% block description %}{{ bundle.name }}: {{ bundle.goal.name }} + {{ bundle.habits_count }} –ø—Ä–∏–≤—ã—á–µ–∫ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –ì–æ—Ç–æ–≤—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π.{% endblock %}
{% block og_title %}{{ bundle.name }} ‚Äî –≥–æ—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä ‚Ä¢ OnePercent{% endblock %}
{% block og_description %}{{ bundle.goal.name }} + {{ bundle.habits_count }} –ø—Ä–∏–≤—ã—á–µ–∫. –ì–æ—Ç–æ–≤—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π.{% endblock %}
{% block og_url %}https://percent1.ru/catalog/bundles/{{ bundle.slug }}/{% endblock %}

{% block breadcrumbs %}
<a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/">–ö–∞—Ç–∞–ª–æ–≥</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/bundles/">–ù–∞–±–æ—Ä—ã</a>
<span class="separator">‚Ä∫</span>
<span class="current">{{ bundle.name }}</span>
{% endblock %}

{% block content %}
<article class="bundle-detail-page">
    <section class="hero-section green">
        <div class="hero-icon">üì¶</div>
        <h1 class="hero-title">{{ bundle.name }}</h1>
        <p class="hero-subtitle">{{ bundle.short_description }}</p>
        <div class="bundle-stats">
            <div class="stat-item">
                <span class="stat-icon">üéØ</span>
                <span class="stat-value">1 —Ü–µ–ª—å</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">‚ö°</span>
                <span class="stat-value">{{ bundle.habits_count }} –ø—Ä–∏–≤—ã—á–µ–∫</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">‚è±</span>
                <span class="stat-value">{{ bundle.duration_display }}</span>
            </div>
        </div>
        <div class="bundle-cta">
            <a href="/auth/register/?add_bundle={{ bundle.id }}" class="btn btn-primary green btn-lg">+ –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–±–æ—Ä –≤ —Å–≤–æ–π –ø–ª–∞–Ω</a>
        </div>
    </section>

    <section class="bundle-description-section">
        <h2 class="section-title">–û –Ω–∞–±–æ—Ä–µ</h2>
        <div class="bundle-description">
            {{ bundle.description|linebreaks }}
        </div>
    </section>

    <section class="bundle-goal-section">
        <h2 class="section-title">üéØ –¶–µ–ª—å –Ω–∞–±–æ—Ä–∞</h2>
        <div class="bundle-goal-card">
            <div class="goal-header">
                <span class="goal-icon">üéØ</span>
                <div class="goal-content">
                    <h3><a href="/catalog/goals/{{ bundle.goal.category.slug }}/{{ bundle.goal.subcategory.slug }}/{{ bundle.goal.slug }}/">{{ bundle.goal.name }}</a></h3>
                    <div class="goal-meta">
                        <span>{{ bundle.goal.category.icon }} {{ bundle.goal.category.name }}</span>
                        <span>{{ bundle.goal.steps_count }} —à–∞–≥–æ–≤</span>
                        <span class="difficulty-{{ bundle.goal.difficulty }}">{{ bundle.goal.difficulty_display }}</span>
                        <span>{{ bundle.goal.duration_display }}</span>
                    </div>
                </div>
            </div>
            <p class="goal-description">{{ bundle.goal.short_description }}</p>
            
            <div class="goal-steps-preview-bundle">
                <h4>–®–∞–≥–∏ –∫ —Ü–µ–ª–∏:</h4>
                <ol class="steps-preview-list">
                    {% for step in bundle.goal.steps.all|slice:":5" %}
                    <li>{{ step.name }}</li>
                    {% endfor %}
                    {% if bundle.goal.steps_count > 5 %}
                    <li class="more-steps">... –∏ –µ—â—ë {{ bundle.goal.steps_count|add:"-5" }} —à–∞–≥–æ–≤</li>
                    {% endif %}
                </ol>
            </div>
            
            <a href="/catalog/goals/{{ bundle.goal.category.slug }}/{{ bundle.goal.subcategory.slug }}/{{ bundle.goal.slug }}/" class="btn-link">–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ü–µ–ª–∏ ‚Üí</a>
        </div>
    </section>

    <section class="bundle-habits-section">
        <h2 class="section-title">‚ö° –ü—Ä–∏–≤—ã—á–∫–∏ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ ({{ bundle.habits_count }})</h2>
        <p class="section-desc">–≠—Ç–∏ –ø—Ä–∏–≤—ã—á–∫–∏ –ø–æ–º–æ–≥—É—Ç –¥–æ—Å—Ç–∏—á—å —Ü–µ–ª–∏ –±—ã—Å—Ç—Ä–µ–µ –∏ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</p>
        
        <div class="bundle-habits-list">
            {% for habit in bundle.habits.all %}
            <div class="bundle-habit-card">
                <div class="habit-number">{{ forloop.counter }}</div>
                <div class="habit-content">
                    <h3><a href="/catalog/habits/{{ habit.category.slug }}/{{ habit.subcategory.slug }}/{{ habit.slug }}/">{{ habit.name }}</a></h3>
                    <p>{{ habit.short_description }}</p>
                    <div class="habit-meta">
                        <span>‚è± {{ habit.duration_display }}</span>
                        <span class="difficulty-{{ habit.difficulty }}">{{ habit.difficulty_display }}</span>
                        <span>üìÖ {{ habit.frequency_display }}</span>
                    </div>
                    {% if habit.benefit %}
                    <p class="habit-benefit">‚úì {{ habit.benefit }}</p>
                    {% endif %}
                </div>
                <a href="/catalog/habits/{{ habit.category.slug }}/{{ habit.subcategory.slug }}/{{ habit.slug }}/" class="habit-link">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí</a>
            </div>
            {% endfor %}
        </div>
    </section>

    <section class="bundle-strategy-section">
        <h2 class="section-title">üìã –°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
        <div class="strategy-content">
            {{ bundle.strategy|linebreaks }}
        </div>
        
        {% if bundle.timeline %}
        <div class="bundle-timeline">
            <h3>–ü—Ä–∏–º–µ—Ä–Ω—ã–π –ø–ª–∞–Ω:</h3>
            <div class="timeline-items">
                {% for week, description in bundle.timeline.items %}
                <div class="timeline-item">
                    <span class="timeline-week">{{ week }}</span>
                    <p>{{ description }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </section>

    {% if bundle.expected_results %}
    <section class="bundle-results-section">
        <h2 class="section-title">üéâ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
        <ul class="results-list">
            {% for result in bundle.expected_results %}
            <li>‚úì {{ result }}</li>
            {% endfor %}
        </ul>
    </section>
    {% endif %}

    <section class="bundle-cta-section">
        <div class="cta-box green">
            <h2>–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?</h2>
            <p>–î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –Ω–∞–±–æ—Ä –≤ —Å–≤–æ–π –ø–ª–∞–Ω –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø—É—Ç—å –∫ —Ü–µ–ª–∏ —É–∂–µ —Å–µ–≥–æ–¥–Ω—è</p>
            <a href="/auth/register/?add_bundle={{ bundle.id }}" class="btn btn-primary green btn-lg">–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–±–æ—Ä –±–µ—Å–ø–ª–∞—Ç–Ω–æ</a>
        </div>
    </section>

    {% if similar_bundles %}
    <section class="similar-bundles-section">
        <h2 class="section-title">–ü–æ—Ö–æ–∂–∏–µ –Ω–∞–±–æ—Ä—ã</h2>
        <div class="bundles-grid">
            {% for similar in similar_bundles %}
            <a href="/catalog/bundles/{{ similar.slug }}/" class="bundle-card">
                <div class="bundle-header">
                    <span class="bundle-icon">üì¶</span>
                    <div class="bundle-category">{{ similar.category.icon }} {{ similar.category.name }}</div>
                </div>
                <h3>{{ similar.name }}</h3>
                <p>{{ similar.short_description }}</p>
                <div class="bundle-meta">
                    <span>üéØ 1 —Ü–µ–ª—å</span>
                    <span>‚ö° {{ similar.habits_count }} –ø—Ä–∏–≤—ã—á–µ–∫</span>
                </div>
            </a>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <section class="other-bundles-section">
        <a href="/catalog/bundles/" class="btn btn-outline green">‚Üê –í—Å–µ –Ω–∞–±–æ—Ä—ã</a>
    </section>
</article>
{% endblock %}
