{% extends "catalog/base.html" %}
{% load static %}

{% block title %}{{ difficulty_display }} —Ü–µ–ª–∏ ‚Äî {{ goals_count }} –ø–æ—à–∞–≥–æ–≤—ã—Ö –ø–ª–∞–Ω–æ–≤ ‚Ä¢ OnePercent{% endblock %}
{% block description %}{{ goals_count }} {{ difficulty_adjective }} —Ü–µ–ª–µ–π –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è. {{ difficulty_description }}{% endblock %}
{% block og_title %}{{ difficulty_display }} —Ü–µ–ª–∏ ‚Äî {{ goals_count }} –ø–ª–∞–Ω–æ–≤ ‚Ä¢ OnePercent{% endblock %}
{% block og_description %}{{ goals_count }} {{ difficulty_adjective }} —Ü–µ–ª–µ–π –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è.{% endblock %}
{% block og_url %}https://percent1.ru/catalog/goals/filter/difficulty/{{ difficulty }}/{% endblock %}

{% block breadcrumbs %}
<a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/">–ö–∞—Ç–∞–ª–æ–≥</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/goals/">–¶–µ–ª–∏</a>
<span class="separator">‚Ä∫</span>
<a href="/catalog/goals/filter/">–§–∏–ª—å—Ç—Ä—ã</a>
<span class="separator">‚Ä∫</span>
<span class="current">{{ difficulty_display }}</span>
{% endblock %}

{% block content %}
<section class="hero-section">
    <div class="hero-icon">{{ difficulty_icon }}</div>
    <h1 class="hero-title">{{ difficulty_display }} —Ü–µ–ª–∏</h1>
    <p class="hero-subtitle">{{ goals_count }} —Ü–µ–ª–µ–π {{ difficulty_description_genitive }}.<br>{{ difficulty_tagline }}</p>
</section>

<section class="why-section">
    <h2 class="section-title">–ü–æ—á–µ–º—É {{ difficulty_adjective_lower }} —Ü–µ–ª–∏</h2>
    <div class="why-content">
        <p>{{ difficulty_why_text }}</p>
        <ul class="why-list">
            {% for item in difficulty_why_list %}
            <li>‚Ä¢ {{ item }}</li>
            {% endfor %}
        </ul>
    </div>
</section>

<section class="filters-section">
    <h2 class="section-title">–§–∏–ª—å—Ç—Ä—ã</h2>
    <div class="filters-grid">
        <div class="filter-group">
            <span class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</span>
            <div class="filter-buttons">
                <a href="?category=" class="filter-btn {% if not current_category %}active{% endif %}">–í—Å–µ</a>
                {% for cat in categories %}
                <a href="?category={{ cat.slug }}" class="filter-btn {% if current_category == cat.slug %}active{% endif %}">{{ cat.icon }} {{ cat.name }}</a>
                {% endfor %}
            </div>
        </div>
        <div class="filter-group">
            <span class="filter-label">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</span>
            <div class="filter-buttons">
                <a href="?duration=" class="filter-btn {% if not current_duration %}active{% endif %}">–í—Å–µ</a>
                <a href="?duration=1m" class="filter-btn {% if current_duration == '1m' %}active{% endif %}">–î–æ 1 –º–µ—Å</a>
                <a href="?duration=1-3m" class="filter-btn {% if current_duration == '1-3m' %}active{% endif %}">1-3 –º–µ—Å</a>
                <a href="?duration=3-6m" class="filter-btn {% if current_duration == '3-6m' %}active{% endif %}">3-6 –º–µ—Å</a>
                <a href="?duration=6m+" class="filter-btn {% if current_duration == '6m+' %}active{% endif %}">6+ –º–µ—Å</a>
            </div>
        </div>
        <div class="filter-group">
            <span class="filter-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</span>
            <div class="filter-buttons">
                <a href="?sort=popular" class="filter-btn {% if current_sort == 'popular' or not current_sort %}active{% endif %}">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</a>
                <a href="?sort=new" class="filter-btn {% if current_sort == 'new' %}active{% endif %}">–ù–æ–≤—ã–µ</a>
            </div>
        </div>
    </div>
</section>

<section class="goals-section">
    <h2 class="section-title">{{ difficulty_display }} —Ü–µ–ª–∏ ({{ goals_count }})</h2>
    <div class="goals-list">
        {% for goal in goals %}
        <article class="goal-card-full">
            <div class="goal-header">
                <span class="goal-icon">üéØ</span>
                <div class="goal-content">
                    <h3><a href="/catalog/goals/{{ goal.category.slug }}/{{ goal.subcategory.slug }}/{{ goal.slug }}/">{{ goal.name }}</a></h3>
                    <div class="goal-meta">
                        <span>{{ goal.category.icon }} {{ goal.category.name }} ‚Ä∫ {{ goal.subcategory.name }}</span>
                        <span>{{ goal.steps_count }} —à–∞–≥–æ–≤</span>
                        <span class="difficulty-{{ goal.difficulty }}">{{ goal.difficulty_display }}</span>
                        <span>{{ goal.duration_display }}</span>
                    </div>
                </div>
                {% if goal.is_popular %}
                <span class="popular-badge">‚≠ê –ü–æ–ø—É–ª—è—Ä–Ω–∞—è</span>
                {% endif %}
            </div>
            <p class="goal-description">{{ goal.short_description }}</p>
            <div class="goal-tags">
                {% for tag in goal.tags.all|slice:":4" %}
                <a href="/catalog/goals/tags/{{ tag.slug }}/" class="goal-tag">#{{ tag.name }}</a>
                {% endfor %}
            </div>
            <div class="goal-actions">
                <a href="/catalog/goals/{{ goal.category.slug }}/{{ goal.subcategory.slug }}/{{ goal.slug }}/" class="btn-link">–ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí</a>
                <a href="/auth/register/?add_goal={{ goal.id }}" class="btn btn-outline">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</a>
            </div>
        </article>
        {% endfor %}
    </div>

    {% if goals.has_other_pages %}
    <nav class="pagination">
        {% if goals.has_previous %}
        <a href="?page={{ goals.previous_page_number }}" class="page-link">‚óÄ –ù–∞–∑–∞–¥</a>
        {% endif %}
        {% for num in goals.paginator.page_range %}
            {% if goals.number == num %}
            <span class="page-current">{{ num }}</span>
            {% else %}
            <a href="?page={{ num }}" class="page-link">{{ num }}</a>
            {% endif %}
        {% endfor %}
        {% if goals.has_next %}
        <a href="?page={{ goals.next_page_number }}" class="page-link">–í–ø–µ—Ä—ë–¥ ‚ñ∂</a>
        {% endif %}
    </nav>
    {% endif %}
</section>

<section class="other-difficulties-section">
    <h2 class="section-title">–î—Ä—É–≥–∏–µ —É—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</h2>
    <div class="difficulty-links">
        {% for diff in other_difficulties %}
        <a href="/catalog/goals/filter/difficulty/{{ diff.slug }}/" class="difficulty-link-btn">{{ diff.icon }} {{ diff.display }} ({{ diff.count }})</a>
        {% endfor %}
    </div>
</section>

<section class="other-filters-section">
    <h2 class="section-title">–î—Ä—É–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã</h2>
    <div class="filter-links">
        <a href="/catalog/goals/filter/duration/1m/" class="filter-link-btn">‚è± –î–æ 1 –º–µ—Å—è—Ü–∞</a>
        <a href="/catalog/goals/filter/duration/1-3m/" class="filter-link-btn">‚è± 1-3 –º–µ—Å—è—Ü–∞</a>
        <a href="/catalog/goals/filter/duration/3-6m/" class="filter-link-btn">‚è± 3-6 –º–µ—Å—è—Ü–µ–≤</a>
        <a href="/catalog/goals/filter/duration/6m+/" class="filter-link-btn">‚è± 6+ –º–µ—Å—è—Ü–µ–≤</a>
    </div>
</section>
{% endblock %}
